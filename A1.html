<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- ç¼“å­˜æ§åˆ¶ - é˜²æ­¢æµè§ˆå™¨ç¼“å­˜å¯¼è‡´æ ·å¼ä¸ä¸€è‡´ -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <!-- ç‰ˆæœ¬å· - æ¯æ¬¡ä¿®æ”¹ä»£ç æ—¶æ›´æ–°æ­¤ç‰ˆæœ¬å·ï¼Œè®©æµè§ˆå™¨è®¤ä¸ºè¿™æ˜¯æ–°ç‰ˆæœ¬ -->
    <meta name="version" content="1.0.5">
    <title>å¾·è¯­A1è¯æ±‡å¡ç‰‡ - åè¯å­¦ä¹ </title>
    <!-- Favicon - ä½¿ç”¨SVGæ ¼å¼ï¼Œé¿å…404é”™è¯¯ -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='.9em' font-size='90'%3EğŸ“š%3C/text%3E%3C/svg%3E">
    <!-- Font Awesome å·²ç§»é™¤ï¼Œä½¿ç”¨ Unicode ç¬¦å·å®ç°ç¦»çº¿ä½¿ç”¨ -->
    <script>
        // å¼ºåˆ¶åˆ·æ–°ç¼“å­˜æœºåˆ¶ - è§£å†³ Firefox ç¼“å­˜é—®é¢˜
        (function() {
            const CURRENT_VERSION = '1.0.5'; // ä¸ meta version ä¿æŒä¸€è‡´
            const VERSION_STORAGE_KEY = 'a1_vocab_version';
            
            // æ£€æŸ¥ç‰ˆæœ¬å¹¶å¼ºåˆ¶åˆ·æ–°
            const storedVersion = sessionStorage.getItem(VERSION_STORAGE_KEY);
            if (storedVersion && storedVersion !== CURRENT_VERSION) {
                // ç‰ˆæœ¬ä¸åŒ¹é…ï¼Œæ¸…é™¤æ‰€æœ‰ç¼“å­˜å¹¶åˆ·æ–°
                sessionStorage.clear();
                // æ³¨æ„ï¼šä¸æ¸…é™¤ localStorageï¼Œä¿ç•™ç”¨æˆ·å­¦ä¹ è¿›åº¦
                // localStorage.removeItem('userConfig');
                // localStorage.removeItem('learningProgress');
                
                // å¼ºåˆ¶åˆ·æ–°ï¼ˆå…¼å®¹ä¸åŒæµè§ˆå™¨ï¼‰
                if (window.location.protocol === 'file:') {
                    // æœ¬åœ°æ–‡ä»¶ï¼šæ·»åŠ æ—¶é—´æˆ³å‚æ•°å¼ºåˆ¶åˆ·æ–°
                    const separator = window.location.href.includes('?') ? '&' : '?';
                    window.location.href = window.location.href.split('?')[0] + separator + '_v=' + CURRENT_VERSION + '&_t=' + Date.now();
                } else {
                    // ç½‘ç»œæ–‡ä»¶ï¼šä½¿ç”¨ reload
                    window.location.reload(true);
                }
                return;
            }
            
            // ä¿å­˜å½“å‰ç‰ˆæœ¬
            sessionStorage.setItem(VERSION_STORAGE_KEY, CURRENT_VERSION);
            
            // å¯¹äºæœ¬åœ°æ–‡ä»¶ï¼Œåœ¨ URL ä¸­æ·»åŠ ç‰ˆæœ¬å‚æ•°ï¼ˆç”¨äºç ´åç¼“å­˜ï¼‰
            if (window.location.protocol === 'file:') {
                const currentUrl = window.location.href;
                if (!currentUrl.includes('_v=')) {
                    const separator = currentUrl.includes('?') ? '&' : '?';
                    const newUrl = currentUrl.split('?')[0] + separator + '_v=' + CURRENT_VERSION;
                    window.history.replaceState({}, '', newUrl);
                }
            } else {
                // ç½‘ç»œæ–‡ä»¶ï¼šä½¿ç”¨æ ‡å‡† URL API
                if (!window.location.search.includes('v=')) {
                    try {
                        const url = new URL(window.location.href);
                        url.searchParams.set('v', CURRENT_VERSION);
                        window.history.replaceState({}, '', url);
                    } catch (e) {
                        // URL API ä¸æ”¯æŒæ—¶å¿½ç•¥
                    }
                }
            }
        })();
    </script>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        /* æ—‹è½¬åŠ¨ç”» - ç”¨äºåŠ è½½å›¾æ ‡ */
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .icon-spin {
            display: inline-block;
            animation: spin 1s linear infinite;
        }
        
        /* å›¾æ ‡æ ·å¼ */
        .icon {
            display: inline-block;
            font-style: normal;
            font-weight: normal;
        }
        
        /* CSSå˜é‡ - ç»Ÿä¸€ç®¡ç†å¡ç‰‡å…³é”®å°ºå¯¸ */
        :root {
            --card-height: 420px;
            --card-border-radius: 16px;
            --card-padding-default: 10px;
            --card-padding-learning: 3px;
            --overlay-height-ratio: 0.18337; /* 1/6 * 1.1 = å¢åŠ 10% */
            --overlay-lift-amount: 15px; /* ä¸Šç§»å›ºå®šå°ºå¯¸15px */
            --button-size: 45px;
            --button-offset-top: -22.5px; /* æŒ‰é’®ä¸€åŠåœ¨å®¹å™¨å¤– */
            --top-bar-height: 70px; /* å›ºå®šæ é«˜åº¦ */
            --body-padding-top: calc(var(--top-bar-height) + 15px); /* ä¸ºå›ºå®šæ ç•™å‡ºç©ºé—´ */
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e7eb 100%);
            padding: 15px;
            padding-top: var(--body-padding-top); /* ä½¿ç”¨CSSå˜é‡ï¼Œç»§æ‰¿å…³ç³» */
            min-height: 100vh;
        }
        
        /* å›ºå®šæ‚¬æµ®æ  - å“ç‰Œæ„Ÿè®¾è®¡ */
        .fixed-top-bar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: var(--top-bar-height); /* ä½¿ç”¨CSSå˜é‡ */
            background: linear-gradient(135deg, #3498db 0%, #2980b9 50%, #2c3e50 100%);
            border-bottom: 3px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15), 0 2px 8px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 25px;
            gap: 25px;
            backdrop-filter: blur(10px);
        }
        
        .top-bar-left {
            display: flex;
            align-items: center;
            gap: 20px;
            flex-shrink: 0;
        }
        
        .top-bar-title {
            font-size: 1.4rem;
            font-weight: 700;
            color: #ffffff;
            white-space: nowrap;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            letter-spacing: 0.5px;
        }
        
        .top-bar-mode-buttons {
            display: flex;
            gap: 10px;
            flex-shrink: 0;
            margin-left: 15px;
        }
        
        .top-bar-mode-btn {
            padding: 8px 18px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            background: rgba(255, 255, 255, 0.1);
            color: #ffffff;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 6px;
            white-space: nowrap;
            backdrop-filter: blur(5px);
        }
        
        .top-bar-mode-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.5);
            transform: translateY(-1px);
        }
        
        .top-bar-mode-btn.active {
            background: linear-gradient(135deg, #ffffff, #f5f5f5);
            color: #2c3e50;
            border-color: #ffffff;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        }
        
        .top-bar-center {
            display: flex;
            align-items: center;
            flex: 1;
            justify-content: center;
            gap: 15px;
        }
        
        .current-theme-display {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: rgba(255, 255, 255, 0.15);
            border-radius: 8px;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .current-theme-label {
            font-size: 0.85rem;
            color: rgba(255, 255, 255, 0.8);
            font-weight: 500;
        }
        
        .current-theme-name {
            font-size: 0.95rem;
            color: #ffffff;
            font-weight: 700;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
        }
        
        .top-bar-right {
            display: flex;
            align-items: center;
            gap: 15px;
            flex-shrink: 0;
        }
        
        .top-bar-progress {
            display: flex;
            align-items: center;
            gap: 12px;
            flex-shrink: 0;
        }
        
        .progress-stat {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.8rem;
            color: #ffffff;
        }
        
        .progress-stat-label {
            color: rgba(255, 255, 255, 0.8);
        }
        
        .progress-stat-value {
            font-weight: 700;
            padding: 4px 10px;
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(5px);
            min-width: 28px;
            text-align: center;
        }
        
        .progress-stat.completed .progress-stat-value {
            background: rgba(39, 174, 96, 0.7);
            color: #ffffff;
            border: 1px solid rgba(39, 174, 96, 0.8);
        }
        
        .progress-stat.learning .progress-stat-value {
            background: rgba(52, 152, 219, 0.7);
            color: #ffffff;
            border: 1px solid rgba(52, 152, 219, 0.8);
        }
        
        .progress-stat.locked .progress-stat-value {
            background: rgba(255, 255, 255, 0.4);
            color: rgba(255, 255, 255, 0.9);
            border: 1px solid rgba(255, 255, 255, 0.5);
        }
        
        @media (max-width: 768px) {
            /* ç§»åŠ¨ç«¯é¡¶éƒ¨æ é«˜åº¦ä¼˜åŒ– */
            :root {
                --top-bar-height: 55px; /* å‡å°‘é¡¶éƒ¨æ é«˜åº¦ */
                --card-height: 300px; /* å‡å°‘å¡ç‰‡é«˜åº¦ï¼Œç¡®ä¿ä¸¤å¼ å¡ç‰‡èƒ½åœ¨ä¸€å±æ˜¾ç¤º */
            }
            
            .fixed-top-bar {
                flex-wrap: wrap;
                height: auto;
                min-height: var(--top-bar-height);
                padding: 6px 10px; /* å‡å°‘padding */
                gap: 8px; /* å‡å°‘gap */
            }
            
            .top-bar-left {
                width: 100%;
                justify-content: space-between;
                margin-bottom: 4px; /* å‡å°‘margin */
            }
            
            .top-bar-title {
                font-size: 0.9rem; /* ç¨å¾®å‡å°å­—ä½“ */
            }
            
            .top-bar-center {
                width: 100%;
                justify-content: flex-start;
            }
            
            .top-bar-right {
                width: 100%;
                justify-content: space-between;
            }
            
            .top-bar-progress {
                flex-wrap: wrap;
                gap: 4px; /* å‡å°‘gap */
                font-size: 0.75rem; /* å‡å°å­—ä½“ */
            }
            
            body {
                padding: 8px; /* å‡å°‘padding */
                padding-top: calc(var(--top-bar-height) + 8px); /* å¤§å¹…å‡å°‘padding-top */
            }
            
            .cards-container {
                gap: 10px; /* å‡å°‘å¡ç‰‡é—´è· */
                margin-top: 4px; /* å‡å°‘margin-top */
                padding-bottom: 10px; /* å‡å°‘padding-bottom */
            }
            
            body.test-mode .cards-container {
                gap: 6px; /* æµ‹è¯•æ¨¡å¼è¿›ä¸€æ­¥å‡å°‘é—´è· */
                margin-top: 2px;
            }
            
            /* ç§»åŠ¨ç«¯æµ‹è¯•æ¨¡å¼æ ‡é¢˜è¡Œä¼˜åŒ– */
            body.test-mode .test-title-row {
                flex-wrap: wrap;
                gap: 6px; /* å‡å°‘gap */
                margin-bottom: 4px; /* å‡å°‘margin */
                justify-content: flex-start;
            }
            
            body.test-mode .card-title-hint {
                margin-left: 0;
                font-size: 1rem; /* å‡å°å­—ä½“ */
                font-weight: 500;
                color: #2c3e50;
            }
            
            body.test-mode .card-external-title {
                flex-direction: row;
                align-items: center;
                justify-content: center;
                gap: 6px; /* å‡å°‘gap */
                font-size: 0.75rem; /* å‡å°å­—ä½“ */
            }
            
            body.test-mode .card-title-indicators {
                font-size: 0.75rem; /* å‡å°å­—ä½“ */
            }
        }
        
        @media (max-width: 480px) {
            /* å°å±å¹•è¿›ä¸€æ­¥ä¼˜åŒ– - ç¡®ä¿ä¸¤å¼ å¡ç‰‡åœ¨ä¸€å±æ˜¾ç¤º */
            :root {
                --top-bar-height: 50px; /* è¿›ä¸€æ­¥å‡å°‘é¡¶éƒ¨æ é«˜åº¦ */
                --card-height: 280px; /* è¿›ä¸€æ­¥å‡å°‘å¡ç‰‡é«˜åº¦ */
            }
/*
æ¨é€å½“å‰ç›®å½•æ‰€æœ‰æ–‡ä»¶åˆ°GitHubä»“åº“çš„æ“ä½œå‘½ä»¤å¦‚ä¸‹ï¼š

git init
git remote add origin https://github.com/ZYDeutsch-Chen/Vokabeln-A1-04.git
git add .
git commit -m "æ¨é€å½“å‰ç›®å½•æ‰€æœ‰æ–‡ä»¶"
git push -u origin master
*/
            
            .fixed-top-bar {
                padding: 5px 8px; /* è¿›ä¸€æ­¥å‡å°‘padding */
                gap: 6px; /* è¿›ä¸€æ­¥å‡å°‘gap */
            }
            
            .top-bar-title {
                font-size: 0.85rem; /* è¿›ä¸€æ­¥å‡å°å­—ä½“ */
            }
            
            .top-bar-mode-btn {
                padding: 6px 12px; /* å‡å°‘æŒ‰é’®padding */
                font-size: 0.8rem; /* å‡å°æŒ‰é’®å­—ä½“ */
            }
            
            .top-bar-progress {
                font-size: 0.7rem; /* è¿›ä¸€æ­¥å‡å°å­—ä½“ */
            }
            
            body {
                padding: 6px; /* è¿›ä¸€æ­¥å‡å°‘padding */
                padding-top: calc(var(--top-bar-height) + 6px); /* è¿›ä¸€æ­¥å‡å°‘padding-top */
            }
            
            .cards-container {
                gap: 8px; /* è¿›ä¸€æ­¥å‡å°‘å¡ç‰‡é—´è· */
                margin-top: 2px; /* è¿›ä¸€æ­¥å‡å°‘margin-top */
                padding-bottom: 8px; /* è¿›ä¸€æ­¥å‡å°‘padding-bottom */
            }
            
            body.test-mode .cards-container {
                gap: 4px; /* æµ‹è¯•æ¨¡å¼è¿›ä¸€æ­¥å‡å°‘é—´è· */
                margin-top: 0;
            }
            
            /* ç§»åŠ¨ç«¯å­¦ä¹ æ¨¡å¼æ–‡å­—å¤§å°ä¼˜åŒ– */
            .learning-card-front .meaning-display {
                font-size: 1.4rem; /* ç¨å¾®å‡å°å­—ä½“ */
                padding: 8px; /* å‡å°‘padding */
            }
            
            .learning-card-back .noun-display {
                font-size: 2.2rem; /* ç¨å¾®å‡å°å­—ä½“ */
            }
            
            .learning-card-back .meaning-display {
                font-size: 1.4rem; /* ç¨å¾®å‡å°å­—ä½“ */
                padding: 8px; /* å‡å°‘padding */
            }
            
            /* ç§»åŠ¨ç«¯æŒ‰é’®ä¼˜åŒ– */
            .speak-btn {
                min-width: 45px; /* ç¨å¾®å‡å°æŒ‰é’® */
                min-height: 45px;
                font-size: 1.1rem;
            }
            
            /* ç§»åŠ¨ç«¯æµ‹è¯•é€‰é¡¹æŒ‰é’®ä¼˜åŒ– */
            .test-option {
                min-height: 45px; /* ç¨å¾®å‡å°æŒ‰é’® */
                padding: 10px 12px; /* å‡å°‘padding */
                font-size: 0.95rem; /* ç¨å¾®å‡å°å­—ä½“ */
            }
        }
        
        .header {
            display: none; /* éšè—åŸæ¥çš„header */
        }
        
        /* å¡ç‰‡å®¹å™¨ */
        .cards-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
            margin-top: 10px;
            padding-bottom: 30px;
            max-width: 95%;
            margin-left: auto;
            margin-right: auto;
        }
        
        /* æµ‹è¯•æ¨¡å¼ä¸‹ï¼Œå¡ç‰‡å®¹å™¨å±…ä¸­ï¼Œå•åˆ—æ˜¾ç¤º */
        body.test-mode .cards-container {
            grid-template-columns: 1fr;
            max-width: 600px; /* å›ºå®šå®½åº¦ï¼Œä¾¿äºè®¡ç®—è¿›åº¦æ¡ä½ç½® */
            margin-left: auto;
            margin-right: auto;
            padding-right: 0;
            gap: 10px;
            margin-top: 5px;
        }
        
        @media (min-width: 768px) {
            .cards-container {
                grid-template-columns: repeat(2, 1fr);
                max-width: 90%;
            }
        }
        
        @media (max-width: 768px) {
            body.test-mode .cards-container {
                max-width: 90%;
            }
        }
        
        /* æµ‹è¯•æç¤ºæ–‡å­— */
        .test-instruction {
            text-align: center;
            font-size: 1.1rem;
            color: #2c3e50;
            margin-bottom: 15px;
            font-weight: 500;
            display: none;
        }
        
        body.test-mode .test-instruction {
            display: block;
        }
        
        /* æµ‹è¯•æ¨¡å¼ä¸‹ï¼Œå°†æç¤ºæ–‡å­—å’Œå¤–éƒ¨æ ‡é¢˜æ”¾åœ¨åŒä¸€è¡Œ */
        body.test-mode .test-instruction {
            display: inline-block;
            margin-right: 0;
            margin-bottom: 0;
            vertical-align: middle;
        }
        
        body.test-mode .card-wrapper {
            margin-top: 8px;
        }
        
        /* æµ‹è¯•æ¨¡å¼ä¸‹ï¼Œå¤–éƒ¨æ ‡é¢˜ä»å¡ç‰‡åŒ…è£…å™¨ä¸­æå–å‡ºæ¥ï¼Œå’Œæç¤ºæ–‡å­—åœ¨åŒä¸€è¡Œ */
        body.test-mode .test-title-row {
            display: flex;
            align-items: center;
            justify-content: flex-start;
            gap: 20px;
            margin-bottom: 7.2px; /* 8px * 0.9 */
            width: 100%;
        }
        
        body.test-mode .test-title-row .test-instruction {
            display: inline-block;
            margin: 0;
        }
        
        body.test-mode .card-external-title {
            display: inline-flex;
            vertical-align: middle;
            margin-bottom: 0;
        }
        
        body.test-mode .card-wrapper .card-external-title {
            display: none; /* éšè—å¡ç‰‡åŒ…è£…å™¨å†…çš„å¤–éƒ¨æ ‡é¢˜ */
        }
        
        /* éšè—åŸæ¥çš„æµ‹è¯•æç¤ºæ–‡å­—ï¼ˆå› ä¸ºå·²ç»ç§»åˆ°æ ‡é¢˜è¡Œä¸­ï¼‰ */
        body.test-mode #test-instruction {
            display: none;
        }
        
        /* å¡ç‰‡åŒ…è£…å™¨ */
        .card-wrapper {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        /* å¡ç‰‡å¤–éƒ¨æ ‡é¢˜ */
        .card-external-title {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9rem;
            color: #7f8c8d;
            font-weight: 500;
            padding: 5px 0;
            user-select: none;
        }
        
        .card-title-indicators {
            display: flex;
            align-items: center;
        }
        
        .card-title-front,
        .card-title-back {
            transition: color 0.3s ease;
            cursor: default;
        }
        
        .card-title-front.active,
        .card-title-back.active {
            color: #3498db;
            font-weight: 600;
        }
        
        .card-title-separator {
            margin: 0 8px;
            color: #bdc3c7;
        }
        
        .card-title-hint {
            font-size: 0.85rem;
            color: #95a5a6;
            font-weight: 400;
        }
        
        /* æµ‹è¯•æ¨¡å¼ä¸‹ï¼Œå¢åŠ é¢˜ç›®å’Œç­”æ¡ˆæ ‡è¯†ä¸æ ‡é¢˜æ–‡å­—ä¹‹é—´çš„é—´è· */
        body.test-mode .card-title-hint {
            margin-left: 30px;
        }
        
        /* æµ‹è¯•æ¨¡å¼ä¸‹ï¼Œæ ‡é¢˜æ–‡å­—å­—å·å¢åŠ ï¼Œä¿æŒåœ¨åŒä¸€è¡Œå±…ä¸­ */
        body.test-mode .card-external-title {
            flex-direction: row;
            align-items: center;
            justify-content: center;
            gap: 15px;
            font-size: 0.81rem; /* 0.9rem * 0.9 */
        }
        
        body.test-mode .card-title-hint {
            margin-left: 0;
            font-size: 1.35rem; /* 1.5rem * 0.9 */
            font-weight: 500;
            color: #2c3e50;
        }
        
        body.test-mode .card-title-indicators {
            font-size: 0.9rem; /* 1rem * 0.9 */
        }
        
        .card {
            position: relative;
            height: var(--card-height);
            perspective: 1000px;
            cursor: pointer;
            width: 100%;
            max-width: 100%;
        }
        
        .card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            transform-style: preserve-3d;
            transition: transform 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
            border-radius: var(--card-border-radius);
        }
        
        .card.flipped .card-inner {
            transform: rotateY(180deg);
        }
        
        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: var(--card-border-radius);
            padding: var(--card-padding-default);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            overflow: hidden;
        }
        
        .card-front {
            background: linear-gradient(145deg, #ffffff, #f8f9fa);
            border: 1px solid #e0e0e0;
            overflow: visible; /* å…è®¸æŒ‰é’®è¶…å‡ºåº•å±‚å®¹å™¨æ˜¾ç¤º */
        }
        
        .card-back {
            background: linear-gradient(145deg, #2c3e50, #34495e);
            color: white;
            transform: rotateY(180deg);
            justify-content: center;
            align-items: center;
            position: relative;
            overflow: visible; /* å…è®¸æŒ‰é’®è¶…å‡ºåº•å±‚å®¹å™¨æ˜¾ç¤º */
        }
        
        /* å­¦ä¹ æ¨¡å¼ä¸‹èƒŒé¢ä¹Ÿä½¿ç”¨ç›¸åŒçš„paddingï¼Œç¡®ä¿å®šä½ä¸€è‡´ */
        .card-face.learning-card-back {
            padding: var(--card-padding-learning) !important;
        }
        
        
        /* åè¯å¤´éƒ¨ - å­¦ä¹ æ¨¡å¼ä¸‹å·²ç§»é™¤ï¼Œä¿ç•™æ ·å¼ä»¥é˜²å…¶ä»–åœ°æ–¹ä½¿ç”¨ */
        .noun-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 4px;
        }
        
        /* å­¦ä¹ æ¨¡å¼ä¸‹éšè—noun-header */
        .learning-card-front .noun-header {
            display: none;
        }
        
        .noun-name {
            font-size: 2rem;
            font-weight: 700;
            color: #2c3e50;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.1);
            flex: 1;
        }
        
        /* å›¾ç‰‡å®¹å™¨ */
        .noun-image-container {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 4px;
            background: rgba(236, 240, 241, 0.5);
            border-radius: 12px;
            margin: 4px 0;
            min-height: 250px;
            overflow: visible; /* æ”¹ä¸º visibleï¼Œè®©æŒ‰é’®å¯ä»¥è¶…å‡ºå®¹å™¨ */
            position: relative;
        }
        
        /* å­¦ä¹ æ¨¡å¼ä¸‹å‹ç¼©å›¾ç‰‡å®¹å™¨é«˜åº¦ */
        .learning-card-front .noun-image-container {
            margin: 0 calc(-1 * var(--card-padding-learning)); /* å·¦å³è´ŸmarginæŠµæ¶ˆå¡ç‰‡paddingï¼Œè®©èƒŒæ™¯ä¸å¡ç‰‡è¾¹ç¼˜å¯¹é½ */
            padding: 0; /* æ¶ˆé™¤paddingï¼Œæ¶ˆé™¤ç™½è‰²è¾¹æ¡† */
            min-height: 240px; /* ä»180pxå¢å¤§åˆ°240pxï¼Œä¼˜åŒ–æ˜¾ç¤ºç©ºé—´ */
            border-radius: calc(var(--card-border-radius) - var(--card-padding-learning)); /* åœ†è§’å‡å»padding */
            background: none;
            position: relative; /* ç¡®ä¿å®šä½ä¸Šä¸‹æ–‡ */
            overflow: visible; /* ä¿æŒvisibleï¼Œè®©æŒ‰é’®å¯ä»¥è¶…å‡ºå®¹å™¨ */
        }
        
        /* å­¦ä¹ æ¨¡å¼ä¸‹å›¾ç‰‡ä¸‹ç§»5px */
        .learning-card-front .noun-image-container img {
            position: relative;
            top: -5px; /* å›¾ç‰‡ä¸‹ç§»5pxï¼ˆä»-10pxæ”¹ä¸º-5pxï¼‰ */
            margin-bottom: -5px; /* æŠµæ¶ˆä¸‹ç§»é€ æˆçš„åº•éƒ¨ç©ºç™½ */
        }
        
        /* å­¦ä¹ æ¨¡å¼ä¸‹å‡å°å¡ç‰‡æ­£é¢çš„paddingï¼Œå¹¶è®¾ç½®æµ…ç°èƒŒæ™¯+50%é€æ˜åº¦ */
        .card-face.learning-card-front {
            padding: var(--card-padding-learning) !important;
            background: rgba(236, 240, 241, 0.5) !important; /* æµ…ç°é¢œè‰²+50%é€æ˜åº¦ */
        }
        
        /* å›¾ç‰‡é®æŒ¡å±‚ - é®æŒ¡å›¾ç‰‡ä¸‹æ–¹çš„1/6åŒºåŸŸï¼Œä¸Šç§»10pxåä¸‹è¾¹ç¼˜å¯¹é½å¡ç‰‡ä¸‹è¾¹ç¼˜ */
        .card-front .image-overlay {
            position: absolute;
            left: 0;
            right: 0;
            bottom: 0; /* å¯¹é½å¡ç‰‡ä¸‹è¾¹ç¼˜ */
            /* é«˜åº¦ = å¡ç‰‡å†…å®¹åŒºåŸŸé«˜åº¦çš„1/6 * 1.1 (å¢åŠ 10%) */
            height: calc((100% - var(--card-padding-learning) * 2) * var(--overlay-height-ratio));
            /* ä¸å†ä¸Šç§»ï¼Œç›´æ¥å¯¹é½å¡ç‰‡ä¸‹è¾¹ç¼˜ */
            transform: none;
            background: linear-gradient(145deg, #ffffff, #f8f9fa);
            border-radius: 0 0 calc(var(--card-border-radius) - var(--card-padding-learning)) calc(var(--card-border-radius) - var(--card-padding-learning));
            z-index: 5; /* ç¡®ä¿åœ¨å›¾ç‰‡ä¸Šæ–¹ */
            pointer-events: none; /* ä¸é˜»æŒ¡ç‚¹å‡»äº‹ä»¶ */
        }
        
        /* æœ—è¯»æŒ‰é’® - ä½äºå³ä¸Šè§’ï¼Œä¸€åŠå‹ä½å›¾ç‰‡è¾¹ç¼˜ï¼Œä¸€åŠå‹ä½åº•å±‚å®¹å™¨è¾¹ç¼˜ */
        .speak-btn {
            position: absolute;
            top: var(--button-offset-top); /* ä¸€åŠåœ¨å®¹å™¨å†…ï¼Œä¸€åŠåœ¨å®¹å™¨å¤–ï¼ˆå‘ä¸Šè¶…å‡ºï¼‰ */
            right: calc(var(--button-size) * 1.5 + 20px); /* å‘å·¦ç§»åŠ¨1.5å€æŒ‰é’®å®½åº¦ + 20pxè¾¹è· */
            background: #3498db;
            color: white;
            border: none;
            border-radius: 50%;
            width: var(--button-size);
            height: var(--button-size);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
            cursor: pointer;
            z-index: 10; /* ç¡®ä¿æŒ‰é’®åœ¨å›¾ç‰‡ä¸Šæ–¹ */
        }
        
        /* ç¡®ä¿èƒŒé¢ä¸æ˜¾ç¤ºå‘éŸ³æŒ‰é’® */
        .card-back .speak-btn {
            display: none !important;
        }
        
        /* ç¡®ä¿å‘éŸ³æŒ‰é’®åªåœ¨æ­£é¢æ˜¾ç¤ºï¼Œç¿»è½¬æ—¶å®Œå…¨éšè— */
        .card.flipped .card-front .speak-btn {
            display: none !important;
            visibility: hidden !important;
            opacity: 0 !important;
            pointer-events: none !important;
        }
        
        /* ç¡®ä¿æŒ‰é’®è·Ÿéšæ­£é¢ä¸€èµ·ç¿»è½¬éšè— */
        .card-front .speak-btn {
            backface-visibility: hidden;
        }
        
        .speak-btn:hover {
            background: #2980b9;
            transform: scale(1.1);
            box-shadow: 0 6px 16px rgba(0,0,0,0.4);
        }
        
        .noun-image {
            /* æ¡Œé¢ç«¯ï¼šæ›´å¤§å°ºå¯¸ */
            max-width: 102%;
            max-height: 102%;
            width: auto;
            height: auto;
            object-fit: contain;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            transition: transform 0.3s ease;
        }
        
        .noun-image:hover {
            transform: scale(1.02);
        }
        
        /* å¹³æ¿ç«¯ */
        @media (max-width: 1024px) {
            .noun-image {
                max-width: 102%;
                max-height: 102%;
            }
        }
        
        /* ç§»åŠ¨ç«¯ */
        @media (max-width: 768px) {
            .noun-image {
                max-width: 102%;
                max-height: 102%;
            }
        }
        
        /* å°å±å¹•æ‰‹æœº */
        @media (max-width: 480px) {
            .noun-image {
                max-width: 102%;
                max-height: 102%;
            }
        }
        
        /* å›¾ç‰‡åŠ è½½çŠ¶æ€ */
        .image-loading {
            display: flex;
            align-items: center;
            justify-content: center;
            color: #7f8c8d;
            font-size: 0.9rem;
        }
        
        .image-error {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: #e74c3c;
            font-size: 0.9rem;
            text-align: center;
        }
        
        /* å¡ç‰‡èƒŒé¢æ ·å¼ */
        .card-back {
            position: relative;
        }
        
        .gender-badge {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 1rem;
            font-weight: 600;
            color: white;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            margin-bottom: 15px;
        }
        
        .gender-badge.masculine {
            background: linear-gradient(145deg, #60a5fa, #3b82f6);
        }
        
        .gender-badge.neuter {
            background: linear-gradient(145deg, #4ade80, #22c55e);
        }
        
        .gender-badge.feminine {
            background: linear-gradient(145deg, #f9a8d4, #f472b6);
        }
        
        .gender-badge.plural {
            background: linear-gradient(145deg, #ffffff, #f8f9fa); /* ä¸æ­£é¢å®¹å™¨é¢œè‰²ä¸€è‡´ */
            color: #2c3e50; /* æ·±è‰²æ–‡å­—ï¼Œåœ¨æµ…è‰²èƒŒæ™¯ä¸Šæ›´æ¸…æ™° */
            border: 1px solid #e0e0e0;
        }
        
        .meaning {
            font-size: 2rem;
            text-align: center;
            margin-bottom: 20px;
            color: #ecf0f1;
            font-weight: 600;
            padding: 20px;
        }
        
        .card-back-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 100%;
            padding: 20px;
        }
        
        .card-hint {
            text-align: center;
            font-size: 0.9rem;
            color: #bdc3c7;
            font-style: italic;
            margin-top: 20px;
        }
        
        /* ç±»åˆ«æ ‡é¢˜ - å·²ç§»é™¤ */
        
        /* åº•éƒ¨ä¿¡æ¯ */
        .footer {
            text-align: center;
            padding: 20px 0;
            color: #7f8c8d;
            font-size: 0.9rem;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 12px;
            margin-top: 20px;
        }
        
        /* åŠ è½½çŠ¶æ€ */
        .loader {
            text-align: center;
            padding: 30px;
            font-size: 1.2rem;
            color: #7f8c8d;
        }

        /* åˆå§‹è®¾ç½®å¼¹çª—æ ·å¼ */
        .modal {
            display: none; /* é»˜è®¤éšè—ï¼Œé¿å…é—ªçƒ */
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            align-items: center;
            justify-content: center;
        }
        
        .modal.show {
            display: flex; /* é€šè¿‡ç±»æ§åˆ¶æ˜¾ç¤º */
        }

        .modal-content {
            background-color: #fff;
            padding: 30px;
            border-radius: 16px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
        }

        .modal-content h2 {
            color: #2c3e50;
            margin-bottom: 15px;
            text-align: center;
        }

        .modal-content p {
            color: #7f8c8d;
            margin-bottom: 20px;
            text-align: center;
        }

        .setup-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .setup-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .setup-group label {
            font-weight: 600;
            color: #2c3e50;
        }

        .radio-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .radio-label {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            padding: 8px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .radio-label:hover {
            border-color: #3498db;
            background-color: #f0f8ff;
        }

        .radio-label input[type="radio"] {
            cursor: pointer;
        }

        .radio-label input[type="radio"]:checked + span {
            color: #3498db;
            font-weight: 600;
        }

        .radio-label:has(input[type="radio"]:checked) {
            border-color: #3498db;
            background-color: #e3f2fd;
        }

        .btn-primary, .btn-secondary {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.4);
        }

        .btn-secondary {
            background: #ecf0f1;
            color: #2c3e50;
        }

        .btn-secondary:hover {
            background: #d5dbdb;
        }

        .modal-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
        }

        .unlock-content {
            text-align: center;
        }

        /* æ¨¡å¼åˆ‡æ¢å™¨ - å·²ç§»åˆ°å›ºå®šæ  */
        .mode-switcher {
            display: none; /* éšè—åŸæ¥çš„æ¨¡å¼åˆ‡æ¢å™¨ */
        }

        /* ä¸»é¢˜å¯¼èˆª - å·²ç§»åˆ°å›ºå®šæ  */
        .theme-navigation {
            display: none; /* éšè—åŸæ¥çš„ä¸»é¢˜å¯¼èˆª */
        }

        .theme-item {
            padding: 15px;
            background: white;
            border-radius: 12px;
            border: 2px solid #e0e0e0;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .theme-item:hover {
            border-color: #3498db;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .theme-item.locked {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .theme-item.completed {
            border-color: #27ae60;
        }

        .theme-item.learning {
            border-color: #3498db;
            background: #e3f2fd;
        }

        .theme-name {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 8px;
        }

        .theme-status {
            font-size: 0.85rem;
            color: #7f8c8d;
        }

        .theme-status-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            margin-top: 5px;
        }

        .status-locked {
            background: #ecf0f1;
            color: #7f8c8d;
        }

        .status-learning {
            background: #e3f2fd;
            color: #3498db;
        }

        .status-completed {
            background: #d5f4e6;
            color: #27ae60;
        }

        /* æµ‹è¯•è¿›åº¦ - ä¾§è¾¹ç«–å‘çª„æ¡ï¼Œè´´åˆå¡ç‰‡å³ä¾§ */
        .test-progress {
            position: fixed;
            width: 28px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 14px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            padding: 10px 6px; /* å‡å°å·¦å³paddingï¼Œå¢åŠ è¿›åº¦æ¡å®½åº¦ */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-between;
            z-index: 100;
            backdrop-filter: blur(10px);
            /* ä½ç½®å’Œé«˜åº¦ç”±JavaScriptåŠ¨æ€è®¡ç®— */
        }

        .progress-info {
            display: none; /* éšè—è¯­ä¹‰æ–‡å­— */
        }

        .progress-bar {
            flex: 1;
            width: 14px; /* åŠ å®½è¿›åº¦æ¡ */
            background: #ecf0f1;
            border-radius: 7px;
            overflow: hidden;
            position: relative;
            margin: 8px 0;
        }

        .progress-fill {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            background: linear-gradient(180deg, #3498db, #2980b9);
            transition: height 0.3s ease;
            height: 0%;
            border-radius: 7px;
        }

        .progress-label {
            font-size: 0.7rem;
            font-weight: 700;
            color: #2c3e50;
            writing-mode: vertical-rl;
            text-orientation: mixed;
            margin-top: 8px;
        }

        @media (max-width: 768px) {
            .test-progress {
                width: 20px; /* ç¨å¾®å‡å°å®½åº¦ */
                padding: 6px 3px; /* å‡å°‘padding */
            }
            
            .progress-bar {
                width: 10px; /* ç¨å¾®å‡å°å®½åº¦ */
            }
            
            .progress-label {
                font-size: 0.55rem; /* ç¨å¾®å‡å°å­—ä½“ */
            }
            
            /* ç§»åŠ¨ç«¯æµ‹è¯•å¡ç‰‡å†…éƒ¨çš„è¿›åº¦æ¡æ ·å¼ */
            .test-card .card-progress {
                width: 20px; /* ç¨å¾®å‡å°å®½åº¦ */
                padding: 6px 3px; /* å‡å°‘padding */
            }
            
            .test-card .card-progress .progress-bar {
                width: 10px; /* ç¨å¾®å‡å°å®½åº¦ */
            }
            
            .test-card .card-progress .progress-label {
                font-size: 0.55rem; /* ç¨å¾®å‡å°å­—ä½“ */
                margin-bottom: 4px; /* å‡å°‘margin */
            }
            
            .test-title {
                font-size: 0.95rem; /* å‡å°æ ‡é¢˜å­—ä½“ */
                margin-bottom: 10px; /* å‡å°‘margin */
            }
        }
        
        @media (max-width: 480px) {
            .test-progress {
                width: 18px; /* è¿›ä¸€æ­¥å‡å°å®½åº¦ */
                padding: 5px 2px; /* è¿›ä¸€æ­¥å‡å°‘padding */
            }
            
            .progress-bar {
                width: 9px; /* è¿›ä¸€æ­¥å‡å°å®½åº¦ */
            }
            
            .progress-label {
                font-size: 0.5rem; /* è¿›ä¸€æ­¥å‡å°å­—ä½“ */
            }
            
            /* ç§»åŠ¨ç«¯æµ‹è¯•å¡ç‰‡å†…éƒ¨çš„è¿›åº¦æ¡æ ·å¼ */
            .test-card .card-progress {
                width: 18px; /* è¿›ä¸€æ­¥å‡å°å®½åº¦ */
                padding: 5px 2px; /* è¿›ä¸€æ­¥å‡å°‘padding */
            }
            
            .test-card .card-progress .progress-bar {
                width: 9px; /* è¿›ä¸€æ­¥å‡å°å®½åº¦ */
            }
            
            .test-card .card-progress .progress-label {
                font-size: 0.5rem; /* è¿›ä¸€æ­¥å‡å°å­—ä½“ */
                margin-bottom: 3px; /* è¿›ä¸€æ­¥å‡å°‘margin */
            }
            
            .test-title {
                font-size: 0.85rem; /* è¿›ä¸€æ­¥å‡å°æ ‡é¢˜å­—ä½“ */
                margin-bottom: 8px; /* è¿›ä¸€æ­¥å‡å°‘margin */
            }
        }

        /* æµ‹è¯•æ¨¡å¼å¡ç‰‡æ ·å¼ */
        .test-card {
            height: var(--card-height); /* ä½¿ç”¨ä¸å­¦ä¹ å¡ç‰‡ç›¸åŒçš„é«˜åº¦ */
            perspective: 1000px;
            cursor: pointer;
            width: 100%;
            position: relative;
        }
        
        /* æµ‹è¯•å¡ç‰‡æ­£é¢å’ŒèƒŒé¢å¸ƒå±€ - ä½¿ç”¨flexè®©å†…å®¹å’Œè¿›åº¦æ¡å¹¶æ’ */
        .test-card .card-front,
        .test-card .card-back {
            display: flex;
            flex-direction: row;
            align-items: stretch;
            overflow: hidden;
        }
        
        /* å¡ç‰‡å†…å®¹åŒºåŸŸ - å æ®ä¸»è¦ç©ºé—´ */
        .test-card .card-front-content,
        .test-card .card-back-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        /* æµ‹è¯•å¡ç‰‡å†…éƒ¨çš„è¿›åº¦æ¡ - æ¤å…¥å¡ç‰‡å†…éƒ¨ */
        .test-card .card-progress {
            width: 28px;
            background: #f8f9fa; /* å’Œå¡ç‰‡èƒŒæ™¯ä¸€è‡´çš„æµ…ç°è‰² */
            border-left: 1px solid rgba(0, 0, 0, 0.1);
            padding: 10px 6px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-between;
            flex-shrink: 0;
        }
        
        .test-card .card-progress .progress-info {
            display: none;
        }
        
        /* è°ƒæ•´å…ƒç´ é¡ºåºï¼šæ•°å­—åœ¨ä¸Šï¼Œè¿›åº¦æ¡åœ¨ä¸‹ */
        .test-card .card-progress .progress-label {
            order: -1; /* æ”¾åœ¨æœ€ä¸Šé¢ */
            font-size: 0.7rem;
            font-weight: 700;
            color: #2c3e50;
            writing-mode: vertical-rl;
            text-orientation: mixed;
            margin-bottom: 8px;
        }
        
        .test-card .card-progress .progress-bar {
            order: 0; /* æ”¾åœ¨æ•°å­—ä¸‹é¢ */
            flex: 1;
            width: 14px;
            background: white; /* è¿›åº¦æœªè¾¾åˆ°éƒ¨åˆ†ä¸ºç™½è‰² */
            border-radius: 7px;
            overflow: hidden;
            position: relative;
            margin: 0;
        }
        
        .test-card .card-progress .progress-fill {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            background: linear-gradient(180deg, #3498db, #2980b9); /* å·²å®Œæˆéƒ¨åˆ†ä¸ºè“è‰²æ¸å˜ */
            transition: height 0.3s ease;
            height: 0%;
            border-radius: 7px;
        }

        /* æµ‹è¯•å¡ç‰‡æ­£é¢å¸ƒå±€ä¼˜åŒ– */
        .test-card .card-front {
            padding: 20px 0 20px 25px;
        }
        
        .test-card .card-front-content {
            padding-right: 15px;
        }
        
        /* æµ‹è¯•å¡ç‰‡èƒŒé¢å¸ƒå±€ä¼˜åŒ– */
        .test-card .card-back {
            padding: 0;
        }

        .test-options {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 20px;
            padding: 0;
            flex: 1;
            overflow-y: auto; /* å¦‚æœé€‰é¡¹å¤ªå¤šï¼Œå…è®¸æ»šåŠ¨ */
        }

        .test-option {
            padding: 14px 18px;
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.15rem;
            font-weight: 500;
            text-align: left;
            flex-shrink: 0; /* é˜²æ­¢é€‰é¡¹è¢«å‹ç¼© */
        }
        
        /* ç§»åŠ¨ç«¯æµ‹è¯•å¡ç‰‡å¸ƒå±€ä¼˜åŒ– */
        @media (max-width: 768px) {
            .test-card .card-front {
                padding: 12px 0 12px 18px; /* å‡å°‘padding */
            }
            
            .test-card .card-front-content {
                padding-right: 10px; /* å‡å°‘padding */
            }
            
            .test-options {
                gap: 8px; /* å‡å°‘é€‰é¡¹é—´è· */
                margin-top: 12px; /* å‡å°‘margin-top */
            }
            
            .test-option {
                padding: 10px 14px; /* å‡å°‘padding */
                font-size: 1rem; /* ç¨å¾®å‡å°å­—ä½“ */
            }
            
            .test-question {
                font-size: 1.6rem; /* å‡å°é—®é¢˜å­—ä½“ */
                margin-bottom: 12px; /* å‡å°‘margin */
            }
        }
        
        @media (max-width: 480px) {
            .test-card .card-front {
                padding: 8px 0 8px 15px; /* è¿›ä¸€æ­¥å‡å°‘padding */
            }
            
            .test-card .card-front-content {
                padding-right: 8px; /* è¿›ä¸€æ­¥å‡å°‘padding */
            }
            
            .test-options {
                gap: 6px; /* è¿›ä¸€æ­¥å‡å°‘é€‰é¡¹é—´è· */
                margin-top: 8px; /* è¿›ä¸€æ­¥å‡å°‘margin-top */
            }
            
            .test-option {
                padding: 8px 12px; /* è¿›ä¸€æ­¥å‡å°‘padding */
                font-size: 0.95rem; /* è¿›ä¸€æ­¥å‡å°å­—ä½“ */
                min-height: 42px; /* ç¨å¾®å‡å°æœ€å°é«˜åº¦ */
            }
            
            .test-question {
                font-size: 1.5rem; /* è¿›ä¸€æ­¥å‡å°é—®é¢˜å­—ä½“ */
                margin-bottom: 10px; /* è¿›ä¸€æ­¥å‡å°‘margin */
            }
        }

        .test-option:hover {
            border-color: #3498db;
            background: #e3f2fd;
        }

        .test-option.selected {
            border-color: #3498db;
            background: #e3f2fd;
        }

        .test-option.correct {
            border-color: #27ae60;
            background: #d5f4e6;
        }

        .test-option.incorrect {
            border-color: #e74c3c;
            background: #fadbd8;
        }

        .test-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #34495e;
            text-align: center;
            margin-bottom: 15px;
            padding: 0;
            margin-top: 0;
            flex-shrink: 0;
        }
        
        /* ç§»åŠ¨ç«¯æµ‹è¯•æ ‡é¢˜ä¼˜åŒ– */
        @media (max-width: 768px) {
            .test-title {
                font-size: 0.95rem;
                margin-bottom: 10px;
            }
        }
        
        @media (max-width: 480px) {
            .test-title {
                font-size: 0.85rem;
                margin-bottom: 8px;
            }
        }

        .test-question {
            font-size: 2rem;
            font-weight: 700;
            color: #2c3e50;
            text-align: center;
            margin-bottom: 20px;
            padding: 0;
            margin-top: 0;
            flex-shrink: 0; /* é˜²æ­¢é¢˜ç›®è¢«å‹ç¼© */
        }

        .test-feedback {
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: stretch;
            height: 100%;
            overflow: hidden;
            box-sizing: border-box;
            position: relative;
        }

        /* ä¸Šæ–¹ä¸­æ–‡æ˜¾ç¤ºåŒºåŸŸ */
        .test-feedback .chinese-section {
            flex: 0 0 40%;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            box-sizing: border-box;
        }

        .test-feedback .chinese-meaning {
            font-size: 2rem;
            font-weight: 700;
            color: white;
            text-align: center;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        /* ä¸‹æ–¹å›¾ç‰‡åŒºåŸŸ - å æ®å¡ç‰‡é«˜åº¦çš„60%ï¼Œåº•éƒ¨å¯¹é½ */
        .test-feedback .image-section {
            flex: 0 0 60%;
            display: flex;
            align-items: flex-end;
            justify-content: center;
            min-width: 0;
            padding: 0;
            box-sizing: border-box;
            position: relative;
            overflow: hidden;
        }
        
        .test-feedback .noun-image {
            width: 100%;
            height: 100%;
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            object-position: bottom;
            display: block;
        }
        
        /* å³ä¾§ä¿¡æ¯åŒºåŸŸ - å·²ç§»é™¤ï¼Œä¿¡æ¯æ˜¾ç¤ºåœ¨å›¾ç‰‡ä¸Šæ–¹ */
        .test-feedback .info-section {
            display: none;
        }

        .feedback-icon {
            font-size: 3.5rem;
            margin-bottom: 12px;
            flex-shrink: 0;
        }

        .feedback-icon.correct {
            color: #27ae60;
        }

        .feedback-icon.incorrect {
            color: #e74c3c;
        }

        .feedback-text {
            font-size: 1.4rem;
            font-weight: 600;
            margin-bottom: 16px;
            flex-shrink: 0;
            color: #2c3e50;
        }
        
        /* å¾·è¯­å•è¯æ˜¾ç¤º */
        .test-feedback .noun-word {
            font-size: 2.2rem;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 12px;
            flex-shrink: 0;
            text-align: center;
        }
        
        /* æµ‹è¯•å¡ç‰‡èƒŒé¢çš„å†…å®¹å¸ƒå±€ */
        .test-feedback .meaning {
            font-size: 2rem;
            font-weight: 700;
            color: #e74c3c;
            margin-bottom: 16px;
            flex-shrink: 0;
            text-align: center;
            padding: 12px 20px;
            background: linear-gradient(135deg, #fff5f5 0%, #ffe0e0 100%);
            border-radius: 10px;
            border: 2px solid #ffcccc;
            box-shadow: 0 2px 8px rgba(231, 76, 60, 0.15);
        }
        
        .test-feedback .gender-badge {
            margin-bottom: 16px;
            flex-shrink: 0;
        }
        
        .test-feedback .card-hint {
            margin-top: auto;
            font-size: 0.95rem;
            color: #7f8c8d;
            flex-shrink: 0;
            text-align: center;
            padding: 8px 16px;
            background: rgba(127, 140, 141, 0.1);
            border-radius: 6px;
        }
        
        /* å“åº”å¼è°ƒæ•´ */
        @media (max-width: 768px) {
            .test-feedback {
                flex-direction: column;
                gap: 15px;
            }
            
            .test-feedback .image-section {
                flex: 0 0 200px;
            }
            
            .test-feedback .info-section {
                flex: 1;
            }
        }

        /* å­¦ä¹ æ¨¡å¼å¡ç‰‡æ­£é¢æ˜¾ç¤ºä¸­æ–‡ - ä½äºé®æŒ¡å±‚ä¸Šï¼Œå·¦å³å±…ä¸­ï¼Œä¸é®æŒ¡å±‚åŒæ­¥ä¸‹ç§»å¯¹é½å¡ç‰‡ä¸‹è¾¹ç¼˜ */
        .learning-card-front .meaning-display {
            position: absolute;
            bottom: 0; /* å¯¹é½å¡ç‰‡ä¸‹è¾¹ç¼˜ */
            left: 0;
            right: 0;
            /* ä¸å†ä¸Šç§»ï¼Œä¸é®æŒ¡å±‚åŒæ­¥å¯¹é½å¡ç‰‡ä¸‹è¾¹ç¼˜ */
            transform: none;
            font-size: 2rem;
            font-weight: 700;
            color: #2c3e50;
            text-align: center;
            z-index: 6; /* åœ¨é®æŒ¡å±‚ä¸Šæ–¹ */
            padding: 12px;
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* å­¦ä¹ æ¨¡å¼å¡ç‰‡èƒŒé¢æ˜¾ç¤ºå¾·è¯­ */
        .learning-card-back .noun-display {
            font-size: 3rem;
            font-weight: 700;
            color: white;
            text-align: center;
            margin-bottom: 15px;
        }
        
        /* å­¦ä¹ æ¨¡å¼å¡ç‰‡èƒŒé¢æ˜¾ç¤ºä¸­æ–‡ - ä½äºé®æŒ¡å±‚ä¸Šï¼Œä¸æ­£é¢ä¸€è‡´çš„ä½ç½® */
        .learning-card-back .meaning-display {
            position: absolute;
            bottom: 0; /* å¯¹é½å¡ç‰‡ä¸‹è¾¹ç¼˜ï¼Œä¸æ­£é¢ä¸€è‡´ */
            left: 0;
            right: 0;
            font-size: 2rem;
            font-weight: 700;
            color: #ecf0f1; /* é€‚é…èƒŒé¢æ·±è‰²èƒŒæ™¯ï¼Œä½¿ç”¨æµ…è‰² */
            text-align: center;
            z-index: 101; /* åœ¨é®æŒ¡å±‚ä¸Šæ–¹ï¼ˆé®æŒ¡å±‚z-indexä¸º100ï¼‰ */
            padding: 12px;
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            /* ä¿®å¤Firefoxä¸­çš„é•œåƒç¿»è½¬é—®é¢˜ */
            backface-visibility: visible !important;
            transform-style: preserve-3d !important;
        }
        
        /* èƒŒé¢é®æŒ¡å±‚ - å·²ç§»é™¤æ‰€æœ‰æ–‡å­—æ˜¾ç¤ºå’ŒèƒŒæ™¯ */
        .card-back .image-overlay,
        .learning-card-back .image-overlay {
            position: absolute !important;
            bottom: 0 !important;
            left: 0 !important;
            right: 0 !important;
            /* ç»Ÿä¸€ä½¿ç”¨ä¸æ­£é¢ç›¸åŒçš„è®¡ç®—æ–¹å¼ï¼Œè€ƒè™‘paddingï¼Œç¡®ä¿æ˜¾ç¤ºä¸€è‡´ */
            height: calc((100% - var(--card-padding-learning) * 2) * var(--overlay-height-ratio)) !important;
            /* å·²ç§»é™¤ç°è‰²èƒŒæ™¯è’™ç‰ˆ */
            background: transparent !important;
            border-radius: 0 0 var(--card-border-radius) var(--card-border-radius) !important;
            z-index: 100 !important; /* æé«˜z-indexç¡®ä¿åœ¨æœ€ä¸Šå±‚ */
            pointer-events: none !important;
            box-sizing: border-box !important;
            /* ç¡®ä¿ä¸æ˜¾ç¤ºä»»ä½•æ–‡å­—å†…å®¹ */
            content: none !important;
            /* ä¿®å¤Firefoxä¸­çš„é•œåƒç¿»è½¬é—®é¢˜ */
            backface-visibility: visible !important;
            transform-style: preserve-3d !important;
        }
        
        /* ç¡®ä¿é®æŒ¡å±‚çš„ä¼ªå…ƒç´ ä¹Ÿä¸æ˜¾ç¤ºä»»ä½•å†…å®¹ */
        .card-back .image-overlay::before,
        .card-back .image-overlay::after,
        .learning-card-back .image-overlay::before,
        .learning-card-back .image-overlay::after {
            content: none !important;
            display: none !important;
        }
    </style>
</head>
<body>
    <!-- åˆå§‹è®¾ç½®å¼¹çª— -->
    <div id="setup-modal" class="modal">
        <div class="modal-content">
            <h2>æ¬¢è¿ä½¿ç”¨å¾·è¯­A1è¯æ±‡å­¦ä¹ ç³»ç»Ÿ</h2>
            <p>è¯·å…ˆå®Œæˆåˆå§‹è®¾ç½®</p>
            <div class="setup-form">
                <div class="setup-group">
                    <label>ç”¨æˆ·ç±»å‹ï¼š</label>
                    <div class="radio-group">
                        <label class="radio-label">
                            <input type="radio" name="userType" value="adult" checked>
                            <span>æˆäºº</span>
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="userType" value="teenager">
                            <span>é’å°‘å¹´</span>
                        </label>
                    </div>
                </div>
                <div class="setup-group">
                    <label>å­¦ä¹ èƒ½åŠ›ï¼š</label>
                    <div class="radio-group">
                        <label class="radio-label">
                            <input type="radio" name="ability" value="normal" checked>
                            <span>æ™®é€š</span>
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="ability" value="good">
                            <span>è‰¯å¥½</span>
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="ability" value="excellent">
                            <span>ä¼˜ç§€</span>
                        </label>
                    </div>
                </div>
                <button class="btn-primary" onclick="saveUserConfig()">å¼€å§‹å­¦ä¹ </button>
            </div>
        </div>
    </div>
    
    <!-- å›ºå®šæ‚¬æµ®æ  -->
    <div class="fixed-top-bar" id="fixed-top-bar" style="display: none;">
        <div class="top-bar-left">
            <div class="top-bar-title">è‡³å…ƒå¾·è¯­ - A1è¯æ±‡å¡ç‰‡å­¦ä¹ </div>
            <div class="top-bar-mode-buttons">
                <button class="top-bar-mode-btn active" data-mode="learning" onclick="switchMode('learning')">
                    <span class="icon">ğŸ“–</span> å­¦ä¹ 
                </button>
                <button class="top-bar-mode-btn" data-mode="test" onclick="switchMode('test')">
                    <span class="icon">âœ“</span> æµ‹è¯•
                </button>
            </div>
        </div>
        <div class="top-bar-center">
            <div class="current-theme-display" id="current-theme-display">
                <span class="current-theme-label">å½“å‰å­¦ä¹ ï¼š</span>
                <span class="current-theme-name" id="current-theme-name">-</span>
            </div>
        </div>
        <div class="top-bar-right">
            <div class="top-bar-progress" id="top-bar-progress">
                <div class="progress-stat completed">
                    <span class="progress-stat-label">å·²å®Œæˆ:</span>
                    <span class="progress-stat-value" id="progress-completed">0</span>
                </div>
                <div class="progress-stat learning">
                    <span class="progress-stat-label">å­¦ä¹ ä¸­:</span>
                    <span class="progress-stat-value" id="progress-learning">0</span>
                </div>
                <div class="progress-stat locked">
                    <span class="progress-stat-label">å¾…è§£é”:</span>
                    <span class="progress-stat-value" id="progress-locked">0</span>
                </div>
            </div>
        </div>
    </div>

    <!-- æ¨¡å¼åˆ‡æ¢å™¨ - å·²ç§»åˆ°å›ºå®šæ ï¼Œä¿ç•™ç”¨äºå…¼å®¹ -->
    <div class="mode-switcher" id="mode-switcher" style="display: none;">
        <button class="mode-btn active" data-mode="learning" onclick="switchMode('learning')">
            <span class="icon">ğŸ“–</span> å­¦ä¹ æ¨¡å¼
        </button>
        <button class="mode-btn" data-mode="test" onclick="switchMode('test')">
            <span class="icon">âœ“</span> æµ‹è¯•æ¨¡å¼
        </button>
    </div>

    <!-- ä¸»é¢˜å¯¼èˆª - å·²ç§»åˆ°å›ºå®šæ ï¼Œä¿ç•™ç”¨äºå…¼å®¹ -->
    <div class="theme-navigation" id="theme-navigation" style="display: none;">
        <div class="theme-list" id="theme-list"></div>
    </div>

    <!-- æµ‹è¯•è¿›åº¦æ˜¾ç¤º - ä¾§è¾¹ç«–å‘çª„æ¡ -->
    <div class="test-progress" id="test-progress" style="display: none;">
        <div class="progress-info">
            <span id="test-type-label">è¯­ä¹‰æµ‹è¯•</span>
        </div>
        <div class="progress-bar">
            <div class="progress-fill" id="progress-fill"></div>
        </div>
        <div class="progress-label" id="test-progress-label">0/0</div>
    </div>

    <!-- è§£é”é€šçŸ¥å¼¹çª— -->
    <div id="unlock-modal" class="modal" style="display: none;">
        <div class="modal-content unlock-content">
            <h2>ğŸ‰ æ­å–œè§£é”ï¼</h2>
            <p id="unlock-message"></p>
            <div class="modal-buttons">
                <button class="btn-primary" onclick="startTest2()">å¼€å§‹è¯æ€§æµ‹è¯•</button>
                <button class="btn-secondary" onclick="skipToNextTheme()">è·³è¿‡ï¼Œè¿›å…¥ä¸‹ä¸€ä¸»é¢˜</button>
            </div>
        </div>
    </div>

    <!-- é‡è¯•æç¤ºå¼¹çª— -->
    <div id="retry-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <h2>æµ‹è¯•æœªé€šè¿‡</h2>
            <p id="retry-message"></p>
            <div class="modal-buttons">
                <button class="btn-primary" onclick="returnToLearning()">è¿”å›å­¦ä¹ </button>
            </div>
        </div>
    </div>

    <div class="header">
        <h1>å¾·è¯­A1è¯æ±‡å¡ç‰‡ - åè¯å­¦ä¹ </h1>
        <p id="header-description">æŒ‰ä¸»é¢˜åˆ†ç±» | ç‚¹å‡»<span class="icon">ğŸ”Š</span>å‘éŸ³ | ç‚¹å‡»å¡ç‰‡ç¿»è½¬æŸ¥çœ‹</p>
    </div>
    
    <!-- æµ‹è¯•æç¤ºæ–‡å­— -->
    <div class="test-instruction" id="test-instruction" style="display: none;">
        è¯·æ‰¾å‡ºå’Œå¾·è¯­å•è¯åŒ¹é…çš„é€‰é¡¹ï¼š
    </div>
    
    <!-- å¡ç‰‡å®¹å™¨ -->
    <div class="cards-container" id="cards-container">
        <div class="loader">
            <span class="icon icon-spin">âŸ³</span> æ­£åœ¨åŠ è½½è¯æ±‡å¡ç‰‡...
        </div>
    </div>
    
    <div class="footer">
        <p>å¾·è¯­A1è¯æ±‡å­¦ä¹ å¡ç‰‡ | æŒ‰ä¸»é¢˜åˆ†ç±»</p>
        <p>æ€»è®¡: <span id="total-count">0</span>ä¸ªè¯æ±‡</p>
    </div>
    
    <script>
        // ==================== æ ¸å¿ƒæ•°æ®ç»“æ„ ====================
        
        // ç”¨æˆ·é…ç½®
        let userConfig = {
            userType: null,      // 'adult' æˆ– 'teenager'
            ability: null,       // 'normal', 'good', 'excellent'
            setupCompleted: false
        };

        // ä¸»é¢˜æ’åºé…ç½®
        const themeOrder = {
            adult: [
                'æ—¶é—´å’Œæ—¥æœŸ', 'æé—®å’Œäº¤æµ', 'é£Ÿç‰©', 'å±…ä½', 'äº¤é€šå’Œæ—…è¡Œ',
                'è´­ç‰©', 'çœ‹åŒ»ç”Ÿ', 'é“¶è¡Œå’Œé‚®å±€', 'å­¦ä¹ å’Œå·¥ä½œ', 'ä¸šä½™æ´»åŠ¨'
            ],
            teenager: [
                'æ—¶é—´å’Œæ—¥æœŸ', 'æé—®å’Œäº¤æµ', 'é£Ÿç‰©', 'å±…ä½', 'äº¤é€šå’Œæ—…è¡Œ',
                'è´­ç‰©', 'çœ‹åŒ»ç”Ÿ', 'é“¶è¡Œå’Œé‚®å±€', 'å­¦ä¹ å’Œå·¥ä½œ', 'ä¸šä½™æ´»åŠ¨',
                'æ–‡å…·', 'åŠ¨ç‰©'
            ]
        };

        // æµ‹è¯•è§„åˆ™é…ç½®
        const testRules = {
            normal: {
                test1: {
                    passRate: 0.8,
                    required: true,
                    unlockTest2: false
                },
                test2: {
                    passRate: null,
                    required: false,
                    hidden: true
                }
            },
            good: {
                test1: {
                    passRate: 0.8,
                    required: true,
                    unlockTest2: true,
                    unlockThreshold: 0.9  // ç¬¬ä¸€æ¬¡æµ‹è¯•éœ€è¦â‰¥90%æ‰è§£é”
                },
                test2: {
                    passRate: null,
                    required: false,
                    hidden: false
                }
            },
            excellent: {
                test1: {
                    passRate: 0.9,
                    required: true,
                    unlockTest2: false
                },
                test2: {
                    passRate: 0.7,
                    required: true,
                    hidden: false
                }
            }
        };

        // å­¦ä¹ è¿›åº¦
        let learningProgress = {
            currentThemeIndex: 0,
            currentMode: 'learning',  // 'learning' æˆ– 'test'
            currentTestType: null,    // 'test1' æˆ– 'test2'
            currentTheme: null,
            themes: {}
        };

        // å½“å‰æµ‹è¯•çŠ¶æ€
        let currentTest = {
            type: null,           // 'meaning' æˆ– 'gender'
            theme: null,
            questions: [],
            currentIndex: 0,
            answers: [],
            startTime: null
        };

        // ==================== å·¥å…·å‡½æ•° ====================
        
        // DOMå…ƒç´ ç¼“å­˜
        const domCache = {
            setupModal: null,
            fixedTopBar: null,
            unlockModal: null,
            retryModal: null,
            cardsContainer: null,
            headerDescription: null,
            init: function() {
                this.setupModal = document.getElementById('setup-modal');
                this.fixedTopBar = document.getElementById('fixed-top-bar');
                this.unlockModal = document.getElementById('unlock-modal');
                this.retryModal = document.getElementById('retry-modal');
                this.cardsContainer = document.getElementById('cards-container');
                this.headerDescription = document.getElementById('header-description');
            }
        };
        
        // ç»Ÿä¸€çš„modalæ˜¾ç¤º/éšè—æ§åˆ¶
        function showModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.add('show');
                // ç¡®ä¿ç§»é™¤å†…è”æ ·å¼ï¼Œè®©CSSç±»ç”Ÿæ•ˆ
                modal.style.display = '';
            }
        }
        
        function hideModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.remove('show');
                // ç¡®ä¿éšè—
                modal.style.display = 'none';
            }
        }

        // ==================== é…ç½®ç®¡ç†å‡½æ•° ====================
        
        // ä¿å­˜ç”¨æˆ·é…ç½®
        function saveUserConfig() {
            const userType = document.querySelector('input[name="userType"]:checked').value;
            const ability = document.querySelector('input[name="ability"]:checked').value;
            
            userConfig.userType = userType;
            userConfig.ability = ability;
            userConfig.setupCompleted = true;
            
            // å¼‚æ­¥ä¿å­˜ï¼Œé¿å…é˜»å¡UI
            setTimeout(() => {
                try {
            localStorage.setItem('userConfig', JSON.stringify(userConfig));
                } catch (e) {
                    console.error('ä¿å­˜ç”¨æˆ·é…ç½®å¤±è´¥:', e);
                }
            }, 0);
            
            // åˆå§‹åŒ–å­¦ä¹ è¿›åº¦
            initializeLearningProgress();
            
            // éšè—è®¾ç½®å¼¹çª—
            hideModal('setup-modal');
            
            // æ˜¾ç¤ºä¸»ç•Œé¢
            if (domCache.fixedTopBar) {
                domCache.fixedTopBar.style.display = 'flex';
            }
            
            // æ›´æ–°ç•Œé¢
            updateHeaderDescription();
            updateTopBarProgress();
            updateCurrentThemeDisplay();
            loadCurrentTheme();
        }

        // åŠ è½½ç”¨æˆ·é…ç½®
        function loadUserConfig() {
            try {
            const saved = localStorage.getItem('userConfig');
            if (saved) {
                    try {
                userConfig = JSON.parse(saved);
                        // éªŒè¯é…ç½®å®Œæ•´æ€§
                        if (!userConfig.userType || !userConfig.ability) {
                            console.warn('ç”¨æˆ·é…ç½®ä¸å®Œæ•´ï¼Œé‡ç½®é…ç½®');
                            userConfig = {
                                userType: null,
                                ability: null,
                                setupCompleted: false
                            };
                            // å¼‚æ­¥åˆ é™¤ï¼Œé¿å…é˜»å¡
                            setTimeout(() => {
                                try {
                                    localStorage.removeItem('userConfig');
                                } catch (e) {
                                    console.error('åˆ é™¤ç”¨æˆ·é…ç½®å¤±è´¥:', e);
                                }
                            }, 0);
                        }
                    } catch (parseError) {
                        console.error('è§£æç”¨æˆ·é…ç½®å¤±è´¥:', parseError);
                        userConfig = {
                            userType: null,
                            ability: null,
                            setupCompleted: false
                        };
                    }
                }
            } catch (e) {
                console.error('åŠ è½½ç”¨æˆ·é…ç½®å¤±è´¥:', e);
                userConfig = {
                    userType: null,
                    ability: null,
                    setupCompleted: false
                };
                // å¼‚æ­¥åˆ é™¤ï¼Œé¿å…é˜»å¡
                setTimeout(() => {
                    try {
                        localStorage.removeItem('userConfig');
                    } catch (err) {
                        console.error('åˆ é™¤ç”¨æˆ·é…ç½®å¤±è´¥:', err);
                    }
                }, 0);
            }
        }

        // åˆå§‹åŒ–å­¦ä¹ è¿›åº¦
        function initializeLearningProgress() {
            const themes = themeOrder[userConfig.userType];
            const progress = {
                currentThemeIndex: 0,
                currentMode: 'learning',
                currentTestType: null,
                currentTheme: themes[0] || null,
                themes: {}
            };

            themes.forEach((theme, index) => {
                progress.themes[theme] = {
                    status: index === 0 ? 'learning' : 'locked',
                    test1: {
                        status: index === 0 ? 'available' : 'locked',  // ç¬¬ä¸€ä¸ªä¸»é¢˜çš„test1å¯ç”¨
                        passRate: null,
                        attempts: 0,
                        firstAttemptPassRate: null,
                        lastAttempt: null
                    },
                    test2: {
                        status: 'locked',
                        passRate: null,
                        attempts: 0,
                        unlocked: false,
                        unlockable: false,
                        lastAttempt: null
                    }
                };
            });

            learningProgress = progress;
            saveLearningProgress();
        }

        // åŠ è½½å­¦ä¹ è¿›åº¦
        function loadLearningProgress() {
            try {
            const saved = localStorage.getItem('learningProgress');
            if (saved) {
                    try {
                learningProgress = JSON.parse(saved);
                        
                        // éªŒè¯å­¦ä¹ è¿›åº¦å®Œæ•´æ€§
                        if (!learningProgress || typeof learningProgress !== 'object') {
                            console.warn('å­¦ä¹ è¿›åº¦æ•°æ®æ— æ•ˆï¼Œå°†é‡æ–°åˆå§‹åŒ–');
                            learningProgress = null;
                            // å¼‚æ­¥åˆ é™¤ï¼Œé¿å…é˜»å¡
                            setTimeout(() => {
                                try {
                                    localStorage.removeItem('learningProgress');
                                } catch (e) {
                                    console.error('åˆ é™¤å­¦ä¹ è¿›åº¦å¤±è´¥:', e);
                                }
                            }, 0);
                        } else {
                            // ç¡®ä¿currentModeæœ‰é»˜è®¤å€¼
                            if (!learningProgress.currentMode) {
                                learningProgress.currentMode = 'learning';
                            }
                
                // ç¡®ä¿æ•°æ®å…¼å®¹æ€§ï¼šå¦‚æœä¸»é¢˜æ˜¯learningçŠ¶æ€ï¼Œtest1åº”è¯¥æ˜¯available
                            if (learningProgress.themes && typeof learningProgress.themes === 'object') {
                                Object.keys(learningProgress.themes).forEach(theme => {
                    const themeData = learningProgress.themes[theme];
                                    if (themeData && themeData.status === 'learning' && themeData.test1 && themeData.test1.status === 'locked') {
                        themeData.test1.status = 'available';
                    }
                });
                            }
                        }
                    } catch (parseError) {
                        console.error('è§£æå­¦ä¹ è¿›åº¦å¤±è´¥:', parseError);
                        learningProgress = null;
                    }
                }
            } catch (e) {
                console.error('åŠ è½½å­¦ä¹ è¿›åº¦å¤±è´¥:', e);
                learningProgress = null;
                // å¼‚æ­¥åˆ é™¤ï¼Œé¿å…é˜»å¡
                setTimeout(() => {
                    try {
                        localStorage.removeItem('learningProgress');
                    } catch (err) {
                        console.error('åˆ é™¤å­¦ä¹ è¿›åº¦å¤±è´¥:', err);
                    }
                }, 0);
            }
        }

        // ä¿å­˜å­¦ä¹ è¿›åº¦
        function saveLearningProgress() {
            // å¼‚æ­¥ä¿å­˜ï¼Œé¿å…é˜»å¡UI
            setTimeout(() => {
                try {
            localStorage.setItem('learningProgress', JSON.stringify(learningProgress));
                } catch (e) {
                    console.error('ä¿å­˜å­¦ä¹ è¿›åº¦å¤±è´¥:', e);
                }
            }, 0);
        }

        // ==================== ç•Œé¢æ›´æ–°å‡½æ•° ====================
        
        // æ›´æ–°å¤´éƒ¨æè¿°
        function updateHeaderDescription() {
            if (!domCache.headerDescription) return;
            if (learningProgress.currentMode === 'learning') {
                domCache.headerDescription.textContent = 'ç‚¹å‡»å¡ç‰‡æ­£é¢æŸ¥çœ‹ä¸­æ–‡+å›¾ç‰‡ï¼ŒèƒŒé¢æŸ¥çœ‹å¾·è¯­+è¯æ€§+å‘éŸ³';
            } else {
                domCache.headerDescription.textContent = 'æµ‹è¯•æ¨¡å¼ï¼šé€‰æ‹©æ­£ç¡®ç­”æ¡ˆ';
            }
        }

        // æ¨¡å¼åˆ‡æ¢
        function switchMode(mode) {
            learningProgress.currentMode = mode;
            saveLearningProgress();
            
            // æ›´æ–°å›ºå®šæ æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.top-bar-mode-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            const activeBtn = document.querySelector(`.top-bar-mode-btn[data-mode="${mode}"]`);
            if (activeBtn) {
                activeBtn.classList.add('active');
            }
            
            // æ›´æ–°åŸæ¥çš„æŒ‰é’®çŠ¶æ€ï¼ˆå…¼å®¹ï¼‰
            document.querySelectorAll('.mode-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            const oldActiveBtn = document.querySelector(`.mode-btn[data-mode="${mode}"]`);
            if (oldActiveBtn) {
                oldActiveBtn.classList.add('active');
            }
            
            updateHeaderDescription();
            
            // ç¡®ä¿å›ºå®šé¡¶éƒ¨æ æ˜¾ç¤ºï¼ˆç‰¹åˆ«æ˜¯åœ¨ç§»åŠ¨ç«¯æµ‹è¯•æ¨¡å¼ä¸‹ï¼‰
            if (domCache.fixedTopBar) {
                domCache.fixedTopBar.style.display = 'flex';
            }
            
            if (mode === 'learning') {
                document.getElementById('test-progress').style.display = 'none';
                document.getElementById('test-instruction').style.display = 'none';
                document.body.classList.remove('test-mode'); /* ç§»é™¤æµ‹è¯•æ¨¡å¼ç±» */
                loadCurrentTheme();
            } else {
                document.getElementById('test-progress').style.display = 'flex'; /* æ”¹ä¸ºflex */
                // ä¸å†æ˜¾ç¤ºåŸæ¥çš„æµ‹è¯•æç¤ºæ–‡å­—ï¼Œå› ä¸ºå®ƒä¼šè¢«ç§»åˆ°æ ‡é¢˜è¡Œä¸­
                // document.getElementById('test-instruction').style.display = 'block';
                document.body.classList.add('test-mode'); /* æ·»åŠ æµ‹è¯•æ¨¡å¼ç±» */
                startTest('test1');
            }
        }
        
        // æ›´æ–°é¡¶éƒ¨æ è¿›åº¦ç»Ÿè®¡
        function updateTopBarProgress() {
            if (!userConfig.setupCompleted) return;
            
            const themes = themeOrder[userConfig.userType] || [];
            let completed = 0;
            let learning = 0;
            let locked = 0;
            
            themes.forEach(theme => {
                const themeData = learningProgress.themes[theme] || {};
                if (themeData.status === 'completed') {
                    completed++;
                } else if (themeData.status === 'learning') {
                    learning++;
                } else if (themeData.status === 'locked') {
                    locked++;
                }
            });
            
            document.getElementById('progress-completed').textContent = completed;
            document.getElementById('progress-learning').textContent = learning;
            document.getElementById('progress-locked').textContent = locked;
            
            // æ›´æ–°å½“å‰ä¸»é¢˜æ˜¾ç¤º
            updateCurrentThemeDisplay();
        }
        
        // æ›´æ–°å½“å‰ä¸»é¢˜æ˜¾ç¤º
        function updateCurrentThemeDisplay() {
            const currentTheme = learningProgress.currentTheme;
            const themeNameElement = document.getElementById('current-theme-name');
            
            if (currentTheme && themeNameElement) {
                themeNameElement.textContent = currentTheme;
            } else if (themeNameElement) {
                themeNameElement.textContent = '-';
            }
        }

        // è¯æ±‡æ•°æ® - æ ¹æ®å›¾ç‰‡æ–‡ä»¶åç”Ÿæˆ
        const vocabulary = [
            // A1W01 æ—¶é—´å’Œæ—¥æœŸ 30è¯
            { noun: "Wochenende", meaning: "å‘¨æœ«", image: "Wochenende.jpg", category: "æ—¶é—´å’Œæ—¥æœŸ", gender: "das" },
            { noun: "Woche", meaning: "å‘¨", image: "Woche.jpg", category: "æ—¶é—´å’Œæ—¥æœŸ", gender: "die" },
            { noun: "Winter", meaning: "å†¬å¤©", image: "Winter.jpg", category: "æ—¶é—´å’Œæ—¥æœŸ", gender: "der" },
            { noun: "Vormittag", meaning: "ä¸Šåˆ", image: "Vormittag.jpg", category: "æ—¶é—´å’Œæ—¥æœŸ", gender: "der" },
            { noun: "Urlaub", meaning: "åº¦å‡", image: "Urlaub.jpg", category: "æ—¶é—´å’Œæ—¥æœŸ", gender: "der" },
            { noun: "Tag", meaning: "å¤©ã€ç™½å¤©", image: "Tag.png", category: "æ—¶é—´å’Œæ—¥æœŸ", gender: "der" },
            { noun: "Sonntag", meaning: "å‘¨æ—¥", image: "Sonntag.jpg", category: "æ—¶é—´å’Œæ—¥æœŸ", gender: "der" },
            { noun: "Sommer", meaning: "å¤å¤©", image: "Sommer.jpg", category: "æ—¶é—´å’Œæ—¥æœŸ", gender: "der" },
            { noun: "Samstag", meaning: "å‘¨å…­", image: "Samstag.jpg", category: "æ—¶é—´å’Œæ—¥æœŸ", gender: "der" },
            { noun: "Nacht", meaning: "å¤œ", image: "Nacht.jpg", category: "æ—¶é—´å’Œæ—¥æœŸ", gender: "die" },
            { noun: "Nachmittag", meaning: "ä¸‹åˆ", image: "Nachmittag.jpg", category: "æ—¶é—´å’Œæ—¥æœŸ", gender: "der" },
            { noun: "MÃ¤rz", meaning: "3æœˆ", image: "MÃ¤rz.png", category: "æ—¶é—´å’Œæ—¥æœŸ", gender: "der" },
            { noun: "Morgen", meaning: "æ—©æ™¨", image: "Morgen.jpg", category: "æ—¶é—´å’Œæ—¥æœŸ", gender: "der" },
            { noun: "Montag", meaning: "å‘¨ä¸€", image: "Montag.jpg", category: "æ—¶é—´å’Œæ—¥æœŸ", gender: "der" },
            { noun: "Monat", meaning: "æœˆ", image: "Monat.jpg", category: "æ—¶é—´å’Œæ—¥æœŸ", gender: "der" },
            { noun: "Mittag", meaning: "ä¸­åˆ", image: "Mittag.jpg", category: "æ—¶é—´å’Œæ—¥æœŸ", gender: "der" },
            { noun: "Mai", meaning: "5æœˆ", image: "Mai.png", category: "æ—¶é—´å’Œæ—¥æœŸ", gender: "der" },
            { noun: "Juni", meaning: "6æœˆ", image: "Juni.png", category: "æ—¶é—´å’Œæ—¥æœŸ", gender: "der" },
            { noun: "Juli", meaning: "7æœˆ", image: "Juli.png", category: "æ—¶é—´å’Œæ—¥æœŸ", gender: "der" },
            { noun: "Januar", meaning: "1æœˆ", image: "Januar.png", category: "æ—¶é—´å’Œæ—¥æœŸ", gender: "der" },
            { noun: "Jahreszeiten", meaning: "å­£èŠ‚", image: "Jahreszeiten.jpg", category: "æ—¶é—´å’Œæ—¥æœŸ" }, // å¤æ•°
            { noun: "Jahr", meaning: "å¹´", image: "Jahr.jpg", category: "æ—¶é—´å’Œæ—¥æœŸ", gender: "das" },
            { noun: "Herbst", meaning: "ç§‹å¤©", image: "Herbst.jpg", category: "æ—¶é—´å’Œæ—¥æœŸ", gender: "der" },
            { noun: "FrÃ¼hling", meaning: "æ˜¥å¤©", image: "FrÃ¼hling.jpg", category: "æ—¶é—´å’Œæ—¥æœŸ", gender: "der" },
            { noun: "Feiertag", meaning: "èŠ‚å‡æ—¥", image: "Feiertag.jpg", category: "æ—¶é—´å’Œæ—¥æœŸ", gender: "der" },
            { noun: "Ende", meaning: "ç»“æŸ", image: "Ende.jpg", category: "æ—¶é—´å’Œæ—¥æœŸ", gender: "das" },
            { noun: "Donnerstag", meaning: "å‘¨å››", image: "Donnerstag.jpg", category: "æ—¶é—´å’Œæ—¥æœŸ", gender: "der" },
            { noun: "Dezember", meaning: "12æœˆ", image: "Dezember.png", category: "æ—¶é—´å’Œæ—¥æœŸ", gender: "der" },
            { noun: "Anfang", meaning: "å¼€å§‹", image: "Anfang.jpg", category: "æ—¶é—´å’Œæ—¥æœŸ", gender: "der" },
            { noun: "Abend", meaning: "å‚æ™š", image: "Abend.jpg", category: "æ—¶é—´å’Œæ—¥æœŸ", gender: "der" },

            // A1W02 æé—®å’Œäº¤æµ 38è¯
            { noun: "Name", meaning: "å", image: "Name.jpg", category: "æé—®å’Œäº¤æµ", gender: "der" },
            { noun: "Verwandte", meaning: "äº²æˆš", image: "Verwandte.jpg", category: "æé—®å’Œäº¤æµ" }, // å¤æ•°
            { noun: "Vater", meaning: "çˆ¶äº²", image: "Vater.jpg", category: "æé—®å’Œäº¤æµ", gender: "der" },
            { noun: "Tochter", meaning: "å¥³å„¿", image: "Tochter.jpg", category: "æé—®å’Œäº¤æµ", gender: "die" },
            { noun: "StaatsangehÃ¶rigkeit", meaning: "å›½ç±", image: "StaatsangehÃ¶rigkeit.jpg", category: "æé—®å’Œäº¤æµ", gender: "die" },
            { noun: "Sohn", meaning: "å„¿å­", image: "Sohn.jpg", category: "æé—®å’Œäº¤æµ", gender: "der" },
            { noun: "Schwester", meaning: "å§å¦¹", image: "Schwester.jpg", category: "æé—®å’Œäº¤æµ", gender: "die" },
            { noun: "Reisepass", meaning: "æŠ¤ç…§", image: "Reisepass.jpg", category: "æé—®å’Œäº¤æµ", gender: "der" },
            { noun: "Vorname", meaning: "å§“å", image: "Vorname.jpg", category: "æé—®å’Œäº¤æµ", gender: "der" },
            { noun: "Nachname", meaning: "å§“", image: "Nachname.jpg", category: "æé—®å’Œäº¤æµ", gender: "der" },
            { noun: "MÃ¤dchen", meaning: "å¥³å­©", image: "MÃ¤dchen.jpg", category: "æé—®å’Œäº¤æµ", gender: "das" },
            { noun: "Mutter", meaning: "æ¯äº²", image: "Mutter.jpg", category: "æé—®å’Œäº¤æµ", gender: "die" },
            { noun: "Mann", meaning: "ç”·äºº", image: "Mann.jpg", category: "æé—®å’Œäº¤æµ", gender: "der" },
            { noun: "Kindergarten", meaning: "å¹¼å„¿å›­", image: "Kindergarten.jpg", category: "æé—®å’Œäº¤æµ", gender: "der" },
            { noun: "Kind", meaning: "å­©å­", image: "Kind.jpg", category: "æé—®å’Œäº¤æµ", gender: "das" },
            { noun: "Junge", meaning: "ç”·å­©", image: "Junge.jpg", category: "æé—®å’Œäº¤æµ", gender: "der" },
            { noun: "Hochzeit", meaning: "å©šç¤¼", image: "Hochzeit.jpg", category: "æé—®å’Œäº¤æµ", gender: "die" },
            { noun: "Herr", meaning: "å…ˆç”Ÿ", image: "Herr.jpg", category: "æé—®å’Œäº¤æµ", gender: "der" },
            { noun: "GroÃŸvater", meaning: "ï¼ˆå¤–ï¼‰ç¥–çˆ¶", image: "GroÃŸvater.jpg", category: "æé—®å’Œäº¤æµ", gender: "der" },
            { noun: "GroÃŸmutter", meaning: "ï¼ˆå¤–ï¼‰ç¥–æ¯", image: "GroÃŸmutter.jpg", category: "æé—®å’Œäº¤æµ", gender: "die" },
            { noun: "GroÃŸeltern", meaning: "ï¼ˆå¤–ï¼‰ç¥–çˆ¶æ¯", image: "GroÃŸeltern.jpg", category: "æé—®å’Œäº¤æµ" }, // å¤æ•°
            { noun: "Geschwister", meaning: "å…„å¼Ÿå§å¦¹", image: "Geschwister.jpg", category: "æé—®å’Œäº¤æµ" }, // å¤æ•°
            { noun: "Geburtstag", meaning: "ç”Ÿæ—¥", image: "Geburtstag.jpg", category: "æé—®å’Œäº¤æµ", gender: "der" },
            { noun: "Geburtsdatum", meaning: "å‡ºç”Ÿæ—¥æœŸ", image: "Geburtsdatum.jpg", category: "æé—®å’Œäº¤æµ", gender: "das" },
            { noun: "Freundin", meaning: "å¥³æœ‹å‹", image: "Freundin.jpg", category: "æé—®å’Œäº¤æµ", gender: "die" },
            { noun: "Freund", meaning: "æœ‹å‹", image: "Freund.jpg", category: "æé—®å’Œäº¤æµ", gender: "der" },
            { noun: "Frau", meaning: "å¥³å£«ï¼Œå¥³äºº", image: "Frau.jpg", category: "æé—®å’Œäº¤æµ", gender: "die" },
            { noun: "Formular", meaning: "è¡¨æ ¼", image: "Formular.jpg", category: "æé—®å’Œäº¤æµ", gender: "das" },
            { noun: "Familienstand", meaning: "å©šå§»çŠ¶å†µ", image: "Familienstand.jpg", category: "æé—®å’Œäº¤æµ", gender: "der" },
            { noun: "Familienname", meaning: "å§“", image: "Familienname.jpg", category: "æé—®å’Œäº¤æµ", gender: "der" },
            { noun: "Familie", meaning: "å®¶åº­ï¼Œå®¶äºº", image: "Familie.jpg", category: "æé—®å’Œäº¤æµ", gender: "die" },
            { noun: "Erwachsene", meaning: "æˆäºº", image: "Erwachsene.jpg", category: "æé—®å’Œäº¤æµ" }, // å¤æ•°
            { noun: "Eltern", meaning: "çˆ¶æ¯", image: "Eltern.jpg", category: "æé—®å’Œäº¤æµ" }, // å¤æ•°
            { noun: "Ehemann", meaning: "ä¸ˆå¤«", image: "Ehemann.jpg", category: "æé—®å’Œäº¤æµ", gender: "der" },
            { noun: "Ehefrau", meaning: "å¦»å­", image: "Ehefrau.jpg", category: "æé—®å’Œäº¤æµ", gender: "die" },
            { noun: "Dame", meaning: "å¥³å£«", image: "Dame.jpg", category: "æé—®å’Œäº¤æµ", gender: "die" },
            { noun: "Bruder", meaning: "å…„å¼Ÿ", image: "Bruder.jpg", category: "æé—®å’Œäº¤æµ", gender: "der" },
            { noun: "Baby", meaning: "å©´å„¿", image: "Baby.jpg", category: "æé—®å’Œäº¤æµ", gender: "das" },

            // A1W03 è¡£æœ 11è¯
            { noun: "Schuhe", meaning: "é‹å­", image: "Schuhe.jpg", category: "è¡£æœ" }, // å¤æ•°
            { noun: "Rock", meaning: "çŸ­è£™", image: "Rock.jpg", category: "è¡£æœ", gender: "der" },
            { noun: "Pullover", meaning: "æ¯›è¡£", image: "Pullover.jpg", category: "è¡£æœ", gender: "der" },
            { noun: "Mantel", meaning: "é•¿å¤–å¥—", image: "Mantel.jpg", category: "è¡£æœ", gender: "der" },
            { noun: "Kleidung", meaning: "è¡£æœ", image: "Kleidung.jpg", category: "è¡£æœ", gender: "die" },
            { noun: "Jeans", meaning: "ç‰›ä»”è£¤", image: "Jeans.jpg", category: "è¡£æœ", gender: "die" },
            { noun: "Jacke", meaning: "å¤¹å…‹ï¼ˆçŸ­å¤–å¥—ï¼‰", image: "Jacke.jpg", category: "è¡£æœ", gender: "die" },
            { noun: "Hose", meaning: "è£¤å­", image: "Hose.jpg", category: "è¡£æœ", gender: "die" },
            { noun: "Hemd", meaning: "ç”·è¡¬è¡«", image: "Hemd.jpg", category: "è¡£æœ", gender: "das" },
            { noun: "GrÃ¶ÃŸe", meaning: "å°ºå¯¸", image: "GrÃ¶ÃŸe.jpg", category: "è¡£æœ", gender: "die" },
            { noun: "Farbe", meaning: "é¢œè‰²ï¼Œé¢œæ–™", image: "Farbe.jpg", category: "è¡£æœ", gender: "die" },

            // A1W04 é£Ÿç‰© 45è¯
            { noun: "Ã–l", meaning: "æ²¹", image: "Ã–l.jpg", category: "é£Ÿç‰©", gender: "das" },
            { noun: "Zitrone", meaning: "æŸ æª¬", image: "Zitrone.jpg", category: "é£Ÿç‰©", gender: "die" },
            { noun: "Wurst", meaning: "é¦™è‚ ", image: "Wurst.jpg", category: "é£Ÿç‰©", gender: "die" },
            { noun: "Wein", meaning: "è‘¡è„é…’ã€è‘¡è„", image: "Wein.jpg", category: "é£Ÿç‰©", gender: "der" },
            { noun: "Wasser", meaning: "æ°´", image: "Wasser.jpg", category: "é£Ÿç‰©", gender: "das" },
            { noun: "Tomate", meaning: "è¥¿çº¢æŸ¿", image: "Tomate.jpg", category: "é£Ÿç‰©", gender: "die" },
            { noun: "Tee", meaning: "èŒ¶", image: "Tee.jpg", category: "é£Ÿç‰©", gender: "der" },
            { noun: "Suppe", meaning: "æ±¤ã€ç¾¹", image: "Suppe.jpg", category: "é£Ÿç‰©", gender: "die" },
            { noun: "Speisekarte", meaning: "èœå•", image: "Speisekarte.jpg", category: "é£Ÿç‰©", gender: "die" },
            { noun: "Schinken", meaning: "ç«è…¿", image: "Schinken.jpg", category: "é£Ÿç‰©", gender: "der" },
            { noun: "Salz", meaning: "ç›", image: "Salz.jpg", category: "é£Ÿç‰©", gender: "das" },
            { noun: "Salat", meaning: "æ²™æ‹‰", image: "Salat.jpg", category: "é£Ÿç‰©", gender: "der" },
            { noun: "Saft", meaning: "æœæ±", image: "Saft.jpg", category: "é£Ÿç‰©", gender: "der" },
            { noun: "Restaurant", meaning: "é¤é¦†", image: "Restaurant.jpg", category: "é£Ÿç‰©", gender: "das" },
            { noun: "Reis", meaning: "ç±³é¥­", image: "Reis.jpg", category: "é£Ÿç‰©", gender: "der" },
            { noun: "Rechnung", meaning: "è´¦å•", image: "Rechnung.jpg", category: "é£Ÿç‰©", gender: "die" },
            { noun: "Pommes", meaning: "è–¯æ¡", image: "Pommes.jpg", category: "é£Ÿç‰©" }, // å¤æ•°
            { noun: "Orange", meaning: "æ©™å­ï¼Œæ©™è‰²", image: "Orange.jpg", category: "é£Ÿç‰©", gender: "die" },
            { noun: "Obst", meaning: "æ°´æœ", image: "Obst.jpg", category: "é£Ÿç‰©", gender: "das" },
            { noun: "Nudeln", meaning: "é¢æ¡", image: "Nudeln.jpg", category: "é£Ÿç‰©" }, // å¤æ•°
            { noun: "Mittagessen", meaning: "ä¸­é¤", image: "Mittagessen.jpg", category: "é£Ÿç‰©", gender: "das" },
            { noun: "Milch", meaning: "ç‰›å¥¶", image: "Milch.png", category: "é£Ÿç‰©", gender: "die" },
            { noun: "Lebensmittel", meaning: "é£Ÿç‰©", image: "Lebensmittel.jpg", category: "é£Ÿç‰©", gender: "das" },
            { noun: "KÃ¼che", meaning: "å¨æˆ¿", image: "KÃ¼che.jpg", category: "é£Ÿç‰©", gender: "die" },
            { noun: "KÃ¤se", meaning: "å¥¶é…ª", image: "KÃ¤se.jpg", category: "é£Ÿç‰©", gender: "der" },
            { noun: "Kuchen", meaning: "è›‹ç³•", image: "Kuchen.jpg", category: "é£Ÿç‰©", gender: "der" },
            { noun: "Kartoffel", meaning: "åœŸè±†", image: "Kartoffel.jpg", category: "é£Ÿç‰©", gender: "die" },
            { noun: "Kaffee", meaning: "å’–å•¡", image: "Kaffee.jpg", category: "é£Ÿç‰©", gender: "der" },
            { noun: "HÃ¤hnchen", meaning: "é¸¡è‚‰ï¼Œå°é¸¡", image: "HÃ¤hnchen.jpg", category: "é£Ÿç‰©", gender: "das" },
            { noun: "GetrÃ¤nk", meaning: "é¥®æ–™", image: "GetrÃ¤nk.jpg", category: "é£Ÿç‰©", gender: "das" },
            { noun: "GemÃ¼se", meaning: "è”¬èœ", image: "GemÃ¼se.jpg", category: "é£Ÿç‰©", gender: "das" },
            { noun: "FrÃ¼hstÃ¼ck", meaning: "æ—©é¤", image: "FrÃ¼hstÃ¼ck.jpg", category: "é£Ÿç‰©", gender: "das" },
            { noun: "Fleisch", meaning: "è‚‰", image: "Fleisch.jpg", category: "é£Ÿç‰©", gender: "das" },
            { noun: "Fisch", meaning: "é±¼", image: "Fisch.jpg", category: "é£Ÿç‰©", gender: "der" },
            { noun: "Eis", meaning: "å†°ã€å†°æ·‡æ·‹", image: "Eis.jpg", category: "é£Ÿç‰©", gender: "das" },
            { noun: "Ei", meaning: "è›‹", image: "Ei.jpg", category: "é£Ÿç‰©", gender: "das" },
            { noun: "CafÃ©", meaning: "å’–å•¡é¦†", image: "CafÃ©.jpg", category: "é£Ÿç‰©", gender: "das" },
            { noun: "Butter", meaning: "é»„æ²¹", image: "Butter.jpg", category: "é£Ÿç‰©", gender: "die" },
            { noun: "BrÃ¶tchen", meaning: "å°é¢åŒ…", image: "BrÃ¶tchen.jpg", category: "é£Ÿç‰©", gender: "das" },
            { noun: "Brot", meaning: "å¤§é¢åŒ…ï¼ˆä¸»é£Ÿï¼‰", image: "Brot.jpg", category: "é£Ÿç‰©", gender: "das" },
            { noun: "Birne", meaning: "æ¢¨", image: "Birne.png", category: "é£Ÿç‰©", gender: "die" },
            { noun: "Bier", meaning: "å•¤é…’", image: "Bier.jpg", category: "é£Ÿç‰©", gender: "das" },
            { noun: "Banane", meaning: "é¦™è•‰", image: "Banane.jpg", category: "é£Ÿç‰©", gender: "die" },
            { noun: "Apfel", meaning: "è‹¹æœ", image: "Apfel.jpg", category: "é£Ÿç‰©", gender: "der" },
            { noun: "Abendessen", meaning: "æ™šé¤", image: "Abendessen.jpg", category: "é£Ÿç‰©", gender: "das" },

            // A1W05 å±…ä½ 50è¯
            { noun: "Zimmer", meaning: "æˆ¿é—´", image: "Zimmer.jpg", category: "å±…ä½", gender: "das" },
            { noun: "Wohnzimmer", meaning: "å®¢å…", image: "Wohnzimmer.jpg", category: "å±…ä½", gender: "das" },
            { noun: "Wohnung", meaning: "ä½å®…", image: "Wohnung.jpg", category: "å±…ä½", gender: "die" },
            { noun: "Wohnadresse", meaning: "ä½å€", image: "Wohnadresse.jpg", category: "å±…ä½", gender: "die" },
            { noun: "Wand", meaning: "å¢™", image: "Wand.jpg", category: "å±…ä½", gender: "die" },
            { noun: "Vermieter", meaning: "æˆ¿ä¸œï¼ˆå‡ºç§Ÿï¼‰", image: "Vermieter.jpg", category: "å±…ä½", gender: "der" },
            { noun: "Uhr", meaning: "é’Ÿã€ç‚¹", image: "Uhr.jpg", category: "å±…ä½", gender: "die" },
            { noun: "TÃ¼r", meaning: "é—¨", image: "TÃ¼r.jpg", category: "å±…ä½", gender: "die" },
            { noun: "Treppe", meaning: "æ¥¼æ¢¯", image: "Treppe.jpg", category: "å±…ä½", gender: "die" },
            { noun: "Toilette", meaning: "å«ç”Ÿé—´ã€é©¬æ¡¶", image: "Toilette.jpg", category: "å±…ä½", gender: "die" },
            { noun: "Tisch", meaning: "æ¡Œå­", image: "Tisch.png", category: "å±…ä½", gender: "der" },
            { noun: "Stuhl", meaning: "æ¤…å­", image: "Stuhl.png", category: "å±…ä½", gender: "der" },
            { noun: "StraÃŸe", meaning: "è¡—é“", image: "StraÃŸe.jpg", category: "å±…ä½", gender: "die" },
            { noun: "Stock", meaning: "æ¥¼å±‚", image: "Stock.jpg", category: "å±…ä½", gender: "der" },
            { noun: "Stadt", meaning: "åŸå¸‚", image: "Stadt.jpg", category: "å±…ä½", gender: "die" },
            { noun: "Spiegel", meaning: "é•œå­", image: "Spiegel.png", category: "å±…ä½", gender: "der" },
            { noun: "Sofa", meaning: "æ²™å‘", image: "Sofa.jpg", category: "å±…ä½", gender: "das" },
            { noun: "Schrank", meaning: "æŸœå­", image: "Schrank.jpg", category: "å±…ä½", gender: "der" },
            { noun: "SchlÃ¼ssel", meaning: "é’¥åŒ™", image: "SchlÃ¼ssel.jpg", category: "å±…ä½", gender: "der" },
            { noun: "Schlafzimmer", meaning: "å§å®¤", image: "Schlafzimmer.jpg", category: "å±…ä½", gender: "das" },
            { noun: "Raum", meaning: "æˆ¿é—´ã€ç©ºé—´", image: "Raum.jpg", category: "å±…ä½", gender: "der" },
            { noun: "Postleitzahl", meaning: "é‚®ç¼–", image: "Postleitzahl.jpg", category: "å±…ä½", gender: "die" },
            { noun: "Platz", meaning: "å¹¿åœºã€ç©ºåœ°ã€ä½ç½®", image: "Platz.jpg", category: "å±…ä½", gender: "der" },
            { noun: "MÃ¶bel", meaning: "å®¶å…·", image: "MÃ¶bel.jpg", category: "å±…ä½" }, // å¤æ•°
            { noun: "Mieter", meaning: "ç§Ÿå®¢", image: "Mieter.jpg", category: "å±…ä½", gender: "der" },
            { noun: "Miete", meaning: "ç§Ÿé‡‘", image: "Miete.jpg", category: "å±…ä½", gender: "die" },
            { noun: "Licht", meaning: "å…‰", image: "Licht.jpg", category: "å±…ä½", gender: "das" },
            { noun: "Land", meaning: "åœŸåœ°ã€ä¹¡æ‘ã€å›½å®¶", image: "Land.jpg", category: "å±…ä½", gender: "das" },
            { noun: "KÃ¼hlschrank", meaning: "å†°ç®±", image: "KÃ¼hlschrank.png", category: "å±…ä½", gender: "der" },
            { noun: "KÃ¼che", meaning: "å¨æˆ¿", image: "KÃ¼che.jpg", category: "å±…ä½", gender: "die" },
            { noun: "Kinderzimmer", meaning: "å„¿ç«¥æˆ¿", image: "Kinderzimmer.jpg", category: "å±…ä½", gender: "das" },
            { noun: "Herd", meaning: "ç‚‰ç¶", image: "Herd.jpg", category: "å±…ä½", gender: "der" },
            { noun: "Hausnummer", meaning: "é—¨ç‰Œå·", image: "Hausnummer.jpg", category: "å±…ä½", gender: "die" },
            { noun: "Haus", meaning: "ç‹¬æ ‹æˆ¿å­ã€åˆ«å¢…", image: "Haus.jpg", category: "å±…ä½", gender: "das" },
            { noun: "Handtuch", meaning: "æ¯›å·¾ã€æ‰‹å·¾", image: "Handtuch.jpg", category: "å±…ä½", gender: "das" },
            { noun: "Garten", meaning: "èŠ±å›­", image: "Garten.jpg", category: "å±…ä½", gender: "der" },
            { noun: "Garage", meaning: "è½¦åº“", image: "Garage.jpg", category: "å±…ä½", gender: "die" },
            { noun: "Fenster", meaning: "çª—", image: "Fenster.jpg", category: "å±…ä½", gender: "das" },
            { noun: "Eingang", meaning: "å…¥å£", image: "Eingang.jpg", category: "å±…ä½", gender: "der" },
            { noun: "Dusche", meaning: "æ·‹æµ´ï¼Œæ·‹æµ´é—´", image: "Dusche.jpg", category: "å±…ä½", gender: "die" },
            { noun: "Dorf", meaning: "å°æ‘åº„", image: "Dorf.jpg", category: "å±…ä½", gender: "das" },
            { noun: "Bild", meaning: "ç”»ã€å›¾ç‰‡", image: "Bild.jpg", category: "å±…ä½", gender: "das" },
            { noun: "Bett", meaning: "åºŠ", image: "Bett.jpg", category: "å±…ä½", gender: "das" },
            { noun: "Balkon", meaning: "é˜³å°", image: "Balkon.jpg", category: "å±…ä½", gender: "der" },
            { noun: "Badezimmer", meaning: "æµ´å®¤", image: "Badezimmer.jpg", category: "å±…ä½", gender: "das" },
            { noun: "Bad", meaning: "æµ´ç¼¸ã€æµ´å®¤", image: "Bad.jpg", category: "å±…ä½", gender: "das" },
            { noun: "Ausgang", meaning: "å‡ºå£", image: "Ausgang.jpg", category: "å±…ä½", gender: "der" },
            { noun: "Aufzug", meaning: "ç›´å‡ç”µæ¢¯", image: "Aufzug.jpg", category: "å±…ä½", gender: "der" },
            { noun: "Apartment", meaning: "å…¬å¯“", image: "Apartment.jpg", category: "å±…ä½", gender: "das" },
            { noun: "Adresse", meaning: "åœ°å€", image: "Adresse.jpg", category: "å±…ä½", gender: "die" },

            // A1W06 äº¤é€šå’Œæ—…è¡Œ 42è¯
            { noun: "Zug", meaning: "ç«è½¦", image: "Zug.jpg", category: "äº¤é€šå’Œæ—…è¡Œ", gender: "der" },
            { noun: "Vollpension", meaning: "å…¨åŒ…é£Ÿå®¿ï¼ˆä½å®¿+2ä¸»é¤ï¼‰", image: "Vollpension.jpg", category: "äº¤é€šå’Œæ—…è¡Œ", gender: "die" },
            { noun: "Unfall", meaning: "äº‹æ•…", image: "Unfall.jpg", category: "äº¤é€šå’Œæ—…è¡Œ", gender: "der" },
            { noun: "U-Bahn", meaning: "åœ°é“", image: "U-Bahn.jpg", category: "äº¤é€šå’Œæ—…è¡Œ", gender: "die" },
            { noun: "Tourist", meaning: "æ—…æ¸¸ã€æ¸¸å®¢", image: "Tourist.jpg", category: "äº¤é€šå’Œæ—…è¡Œ", gender: "der" },
            { noun: "Taxi", meaning: "å‡ºç§Ÿè½¦", image: "Taxi.jpg", category: "äº¤é€šå’Œæ—…è¡Œ", gender: "das" },
            { noun: "Tasche", meaning: "æ‰‹æè¢‹ã€è¢‹å­", image: "Tasche.jpg", category: "äº¤é€šå’Œæ—…è¡Œ", gender: "die" },
            { noun: "StraÃŸenbahn", meaning: "æœ‰è½¨ç”µè½¦", image: "StraÃŸenbahn.jpg", category: "äº¤é€šå’Œæ—…è¡Œ", gender: "die" },
            { noun: "Stadtplan", meaning: "åŸå¸‚åœ°å›¾", image: "Stadtplan.jpg", category: "äº¤é€šå’Œæ—…è¡Œ", gender: "der" },
            { noun: "SehenswÃ¼rdigkeit", meaning: "æ™¯ç‚¹ã€åèƒœå¤è¿¹", image: "SehenswÃ¼rdigkeit.jpg", category: "äº¤é€šå’Œæ—…è¡Œ", gender: "die" },
            { noun: "Schiff", meaning: "è½®èˆ¹", image: "Schiff.jpg", category: "äº¤é€šå’Œæ—…è¡Œ", gender: "das" },
            { noun: "S-Bahn", meaning: "è½»è½¨", image: "S-Bahn.jpg", category: "äº¤é€šå’Œæ—…è¡Œ", gender: "die" },
            { noun: "Rezeption", meaning: "å‰å°", image: "Rezeption.jpg", category: "äº¤é€šå’Œæ—…è¡Œ", gender: "die" },
            { noun: "ReisefÃ¼hrer", meaning: "å¯¼æ¸¸ã€å¯¼æ¸¸æ‰‹å†Œ", image: "ReisefÃ¼hrer.jpg", category: "äº¤é€šå’Œæ—…è¡Œ", gender: "der" },
            { noun: "ReisebÃ¼ro", meaning: "æ—…è¡Œç¤¾", image: "ReisebÃ¼ro.jpg", category: "äº¤é€šå’Œæ—…è¡Œ", gender: "das" },
            { noun: "Reise", meaning: "æ—…è¡Œ", image: "Reise.jpg", category: "äº¤é€šå’Œæ—…è¡Œ", gender: "die" },
            { noun: "Polizei", meaning: "è­¦å¯Ÿ", image: "Polizei.jpg", category: "äº¤é€šå’Œæ—…è¡Œ", gender: "die" },
            { noun: "Linie", meaning: "çº¿è·¯", image: "Linie.jpg", category: "äº¤é€šå’Œæ—…è¡Œ", gender: "die" },
            { noun: "Koffer", meaning: "è¡Œæç®±", image: "Koffer.jpg", category: "äº¤é€šå’Œæ—…è¡Œ", gender: "der" },
            { noun: "Information", meaning: "ä¿¡æ¯ï¼Œä¿¡æ¯é—®è¯¢å¤„", image: "Information.jpg", category: "äº¤é€šå’Œæ—…è¡Œ", gender: "die" },
            { noun: "Hotel", meaning: "é…’åº—", image: "Hotel.jpg", category: "äº¤é€šå’Œæ—…è¡Œ", gender: "das" },
            { noun: "Haltestelle", meaning: "åœé ç«™", image: "Haltestelle.jpg", category: "äº¤é€šå’Œæ—…è¡Œ", gender: "die" },
            { noun: "Halbpension", meaning: "åŠåŒ…é£Ÿå®¿ï¼ˆä½+1ä¸»é¤ï¼‰", image: "Halbpension.jpg", category: "äº¤é€šå’Œæ—…è¡Œ", gender: "die" },
            { noun: "GepÃ¤ck", meaning: "è¡Œæ", image: "GepÃ¤ck.jpg", category: "äº¤é€šå’Œæ—…è¡Œ", gender: "das" },
            { noun: "Gast", meaning: "å®¢äºº", image: "Gast.jpg", category: "äº¤é€šå’Œæ—…è¡Œ", gender: "der" },
            { noun: "FÃ¼hrerschein", meaning: "é©¾ç…§", image: "FÃ¼hrerschein.jpg", category: "äº¤é€šå’Œæ—…è¡Œ", gender: "der" },
            { noun: "Flugzeug", meaning: "é£æœº", image: "Flugzeug.jpg", category: "äº¤é€šå’Œæ—…è¡Œ", gender: "das" },
            { noun: "Flughafen", meaning: "æœºåœº", image: "Flughafen.jpg", category: "äº¤é€šå’Œæ—…è¡Œ", gender: "der" },
            { noun: "Fahrplan", meaning: "è¡Œç¨‹", image: "Fahrplan.jpg", category: "äº¤é€šå’Œæ—…è¡Œ", gender: "der" },
            { noun: "Fahrrad", meaning: "è‡ªè¡Œè½¦", image: "Fahrrad.jpg", category: "äº¤é€šå’Œæ—…è¡Œ", gender: "das" },
            { noun: "Fahrkarte", meaning: "è½¦ç¥¨", image: "Fahrkarte.jpg", category: "äº¤é€šå’Œæ—…è¡Œ", gender: "die" },
            { noun: "Ecke", meaning: "è§’è½", image: "Ecke.jpg", category: "äº¤é€šå’Œæ—…è¡Œ", gender: "die" },
            { noun: "Durchsage", meaning: "é€šçŸ¥å¹¿æ’­", image: "Durchsage.jpg", category: "äº¤é€šå’Œæ—…è¡Œ", gender: "die" },
            { noun: "Bus", meaning: "å…¬äº¤", image: "Bus.jpg", category: "äº¤é€šå’Œæ—…è¡Œ", gender: "der" },
            { noun: "Besuch", meaning: "æ‹œè®¿", image: "Besuch.jpg", category: "äº¤é€šå’Œæ—…è¡Œ", gender: "der" },
            { noun: "Bahnhof", meaning: "ç«è½¦ç«™", image: "Bahnhof.jpg", category: "äº¤é€šå’Œæ—…è¡Œ", gender: "der" },
            { noun: "Autobahn", meaning: "é«˜é€Ÿå…¬è·¯", image: "Autobahn.jpg", category: "äº¤é€šå’Œæ—…è¡Œ", gender: "die" },
            { noun: "Auto", meaning: "å°æ±½è½¦", image: "Auto.jpg", category: "äº¤é€šå’Œæ—…è¡Œ", gender: "das" },
            { noun: "Ausflug", meaning: "éƒŠæ¸¸ã€å‡ºæ¸¸", image: "Ausflug.jpg", category: "äº¤é€šå’Œæ—…è¡Œ", gender: "der" },
            { noun: "Ankunft", meaning: "æŠµè¾¾", image: "Ankunft.jpg", category: "äº¤é€šå’Œæ—…è¡Œ", gender: "die" },
            { noun: "Abflug", meaning: "èµ·é£", image: "Abflug.jpg", category: "äº¤é€šå’Œæ—…è¡Œ", gender: "der" },
            { noun: "Abfahrt", meaning: "å¯ç¨‹å‡ºå‘", image: "Abfahrt.jpg", category: "äº¤é€šå’Œæ—…è¡Œ", gender: "die" },

            // A1W07 è´­ç‰© 19è¯
            { noun: "VerkÃ¤uferin", meaning: "å”®è´§å‘˜ï¼ˆå¥³ï¼‰", image: "VerkÃ¤uferin.jpg", category: "è´­ç‰©", gender: "die" },
            { noun: "Verkauf", meaning: "å–", image: "Verkauf.jpg", category: "è´­ç‰©", gender: "der" },
            { noun: "Supermarkt", meaning: "è¶…å¸‚", image: "Supermarket.jpg", category: "è´­ç‰©", gender: "der" },
            { noun: "Preis", meaning: "ä»·æ ¼", image: "Preis.jpg", category: "è´­ç‰©", gender: "der" },
            { noun: "Laden", meaning: "å•†åº—ï¼ˆå°ï¼‰", image: "Laden.jpg", category: "è´­ç‰©", gender: "der" },
            { noun: "Kundinnen", meaning: "å¥³å®¢æˆ·ä»¬", image: "Kundinnen.jpg", category: "è´­ç‰©" }, // å¤æ•°
            { noun: "Kunde", meaning: "å®¢æˆ·", image: "Kunde.jpg", category: "è´­ç‰©", gender: "der" },
            { noun: "Kiosk", meaning: "ä¹¦æŠ¥äº­", image: "Kiosk.jpg", category: "è´­ç‰©", gender: "der" },
            { noun: "Kilogramm", meaning: "åƒå…‹", image: "Kilo.jpg", category: "è´­ç‰©", gender: "das" },
            { noun: "Kaufhaus", meaning: "å•†åœº", image: "Kaufhaus.jpg", category: "è´­ç‰©", gender: "das" },
            { noun: "Kasse", meaning: "æ”¶é“¶å°", image: "Kasse.jpg", category: "è´­ç‰©", gender: "die" },
            { noun: "Gewicht", meaning: "é‡é‡", image: "Gewicht.jpg", category: "è´­ç‰©", gender: "das" },
            { noun: "GeschÃ¤ft", meaning: "å•†åº—ã€ç”Ÿæ„", image: "GeschÃ¤ft.jpg", category: "è´­ç‰©", gender: "das" },
            { noun: "Geld", meaning: "é’±", image: "Geld.jpg", category: "è´­ç‰©", gender: "das" },
            { noun: "Euro", meaning: "æ¬§å…ƒ", image: "Euro.jpg", category: "è´­ç‰©", gender: "der" },
            { noun: "Einkauf", meaning: "é‡‡è´­", image: "Einkauf.jpg", category: "è´­ç‰©", gender: "der" },
            { noun: "BÃ¤ckerei", meaning: "é¢åŒ…åº—ã€çƒ˜ç„™åŠ", image: "BÃ¤ckerei.jpg", category: "è´­ç‰©", gender: "die" },
            { noun: "Bestellung", meaning: "è®¢å•ã€è®¢è´­", image: "Bestellung.jpg", category: "è´­ç‰©", gender: "die" },
            { noun: "Angebot", meaning: "ï¼ˆæä¾›çš„ï¼‰å•†å“ã€æŠ¥ä»·", image: "Angebot.jpg", category: "è´­ç‰©", gender: "das" },

            // A1W08 çœ‹åŒ»ç”Ÿ 19è¯
            { noun: "Ohr", meaning: "è€³æœµ", image: "Ohr.jpg", category: "çœ‹åŒ»ç”Ÿ", gender: "das" },
            { noun: "ZahnÃ¤rztin", meaning: "ç‰™åŒ»ï¼ˆå¥³ï¼‰", image: "ZahnÃ¤rztin.jpg", category: "çœ‹åŒ»ç”Ÿ", gender: "die" },
            { noun: "Zahn", meaning: "ç‰™é½¿", image: "Zahn.png", category: "çœ‹åŒ»ç”Ÿ", gender: "der" },
            { noun: "Termin", meaning: "é¢„çº¦ï¼ˆæ—¶é—´ï¼‰", image: "Termin.jpg", category: "çœ‹åŒ»ç”Ÿ", gender: "der" },
            { noun: "Praxis", meaning: "è¯Šæ‰€", image: "Praxis.jpg", category: "çœ‹åŒ»ç”Ÿ", gender: "die" },
            { noun: "Nase", meaning: "é¼»å­", image: "Nase.jpg", category: "çœ‹åŒ»ç”Ÿ", gender: "die" },
            { noun: "Mund", meaning: "å˜´", image: "Mund.jpg", category: "çœ‹åŒ»ç”Ÿ", gender: "der" },
            { noun: "Medikament", meaning: "è¯å“", image: "Medikament.jpg", category: "çœ‹åŒ»ç”Ÿ", gender: "das" },
            { noun: "Kopf", meaning: "å¤´", image: "Kopf.jpg", category: "çœ‹åŒ»ç”Ÿ", gender: "der" },
            { noun: "Hand", meaning: "æ‰‹", image: "Hand.png", category: "çœ‹åŒ»ç”Ÿ", gender: "die" },
            { noun: "Haar", meaning: "å¤´å‘", image: "Haar.jpg", category: "çœ‹åŒ»ç”Ÿ", gender: "das" },
            { noun: "FuÃŸ", meaning: "è¶³", image: "FuÃŸ.png", category: "çœ‹åŒ»ç”Ÿ", gender: "der" },
            { noun: "Doktor", meaning: "åŒ»ç”Ÿã€åšå£«", image: "Doktor.jpg", category: "çœ‹åŒ»ç”Ÿ", gender: "der" },
            { noun: "Bein", meaning: "è…¿", image: "Bein.png", category: "çœ‹åŒ»ç”Ÿ", gender: "das" },
            { noun: "Bauch", meaning: "è‚šå­", image: "Bauch.jpg", category: "çœ‹åŒ»ç”Ÿ", gender: "der" },
            { noun: "Auge", meaning: "çœ¼ç›", image: "Auge.jpg", category: "çœ‹åŒ»ç”Ÿ", gender: "das" },
            { noun: "Arzt", meaning: "åŒ»ç”Ÿ", image: "Arzt.jpg", category: "çœ‹åŒ»ç”Ÿ", gender: "der" },
            { noun: "Arm", meaning: "æ‰‹è‡‚", image: "Arm.jpg", category: "çœ‹åŒ»ç”Ÿ", gender: "der" },
            { noun: "Apotheke", meaning: "è¯åº—", image: "Apotheke.jpg", category: "çœ‹åŒ»ç”Ÿ", gender: "die" },

            // A1W09 é“¶è¡Œå’Œé‚®å±€ 22è¯
            { noun: "Ãœberweisung", meaning: "è½¬è´¦æ±‡æ¬¾", image: "Ãœberweisung.jpg", category: "é“¶è¡Œå’Œé‚®å±€", gender: "die" },
            { noun: "Unterschrift", meaning: "ç­¾å", image: "Unterschrift.jpg", category: "é“¶è¡Œå’Œé‚®å±€", gender: "die" },
            { noun: "Telefonnummer", meaning: "ç”µè¯å·ç ", image: "Telefonnummer.jpg", category: "é“¶è¡Œå’Œé‚®å±€", gender: "die" },
            { noun: "Telefonbuch", meaning: "ç”µè¯è–„", image: "Telefonbuch.jpg", category: "é“¶è¡Œå’Œé‚®å±€", gender: "das" },
            { noun: "Telefon", meaning: "ç”µè¯", image: "Telefon.jpg", category: "é“¶è¡Œå’Œé‚®å±€", gender: "das" },
            { noun: "Schalter", meaning: "æŸœå°ã€å¼€åˆå¼çš„å¼€å…³", image: "Schalter.jpg", category: "é“¶è¡Œå’Œé‚®å±€", gender: "der" },
            { noun: "Postkarte", meaning: "æ˜æ˜Ÿç‰‡", image: "Postkarte.jpg", category: "é“¶è¡Œå’Œé‚®å±€", gender: "die" },
            { noun: "Post", meaning: "é‚®å±€ã€é‚®æ”¿", image: "Post.jpg", category: "é“¶è¡Œå’Œé‚®å±€", gender: "die" },
            { noun: "Kreditkarte", meaning: "ä¿¡ç”¨å¡", image: "Kreditkarte.jpg", category: "é“¶è¡Œå’Œé‚®å±€", gender: "die" },
            { noun: "Konto", meaning: "è´¦æˆ·", image: "Konto.jpg", category: "é“¶è¡Œå’Œé‚®å±€", gender: "das" },
            { noun: "Handy", meaning: "æ‰‹æœº", image: "Handy.jpg", category: "é“¶è¡Œå’Œé‚®å±€", gender: "das" },
            { noun: "Geldautomat", meaning: "ATMï¼ˆé“¶è¡Œï¼‰", image: "Geldautomat.jpg", category: "é“¶è¡Œå’Œé‚®å±€", gender: "der" },
            { noun: "Fax", meaning: "ä¼ çœŸ", image: "Fax.jpg", category: "é“¶è¡Œå’Œé‚®å±€", gender: "das" },
            { noun: "EmpfÃ¤nger", meaning: "æ”¶ä»¶äºº", image: "EmpfÃ¤nger.jpg", category: "é“¶è¡Œå’Œé‚®å±€", gender: "der" },
            { noun: "Briefmarke", meaning: "é‚®ç¥¨", image: "Briefmarke.jpg", category: "é“¶è¡Œå’Œé‚®å±€", gender: "die" },
            { noun: "Brief", meaning: "ä¿¡", image: "Brief.jpg", category: "é“¶è¡Œå’Œé‚®å±€", gender: "der" },
            { noun: "Bank", meaning: "é“¶è¡Œ", image: "Bank.jpg", category: "é“¶è¡Œå’Œé‚®å±€", gender: "die" },
            { noun: "Automat", meaning: "è‡ªåŠ¨æœºï¼ˆè½¦ç¥¨ã€é¥®æ–™ã€é“¶è¡ŒATMç­‰ï¼‰", image: "Automat.jpg", category: "é“¶è¡Œå’Œé‚®å±€", gender: "der" },
            { noun: "Ausweis", meaning: "èº«ä»½è¯ä»¶", image: "Ausweis.jpg", category: "é“¶è¡Œå’Œé‚®å±€", gender: "der" },
            { noun: "Anrufbeantworter", meaning: "ç”µè¯ç­”å½•æœº", image: "Anrufbeantworter.jpg", category: "é“¶è¡Œå’Œé‚®å±€", gender: "der" },
            { noun: "Anruf", meaning: "æ‰“ç”µè¯", image: "Anruf.jpg", category: "é“¶è¡Œå’Œé‚®å±€", gender: "der" },
            { noun: "Absender", meaning: "å¯„ä»¶äºº", image: "Absender.jpg", category: "é“¶è¡Œå’Œé‚®å±€", gender: "der" },

            // A1W10 å­¦ä¹ å’Œå·¥ä½œ 36è¯
            { noun: "Wort", meaning: "å•è¯", image: "Wort.jpg", category: "å­¦ä¹ å’Œå·¥ä½œ", gender: "das" },
            { noun: "Kurs", meaning: "è¯¾ç¨‹", image: "Kurs.jpg", category: "å­¦ä¹ å’Œå·¥ä½œ", gender: "der" },
            { noun: "Position", meaning: "ä½ç½®", image: "Stelle.jpg", category: "å­¦ä¹ å’Œå·¥ä½œ", gender: "die" },
            { noun: "SchÃ¼lerin", meaning: "ä¸­å°å­¦ç”Ÿï¼ˆå¥³ï¼‰", image: "SchÃ¼lerin.jpg", category: "å­¦ä¹ å’Œå·¥ä½œ", gender: "die" },
            { noun: "SchÃ¼ler", meaning: "ä¸­å°å­¦ç”Ÿ", image: "SchÃ¼ler.jpg", category: "å­¦ä¹ å’Œå·¥ä½œ", gender: "der" },
            { noun: "Schule", meaning: "å­¦æ ¡", image: "Schule.jpg", category: "å­¦ä¹ å’Œå·¥ä½œ", gender: "die" },
            { noun: "Schreibtisch", meaning: "ä¹¦æ¡Œ", image: "Schreibtisch.jpg", category: "å­¦ä¹ å’Œå·¥ä½œ", gender: "der" },
            { noun: "Satz", meaning: "å¥å­", image: "Satz.jpg", category: "å­¦ä¹ å’Œå·¥ä½œ", gender: "der" },
            { noun: "PrÃ¼fung", meaning: "è€ƒè¯•", image: "PrÃ¼fung.jpg", category: "å­¦ä¹ å’Œå·¥ä½œ", gender: "die" },
            { noun: "Praktikum", meaning: "å®ä¹ ", image: "Praktikum.jpg", category: "å­¦ä¹ å’Œå·¥ä½œ", gender: "das" },
            { noun: "Pause", meaning: "æš‚åœã€ä¸­é—´ä¼‘æ¯", image: "Pause.jpg", category: "å­¦ä¹ å’Œå·¥ä½œ", gender: "die" },
            { noun: "Papier", meaning: "çº¸", image: "Papier.jpg", category: "å­¦ä¹ å’Œå·¥ä½œ", gender: "das" },
            { noun: "Antwort", meaning: "ç­”æ¡ˆ", image: "LÃ¶sung.png", category: "å­¦ä¹ å’Œå·¥ä½œ", gender: "die" },
            { noun: "Lehrerin", meaning: "è€å¸ˆï¼ˆå¥³ï¼‰", image: "Lehrerin.jpg", category: "å­¦ä¹ å’Œå·¥ä½œ", gender: "die" },
            { noun: "Lehrer", meaning: "è€å¸ˆ", image: "Lehrer.jpg", category: "å­¦ä¹ å’Œå·¥ä½œ", gender: "der" },
            { noun: "Kurs", meaning: "åŸ¹è®­è¯¾ç¨‹ï¼Œè·¯çº¿ã€æ±‡ç‡", image: "Kurs.jpg", category: "å­¦ä¹ å’Œå·¥ä½œ", gender: "der" },
            { noun: "Kugelschreiber", meaning: "åœ†ç ç¬”", image: "Kugelschreiber.jpg", category: "å­¦ä¹ å’Œå·¥ä½œ", gender: "der" },
            { noun: "Kollegin", meaning: "åŒäº‹ï¼ˆå¥³ï¼‰", image: "Kollegin.jpg", category: "å­¦ä¹ å’Œå·¥ä½œ", gender: "die" },
            { noun: "Kollege", meaning: "åŒäº‹", image: "Kollege.jpg", category: "å­¦ä¹ å’Œå·¥ä½œ", gender: "der" },
            { noun: "Klasse", meaning: "å¹´çº§ã€ç­‰çº§", image: "Klasse.jpg", category: "å­¦ä¹ å’Œå·¥ä½œ", gender: "die" },
            { noun: "Job", meaning: "å·¥ä½œï¼ˆä¸´æ—¶ï¼‰", image: "Job.jpg", category: "å­¦ä¹ å’Œå·¥ä½œ", gender: "der" },
            { noun: "Hausaufgabe", meaning: "å®¶åº­ä½œä¸š", image: "Hausaufgabe.jpg", category: "å­¦ä¹ å’Œå·¥ä½œ", gender: "die" },
            { noun: "Firma", meaning: "å…¬å¸", image: "Firma.jpg", category: "å­¦ä¹ å’Œå·¥ä½œ", gender: "die" },
            { noun: "Fehler", meaning: "é”™è¯¯", image: "Fehler.jpg", category: "å­¦ä¹ å’Œå·¥ä½œ", gender: "der" },
            { noun: "Drucker", meaning: "æ‰“å°æœº", image: "Drucker.png", category: "å­¦ä¹ å’Œå·¥ä½œ", gender: "der" },
            { noun: "Computer", meaning: "ç”µè„‘", image: "Computer.jpg", category: "å­¦ä¹ å’Œå·¥ä½œ", gender: "der" },
            { noun: "Chefin", meaning: "è€æ¿ï¼ˆå¥³ï¼‰", image: "Chefin.jpg", category: "å­¦ä¹ å’Œå·¥ä½œ", gender: "die" },
            { noun: "Chef", meaning: "è€æ¿", image: "Chef.jpg", category: "å­¦ä¹ å’Œå·¥ä½œ", gender: "der" },
            { noun: "BÃ¼ro", meaning: "åŠå…¬å®¤", image: "BÃ¼ro.jpg", category: "å­¦ä¹ å’Œå·¥ä½œ", gender: "das" },
            { noun: "Buchstabe", meaning: "å­—æ¯", image: "Buchstabe.jpg", category: "å­¦ä¹ å’Œå·¥ä½œ", gender: "der" },
            { noun: "Bleistift", meaning: "é“…ç¬”", image: "Bleistift.png", category: "å­¦ä¹ å’Œå·¥ä½œ", gender: "der" },
            { noun: "Beruf", meaning: "èŒä¸š", image: "Beruf.jpg", category: "å­¦ä¹ å’Œå·¥ä½œ", gender: "der" },
            { noun: "Berufsausbildung", meaning: "èŒä¸šåŸ¹è®­", image: "Ausbildung.jpg", category: "å­¦ä¹ å’Œå·¥ä½œ", gender: "die" },
            { noun: "Arbeitsplatz", meaning: "å·¥ä½œå²—ä½", image: "Arbeitsplatz.jpg", category: "å­¦ä¹ å’Œå·¥ä½œ", gender: "der" },
            { noun: "Arbeiter", meaning: "å·¥ä½œè€…", image: "Arbeiter.jpg", category: "å­¦ä¹ å’Œå·¥ä½œ", gender: "der" },
            { noun: "Arbeit", meaning: "å·¥ä½œ", image: "Arbeit.jpg", category: "å­¦ä¹ å’Œå·¥ä½œ", gender: "die" },

            // A1W11 ä¸šä½™æ´»åŠ¨ 33è¯
            { noun: "Zeitung", meaning: "æŠ¥çº¸", image: "Zeitung.jpg", category: "ä¸šä½™æ´»åŠ¨", gender: "die" },
            { noun: "Wind", meaning: "é£", image: "Wind.jpg", category: "ä¸šä½™æ´»åŠ¨", gender: "der" },
            { noun: "Wetter", meaning: "å¤©æ°”", image: "Wetter.jpg", category: "ä¸šä½™æ´»åŠ¨", gender: "das" },
            { noun: "Verein", meaning: "åä¼šã€ä¿±ä¹éƒ¨", image: "Verein.jpg", category: "ä¸šä½™æ´»åŠ¨", gender: "der" },
            { noun: "Urlaub", meaning: "å‡æœŸ", image: "Urlaub.jpg", category: "ä¸šä½™æ´»åŠ¨", gender: "der" },
            { noun: "Ticket", meaning: "ç¥¨", image: "Ticket.jpg", category: "ä¸šä½™æ´»åŠ¨", gender: "das" },
            { noun: "Sportverein", meaning: "ä½“è‚²åä¼š", image: "Sportverein.jpg", category: "ä¸šä½™æ´»åŠ¨", gender: "der" },
            { noun: "Sport", meaning: "è¿åŠ¨", image: "Sport.jpg", category: "ä¸šä½™æ´»åŠ¨", gender: "der" },
            { noun: "Spaziergang", meaning: "æ•£æ­¥", image: "Spaziergang.jpg", category: "ä¸šä½™æ´»åŠ¨", gender: "der" },
            { noun: "Sonne", meaning: "å¤ªé˜³", image: "Sonne.jpg", category: "ä¸šä½™æ´»åŠ¨", gender: "die" },
            { noun: "See", meaning: "æ¹–", image: "See.jpg", category: "ä¸šä½™æ´»åŠ¨", gender: "der" },
            { noun: "Schwimmbad", meaning: "æ¸¸æ³³æ± ", image: "Schwimmbad.jpg", category: "ä¸šä½™æ´»åŠ¨", gender: "das" },
            { noun: "Regen", meaning: "é›¨", image: "Regen.jpg", category: "ä¸šä½™æ´»åŠ¨", gender: "der" },
            { noun: "Musik", meaning: "éŸ³ä¹", image: "Musik.jpg", category: "ä¸šä½™æ´»åŠ¨", gender: "die" },
            { noun: "Museum", meaning: "åšç‰©é¦†", image: "Museum.jpg", category: "ä¸šä½™æ´»åŠ¨", gender: "das" },
            { noun: "Meer", meaning: "æµ·", image: "Meer.jpg", category: "ä¸šä½™æ´»åŠ¨", gender: "das" },
            { noun: "Kino", meaning: "ç”µå½±é™¢", image: "Kino.jpg", category: "ä¸šä½™æ´»åŠ¨", gender: "das" },
            { noun: "Karte", meaning: "å¡ç‰‡ã€åœ°å›¾", image: "Karte.jpg", category: "ä¸šä½™æ´»åŠ¨", gender: "die" },
            { noun: "Internet", meaning: "äº’è”ç½‘", image: "Internet.jpg", category: "ä¸šä½™æ´»åŠ¨", gender: "das" },
            { noun: "Hobby", meaning: "çˆ±å¥½", image: "Hobby.jpg", category: "ä¸šä½™æ´»åŠ¨", gender: "das" },
            { noun: "Geschenk", meaning: "ç¤¼ç‰©", image: "Geschenk.jpg", category: "ä¸šä½™æ´»åŠ¨", gender: "das" },
            { noun: "FuÃŸball", meaning: "è¶³çƒ", image: "FuÃŸball.jpg", category: "ä¸šä½™æ´»åŠ¨", gender: "der" },
            { noun: "Freizeit", meaning: "ç©ºé—²æ—¶é—´", image: "Freizeit.jpg", category: "ä¸šä½™æ´»åŠ¨", gender: "die" },
            { noun: "Film", meaning: "ç”µå½±", image: "Film.jpg", category: "ä¸šä½™æ´»åŠ¨", gender: "der" },
            { noun: "Fest", meaning: "èŠ‚æ—¥ã€åº†ç¥", image: "Fest.jpg", category: "ä¸šä½™æ´»åŠ¨", gender: "das" },
            { noun: "Ferien", meaning: "å‡æœŸ", image: "Ferien.jpg", category: "ä¸šä½™æ´»åŠ¨" }, // å¤æ•°
            { noun: "Eintrittskarte", meaning: "å…¥åœºåˆ¸", image: "Eintrittskarte.jpg", category: "ä¸šä½™æ´»åŠ¨", gender: "die" },
            { noun: "Einladung", meaning: "é‚€è¯·", image: "Einladung.jpg", category: "ä¸šä½™æ´»åŠ¨", gender: "die" },
            { noun: "Disco", meaning: "è¿ªæ–¯ç§‘", image: "Disco.jpg", category: "ä¸šä½™æ´»åŠ¨", gender: "die" },
            { noun: "CD", meaning: "CDå…‰ç›˜", image: "CD.jpg", category: "ä¸šä½™æ´»åŠ¨", gender: "die" },
            { noun: "Buch", meaning: "ä¹¦", image: "Buch.jpg", category: "ä¸šä½™æ´»åŠ¨", gender: "das" },
            { noun: "Anmeldung", meaning: "æŠ¥åã€ç™»è®°", image: "Anmeldung.jpg", category: "ä¸šä½™æ´»åŠ¨", gender: "die" },

            // A1W12 æ–‡å…· 15è¯ï¼ˆé’å°‘å¹´ï¼‰
            { noun: "Uhr", meaning: "é’Ÿè¡¨", image: "Uhr.jpg", category: "æ–‡å…·", gender: "die" },
            { noun: "Spitzer", meaning: "å·ç¬”åˆ€", image: "Spitzer.png", category: "æ–‡å…·", gender: "der" },
            { noun: "Schere", meaning: "å‰ªåˆ€", image: "Schere.jpg", category: "æ–‡å…·", gender: "die" },
            { noun: "Rucksack", meaning: "èƒŒåŒ…", image: "Rucksack.jpg", category: "æ–‡å…·", gender: "der" },
            { noun: "Radiergummi", meaning: "æ©¡çš®", image: "Radiergummi.png", category: "æ–‡å…·", gender: "der" },
            { noun: "MÃ¤ppchen", meaning: "ç¬”è¢‹", image: "MÃ¤ppchen.jpg", category: "æ–‡å…·", gender: "das" },
            { noun: "Lineal", meaning: "å°ºå­", image: "Lineal.png", category: "æ–‡å…·", gender: "das" },
            { noun: "Kugelschreiber", meaning: "åœ†ç ç¬”", image: "Kugelschreiber.png", category: "æ–‡å…·", gender: "der" },
            { noun: "Klebstoff", meaning: "èƒ¶æ°´", image: "Klebstoff.png", category: "æ–‡å…·", gender: "der" },
            { noun: "Heft", meaning: "ç»ƒä¹ æœ¬", image: "Heft.jpg", category: "æ–‡å…·", gender: "das" },
            { noun: "FÃ¼ller", meaning: "é’¢ç¬”", image: "FÃ¼ller.jpg", category: "æ–‡å…·", gender: "der" },
            { noun: "Filzstift", meaning: "é©¬å…‹ç¬”", image: "Filzstift.jpg", category: "æ–‡å…·", gender: "der" },
            { noun: "Buch", meaning: "ä¹¦", image: "Buch.jpg", category: "æ–‡å…·", gender: "das" },
            { noun: "Brille", meaning: "çœ¼é•œ", image: "Brille.png", category: "æ–‡å…·", gender: "die" },
            { noun: "Bleistift", meaning: "é“…ç¬”", image: "Bleistift.jpg", category: "æ–‡å…·", gender: "der" },

            // A1W13 åŠ¨ç‰© 11è¯ï¼ˆé’å°‘å¹´ï¼‰
            { noun: "Vogel", meaning: "é¸Ÿ", image: "Vogel.jpg", category: "åŠ¨ç‰©", gender: "der" },
            { noun: "Tiger", meaning: "è€è™", image: "Tiger.jpg", category: "åŠ¨ç‰©", gender: "der" },
            { noun: "Pinguin", meaning: "ä¼é¹…", image: "Pinguin.jpg", category: "åŠ¨ç‰©", gender: "der" },
            { noun: "Pferd", meaning: "é©¬", image: "Pferd.jpg", category: "åŠ¨ç‰©", gender: "das" },
            { noun: "Papagei", meaning: "é¹¦é¹‰", image: "Papagei.jpg", category: "åŠ¨ç‰©", gender: "der" },
            { noun: "Maus", meaning: "è€é¼ ", image: "Maus.jpg", category: "åŠ¨ç‰©", gender: "die" },
            { noun: "LÃ¶we", meaning: "ç‹®å­", image: "LÃ¶we.jpg", category: "åŠ¨ç‰©", gender: "der" },
            { noun: "Katze", meaning: "çŒ«", image: "Katze.jpg", category: "åŠ¨ç‰©", gender: "die" },
            { noun: "Kaninchen", meaning: "å…”å­", image: "Kaninchen.jpg", category: "åŠ¨ç‰©", gender: "das" },
            { noun: "Hund", meaning: "ç‹—", image: "Hund.jpg", category: "åŠ¨ç‰©", gender: "der" },
            { noun: "Haustier", meaning: "å® ç‰©", image: "Haustier.jpg", category: "åŠ¨ç‰©", gender: "das" },
            { noun: "Hase", meaning: "é‡å…”", image: "Hase.jpg", category: "åŠ¨ç‰©", gender: "der" }
        ];
        
        // è·å–ç±»åˆ«åç§°
        function getCategoryName(category) {
            const names = {
                'all': 'å…¨éƒ¨è¯æ±‡ (éšæœºæ’åº)',
                'æ—¶é—´å’Œæ—¥æœŸ': 'æ—¶é—´å’Œæ—¥æœŸ',
                'æé—®å’Œäº¤æµ': 'æé—®å’Œäº¤æµ',
                'è¡£æœ': 'è¡£æœ',
                'é£Ÿç‰©': 'é£Ÿç‰©',
                'å±…ä½': 'å±…ä½',
                'äº¤é€šå’Œæ—…è¡Œ': 'äº¤é€šå’Œæ—…è¡Œ',
                'è´­ç‰©': 'è´­ç‰©',
                'çœ‹åŒ»ç”Ÿ': 'çœ‹åŒ»ç”Ÿ',
                'é“¶è¡Œå’Œé‚®å±€': 'é“¶è¡Œå’Œé‚®å±€',
                'å­¦ä¹ å’Œå·¥ä½œ': 'å­¦ä¹ å’Œå·¥ä½œ',
                'ä¸šä½™æ´»åŠ¨': 'ä¸šä½™æ´»åŠ¨',
                'æ–‡å…·': 'æ–‡å…·',
                'åŠ¨ç‰©': 'åŠ¨ç‰©'
            };
            return names[category] || 'è¯æ±‡';
        }
        
        // éŸ³æ•ˆåŠŸèƒ½ - ç­”å¯¹éŸ³æ•ˆï¼ˆé«˜éŸ³è°ƒï¼Œæ„‰å¿«çš„éŸ³è°ƒï¼‰
        function playCorrectSound() {
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                
                // åˆ›å»ºä¸‰ä¸ªéŸ³è°ƒï¼ˆC-E-Gå’Œå¼¦ï¼‰
                const frequencies = [523.25, 659.25, 783.99]; // C5, E5, G5
                const startTimes = [0, 0.1, 0.2];
                
                frequencies.forEach((freq, index) => {
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    oscillator.type = 'sine';
                    oscillator.frequency.value = freq;
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    const startTime = audioContext.currentTime + startTimes[index];
                    const duration = 0.2;
                    
                    gainNode.gain.setValueAtTime(0, startTime);
                    gainNode.gain.linearRampToValueAtTime(0.2, startTime + 0.05);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, startTime + duration);
                    
                    oscillator.start(startTime);
                    oscillator.stop(startTime + duration);
                });
            } catch (e) {
                // éŸ³æ•ˆæ’­æ”¾å¤±è´¥ï¼Œé™é»˜å¤„ç†
            }
        }
        
        // éŸ³æ•ˆåŠŸèƒ½ - ç­”é”™éŸ³æ•ˆï¼ˆä½éŸ³è°ƒï¼Œä½æ²‰çš„éŸ³è°ƒï¼‰
        function playIncorrectSound() {
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.type = 'sawtooth'; // ä½¿ç”¨é”¯é½¿æ³¢ï¼Œå¬èµ·æ¥æ›´ä½æ²‰
                oscillator.frequency.value = 220; // A3
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                const startTime = audioContext.currentTime;
                const duration = 0.3;
                
                // é¢‘ç‡ä¸‹é™
                oscillator.frequency.setValueAtTime(220, startTime);
                oscillator.frequency.exponentialRampToValueAtTime(150, startTime + duration);
                
                // éŸ³é‡æ§åˆ¶
                gainNode.gain.setValueAtTime(0.3, startTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, startTime + duration);
                
                oscillator.start(startTime);
                oscillator.stop(startTime + duration);
            } catch (e) {
                // éŸ³æ•ˆæ’­æ”¾å¤±è´¥ï¼Œé™é»˜å¤„ç†
            }
        }
        
        // å‘éŸ³åŠŸèƒ½ - æœ—è¯»å•è¯
        function speakWord(word, event) {
            if (event) {
                event.stopPropagation();
            }
            
            if ('speechSynthesis' in window) {
                // åœæ­¢å½“å‰æ­£åœ¨æ’­æ”¾çš„è¯­éŸ³
                window.speechSynthesis.cancel();
                
                // è·å–å¯ç”¨çš„å¾·è¯­è¯­éŸ³
                const voices = window.speechSynthesis.getVoices();
                const germanVoice = voices.find(voice => 
                    voice.lang.startsWith('de') && 
                    (voice.name.includes('German') || voice.name.includes('Deutsch') || voice.lang === 'de-DE')
                );
                
                // åˆ›å»ºå•è¯æœ—è¯»
                const wordUtterance = new SpeechSynthesisUtterance(word);
                wordUtterance.lang = 'de-DE';
                wordUtterance.rate = 0.9;
                wordUtterance.pitch = 1;
                if (germanVoice) {
                    wordUtterance.voice = germanVoice;
                }
                
                // æ’­æ”¾å•è¯æœ—è¯»
                window.speechSynthesis.speak(wordUtterance);
                
                // æ·»åŠ åŠ¨ç”»æ•ˆæœ
                if (event) {
                    const button = event.target.closest('.speak-btn');
                    if (button) {
                        button.innerHTML = '<span class="icon">ğŸ”Š</span>';
                        setTimeout(() => {
                            button.innerHTML = '<span class="icon">ğŸ”Š</span>';
                        }, 1000);
                    }
                }
            } else {
                alert('æŠ±æ­‰ï¼Œæ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³åˆæˆåŠŸèƒ½ã€‚');
            }
        }
        
        // å‘éŸ³åŠŸèƒ½ - æœ—è¯»å•è¯å’Œä¸­æ–‡é‡Šä¹‰ï¼ˆç”¨äºç‚¹å‡»å¡ç‰‡æ—¶è‡ªåŠ¨æœ—è¯»ï¼‰
        function speakWordAndMeaning(word, meaning) {
            if ('speechSynthesis' in window) {
                // åœæ­¢å½“å‰æ­£åœ¨æ’­æ”¾çš„è¯­éŸ³
                window.speechSynthesis.cancel();
                
                // è·å–å¯ç”¨çš„è¯­éŸ³
                const voices = window.speechSynthesis.getVoices();
                const germanVoice = voices.find(voice => 
                    voice.lang.startsWith('de') && 
                    (voice.name.includes('German') || voice.name.includes('Deutsch') || voice.lang.startsWith('de-'))
                );
                const chineseVoice = voices.find(voice => 
                    voice.lang.startsWith('zh') && 
                    (voice.name.includes('Chinese') || voice.name.includes('ä¸­æ–‡') || voice.lang.startsWith('zh-'))
                );
                
                // åˆ›å»ºå•è¯æœ—è¯»
                const wordUtterance = new SpeechSynthesisUtterance(word);
                wordUtterance.lang = 'de-DE';
                wordUtterance.rate = 0.9;
                wordUtterance.pitch = 1;
                if (germanVoice) {
                    wordUtterance.voice = germanVoice;
                }
                
                // å•è¯æœ—è¯»å®Œæˆåæœ—è¯»ä¸­æ–‡é‡Šä¹‰
                wordUtterance.onend = function() {
                    setTimeout(() => {
                        const meaningUtterance = new SpeechSynthesisUtterance(meaning);
                        meaningUtterance.lang = 'zh-CN';
                        meaningUtterance.rate = 1;
                        meaningUtterance.pitch = 1;
                        if (chineseVoice) {
                            meaningUtterance.voice = chineseVoice;
                        }
                        window.speechSynthesis.speak(meaningUtterance);
                    }, 300); // çŸ­æš‚é—´éš”
                };
                
                // æ’­æ”¾å•è¯æœ—è¯»
                window.speechSynthesis.speak(wordUtterance);
            }
        }
        
        // è¯†åˆ«å¤æ•°è¯æ±‡
        function isPluralNoun(noun) {
            // å¸¸è§çš„å¾·è¯­å¤æ•°è¯æ±‡ï¼ˆåªæœ‰å¤æ•°å½¢å¼æˆ–å¸¸ç”¨å¤æ•°å½¢å¼ï¼‰
            const pluralNouns = [
                'Schuhe', 'Eltern', 'Geschwister', 'GroÃŸeltern', 
                'Nudeln', 'Pommes', 'Ferien', 'MÃ¶bel', 'Verwandte',
                'Erwachsene', 'Kundinnen', 'Jahreszeiten'
            ];
            
            // æ£€æŸ¥æ˜¯å¦åœ¨å¤æ•°åˆ—è¡¨ä¸­
            return pluralNouns.includes(noun);
        }
        
        // è·å–è¯æ€§æ ‡è¯†ä¿¡æ¯
        function getGenderInfo(gender, noun) {
            // å¦‚æœæ˜¯å¤æ•°ï¼Œè¿”å›å¤æ•°æ ‡è¯†
            if (isPluralNoun(noun)) {
                return { class: 'plural', text: 'die' };
            }
            
            if (!gender) return null;
            
            const genderMap = {
                'der': { class: 'masculine', text: 'der' },
                'das': { class: 'neuter', text: 'das' },
                'die': { class: 'feminine', text: 'die' }
            };
            
            return genderMap[gender.toLowerCase()] || null;
        }
        
        // å›¾ç‰‡è·¯å¾„è§£æå‡½æ•° - æ”¯æŒå¤šç§è·¯å¾„æŸ¥æ‰¾æ–¹å¼
        function getImagePath(imageName, category) {
            // æ ¹æ®ç±»åˆ«æ˜ å°„åˆ°å¯¹åº”çš„æ–‡ä»¶å¤¹
            const categoryFolders = {
                'æ—¶é—´å’Œæ—¥æœŸ': 'A1W01_Zeit_und_Datum_30Woerter',
                'æé—®å’Œäº¤æµ': 'A1W02_Fragen_und_Kommunikation_38Woerter',
                'è¡£æœ': 'A1W03_Kleidung_18Woerter',
                'é£Ÿç‰©': 'A1W04_Lebensmittel_45Woerter',
                'å±…ä½': 'A1W05_Wohnen_50Woerter',
                'äº¤é€šå’Œæ—…è¡Œ': 'A1W06_Verkehr_und_Reisen_42Woerter',
                'è´­ç‰©': 'A1W07_Einkaufen_19Woerter',
                'çœ‹åŒ»ç”Ÿ': 'A1W08_Arztbesuch_19Woerter',
                'é“¶è¡Œå’Œé‚®å±€': 'A1W09_Bank_und_Post_22Woerter',
                'å­¦ä¹ å’Œå·¥ä½œ': 'A1W10_Lernen_und_Arbeit_36Woerter',
                'ä¸šä½™æ´»åŠ¨': 'A1W11_Freizeit_33Woerter',
                'æ–‡å…·': 'A1W12_Schreibwaren_15Woerter_Jugend',
                'åŠ¨ç‰©': 'A1W13_Tiere_11Woerter_Jugend'
            };
            
            const folderName = categoryFolders[category];
            
            if (!folderName) {
                console.warn(`æœªæ‰¾åˆ°ç±»åˆ« "${category}" å¯¹åº”çš„æ–‡ä»¶å¤¹ï¼Œä½¿ç”¨é»˜è®¤è·¯å¾„`);
                return imageName;
            }
            
            // ä½¿ç”¨æ­£æ–œæ æ„å»ºè·¯å¾„ï¼ˆæµè§ˆå™¨ä¼šè‡ªåŠ¨å¤„ç†ï¼‰
            // åœ¨HTTPæœåŠ¡å™¨ç¯å¢ƒä¸‹ï¼Œç›´æ¥ä½¿ç”¨ç›¸å¯¹è·¯å¾„å³å¯
            const path = `${folderName}/${imageName}`;
            
            // è°ƒè¯•ä¿¡æ¯ï¼ˆä»…åœ¨å¼€å‘æ—¶ä½¿ç”¨ï¼‰
            if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
                console.log(`å›¾ç‰‡è·¯å¾„ [${category}]: ${path}`);
            }
            
            return path;
        }
        
        // å›¾ç‰‡åŠ è½½é”™è¯¯å¤„ç†
        function handleImageError(imgElement, imageName, category) {
            const categoryFolders = {
                'æ—¶é—´å’Œæ—¥æœŸ': 'A1W01_Zeit_und_Datum_30Woerter',
                'æé—®å’Œäº¤æµ': 'A1W02_Fragen_und_Kommunikation_38Woerter',
                'è¡£æœ': 'A1W03_Kleidung_18Woerter',
                'é£Ÿç‰©': 'A1W04_Lebensmittel_45Woerter',
                'å±…ä½': 'A1W05_Wohnen_50Woerter',
                'äº¤é€šå’Œæ—…è¡Œ': 'A1W06_Verkehr_und_Reisen_42Woerter',
                'è´­ç‰©': 'A1W07_Einkaufen_19Woerter',
                'çœ‹åŒ»ç”Ÿ': 'A1W08_Arztbesuch_19Woerter',
                'é“¶è¡Œå’Œé‚®å±€': 'A1W09_Bank_und_Post_22Woerter',
                'å­¦ä¹ å’Œå·¥ä½œ': 'A1W10_Lernen_und_Arbeit_36Woerter',
                'ä¸šä½™æ´»åŠ¨': 'A1W11_Freizeit_33Woerter',
                'æ–‡å…·': 'A1W12_Schreibwaren_15Woerter_Jugend',
                'åŠ¨ç‰©': 'A1W13_Tiere_11Woerter_Jugend'
            };
            
            const folderName = categoryFolders[category];
            
            // å°è¯•å¤‡ç”¨è·¯å¾„ï¼ˆæŒ‰ä¼˜å…ˆçº§æ’åºï¼‰
            const fallbackPaths = [];
            
            // 1. å°è¯•æœªç¼–ç çš„è·¯å¾„ï¼ˆæœ€å¸¸ç”¨ï¼Œæµè§ˆå™¨é€šå¸¸èƒ½æ­£ç¡®å¤„ç†ï¼‰
            if (folderName) {
                fallbackPaths.push(`${folderName}/${imageName}`);
            }
            
            // 2. å°è¯•ç¼–ç çš„è·¯å¾„ï¼ˆå¦‚æœè·¯å¾„åŒ…å«ç‰¹æ®Šå­—ç¬¦ï¼‰
            if (folderName) {
                const needsEncoding = /[^\w\-_.\/]/.test(folderName) || /[^\w\-_.]/.test(imageName);
                if (needsEncoding) {
                    const encodedPath = folderName.split('/').map(segment => {
                        return /[^\w\-_.]/.test(segment) ? encodeURIComponent(segment) : segment;
                    }).join('/') + '/' + (/[^\w\-_.]/.test(imageName) ? encodeURIComponent(imageName) : imageName);
                    fallbackPaths.push(encodedPath);
                }
            }
            
            // 3. å°è¯•ç›´æ¥ä½¿ç”¨æ–‡ä»¶åï¼ˆå¦‚æœå›¾ç‰‡åœ¨åŒä¸€ç›®å½•ï¼‰
            fallbackPaths.push(imageName);
            
            // 4. å°è¯•å¤‡ç”¨æ–‡ä»¶å¤¹ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
            if (folderName) {
                const backupPath = `æ–°å»ºæ–‡ä»¶å¤¹/å¸¦æ°´å° 40è´¨é‡ - å¸¦ä¸­æ–‡è§£é‡Š/${folderName}/${imageName}`;
                fallbackPaths.push(backupPath);
            }
            
            let currentTry = 0;
            const maxTries = fallbackPaths.length;
            
            const tryNextPath = () => {
                if (currentTry < maxTries) {
                    const nextPath = fallbackPaths[currentTry];
                    console.log(`å°è¯•åŠ è½½å›¾ç‰‡è·¯å¾„ ${currentTry + 1}/${maxTries}: ${nextPath}`);
                    imgElement.src = nextPath;
                    currentTry++;
                    
                    // è®¾ç½®è¶…æ—¶ï¼Œå¦‚æœ5ç§’å†…æœªåŠ è½½æˆåŠŸï¼Œå°è¯•ä¸‹ä¸€ä¸ªè·¯å¾„
                    const timeout = setTimeout(() => {
                        if (!imgElement.complete || imgElement.naturalHeight === 0) {
                            console.warn(`å›¾ç‰‡åŠ è½½è¶…æ—¶: ${nextPath}`);
                            tryNextPath();
                        }
                    }, 5000);
                    
                    // å¦‚æœåŠ è½½æˆåŠŸï¼Œæ¸…é™¤è¶…æ—¶
                    imgElement.onload = () => {
                        clearTimeout(timeout);
                        console.log(`å›¾ç‰‡åŠ è½½æˆåŠŸ: ${nextPath}`);
                    };
                } else {
                    // æ‰€æœ‰è·¯å¾„éƒ½å¤±è´¥ï¼Œæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
                    console.error(`æ‰€æœ‰è·¯å¾„éƒ½å¤±è´¥ï¼Œæ— æ³•åŠ è½½å›¾ç‰‡: ${imageName}`);
                    if (imgElement.parentElement) {
                    imgElement.parentElement.innerHTML = `
                        <div class="image-error">
                                <span class="icon">ğŸ–¼ï¸</span><br>
                            å›¾ç‰‡åŠ è½½å¤±è´¥<br>
                            <small>${imageName}</small><br>
                                <small style="font-size: 0.8rem; margin-top: 5px;">è¯·æ£€æŸ¥å›¾ç‰‡æ–‡ä»¶æ˜¯å¦å­˜åœ¨</small>
                        </div>
                    `;
                    }
                }
            };
            
            // æ¸…é™¤ä¹‹å‰çš„é”™è¯¯å¤„ç†
            imgElement.onload = null;
            imgElement.onerror = tryNextPath;
            
            // å¼€å§‹å°è¯•ç¬¬ä¸€ä¸ªå¤‡ç”¨è·¯å¾„
            tryNextPath();
        }
        
        // ==================== ä¸»é¢˜å¯¼èˆªå‡½æ•° ====================
        
        // æ¸²æŸ“ä¸»é¢˜å¯¼èˆª
        function renderThemeNavigation() {
            const container = document.getElementById('theme-list');
            container.innerHTML = '';
            
            const themes = themeOrder[userConfig.userType];
            
            let nextLockedIndex = -1;
            let lockedCount = 0;
            
            // æ‰¾åˆ°ç¬¬ä¸€ä¸ªæœªè§£é”çš„ä¸»é¢˜ç´¢å¼•
            themes.forEach((theme, index) => {
                const themeData = learningProgress.themes[theme] || {};
                if (themeData.status === 'locked') {
                    if (nextLockedIndex === -1) {
                        nextLockedIndex = index;
                    }
                    lockedCount++;
                }
            });
            
            // æ¸²æŸ“æ‰€æœ‰å·²è§£é”å’Œä¸‹ä¸€ä¸ªæœªè§£é”çš„ä¸»é¢˜
            themes.forEach((theme, index) => {
                const themeData = learningProgress.themes[theme] || {};
                
                // åªæ˜¾ç¤ºå·²è§£é”çš„ä¸»é¢˜å’Œä¸‹ä¸€ä¸ªæœªè§£é”çš„ä¸»é¢˜
                if (themeData.status === 'locked' && index !== nextLockedIndex) {
                    return; // è·³è¿‡åç»­æœªè§£é”çš„ä¸»é¢˜
                }
                
                const item = document.createElement('div');
                item.className = 'theme-item';
                
                if (themeData.status === 'locked') {
                    item.classList.add('locked');
                } else if (themeData.status === 'completed') {
                    item.classList.add('completed');
                } else if (themeData.status === 'learning') {
                    item.classList.add('learning');
                }
                
                const statusBadge = getThemeStatusBadge(themeData);
                
                item.innerHTML = `
                    <div class="theme-name">${theme}</div>
                    <div class="theme-status">${statusBadge}</div>
                `;
                
                item.onclick = () => {
                    if (themeData.status !== 'locked') {
                        selectTheme(theme, index);
                    }
                };
                
                container.appendChild(item);
            });
            
            // å¦‚æœæœ‰å¤šä¸ªæœªè§£é”çš„ä¸»é¢˜ï¼Œæ˜¾ç¤ºæ•°é‡æç¤º
            if (lockedCount > 1) {
                const remainingCount = lockedCount - 1;
                const summaryItem = document.createElement('div');
                summaryItem.className = 'theme-item locked';
                summaryItem.style.opacity = '0.6';
                summaryItem.style.cursor = 'default';
                summaryItem.innerHTML = `
                    <div class="theme-name">è¿˜æœ‰ ${remainingCount} ä¸ªä¸»é¢˜æœªè§£é”</div>
                    <div class="theme-status">
                        <span class="theme-status-badge status-locked">å®Œæˆå½“å‰ä¸»é¢˜åè§£é”</span>
                    </div>
                `;
                container.appendChild(summaryItem);
            }
        }

        // è·å–ä¸»é¢˜çŠ¶æ€æ ‡è¯†
        function getThemeStatusBadge(themeData) {
            if (!themeData || themeData.status === 'locked') {
                return '<span class="theme-status-badge status-locked">æœªè§£é”</span>';
            }
            
            if (themeData.status === 'completed') {
                return '<span class="theme-status-badge status-completed">å·²å®Œæˆ</span>';
            }
            
            if (themeData.status === 'learning') {
                let statusText = 'å­¦ä¹ ä¸­';
                if (themeData.test1.status === 'completed') {
                    statusText = 'æµ‹è¯•1å·²å®Œæˆ';
                }
                if (themeData.test2.status === 'completed') {
                    statusText = 'å…¨éƒ¨å®Œæˆ';
                }
                return `<span class="theme-status-badge status-learning">${statusText}</span>`;
            }
            
            return '';
        }

        // é€‰æ‹©ä¸»é¢˜
        function selectTheme(theme, index) {
            learningProgress.currentThemeIndex = index;
            learningProgress.currentTheme = theme;
            saveLearningProgress();
            
            // æ›´æ–°ä¸»é¢˜å¯¼èˆªæ˜¾ç¤º
            renderThemeNavigation();
            
            // æ›´æ–°é¡¶éƒ¨æ è¿›åº¦å’Œå½“å‰ä¸»é¢˜
            updateTopBarProgress();
            updateCurrentThemeDisplay();
            
            // åŠ è½½ä¸»é¢˜å†…å®¹
            loadCurrentTheme();
        }

        // åŠ è½½å½“å‰ä¸»é¢˜
        function loadCurrentTheme() {
            const container = domCache.cardsContainer || document.getElementById('cards-container');
            if (!container) {
                console.error('cards-container not found');
                return;
            }
            
            // ç¡®ä¿ userConfig å·²åˆå§‹åŒ–
            if (!userConfig || !userConfig.userType) {
                container.innerHTML = `
                    <div class="loader">
                        <span class="icon icon-spin">âŸ³</span> æ­£åœ¨åŠ è½½é…ç½®...
                    </div>
                `;
                // å¦‚æœé…ç½®æœªå®Œæˆï¼Œæ˜¾ç¤ºè®¾ç½®å¼¹çª—
                if (!userConfig || !userConfig.setupCompleted) {
                    if (domCache.setupModal) {
                        showModal('setup-modal');
                    }
                }
                return;
            }
            
            // ç¡®ä¿ learningProgress å·²åˆå§‹åŒ–
            if (!learningProgress || !learningProgress.themes) {
                // å¦‚æœç”¨æˆ·é…ç½®å·²å®Œæˆä½†å­¦ä¹ è¿›åº¦æœªåˆå§‹åŒ–ï¼Œé‡æ–°åˆå§‹åŒ–
                if (userConfig.setupCompleted) {
                    initializeLearningProgress();
                } else {
                    container.innerHTML = `
                        <div class="loader">
                            <span class="icon icon-spin">âŸ³</span> æ­£åœ¨åˆå§‹åŒ–å­¦ä¹ è¿›åº¦...
                        </div>
                    `;
                    return;
                }
            }
            
            // å¦‚æœå½“å‰ä¸»é¢˜ä¸å­˜åœ¨ï¼Œè®¾ç½®é»˜è®¤ä¸»é¢˜
            if (!learningProgress.currentTheme) {
                const themes = themeOrder[userConfig.userType];
                if (themes && themes.length > 0) {
                    learningProgress.currentTheme = themes[0];
                    learningProgress.currentThemeIndex = 0;
                    saveLearningProgress();
                } else {
                    container.innerHTML = `
                        <div class="loader">
                            <span class="icon">âš ï¸</span> æœªæ‰¾åˆ°å¯ç”¨ä¸»é¢˜
                        </div>
                    `;
                    return;
                }
            }
            
            // ç¡®ä¿currentModeè¢«æ­£ç¡®è®¾ç½®
            if (!learningProgress.currentMode) {
                learningProgress.currentMode = 'learning';
            }
            
            // æ˜¾ç¤ºåŠ è½½åŠ¨ç”»ï¼ˆä»…åœ¨å®¹å™¨ä¸ºç©ºæˆ–åªæœ‰loaderæ—¶ï¼‰
            const hasContent = container.children.length > 0;
            const hasLoader = container.querySelector('.loader');
            if (!hasContent || hasLoader) {
                container.innerHTML = `
                    <div class="loader">
                        <span class="icon icon-spin">âŸ³</span> æ­£åœ¨åŠ è½½å¡ç‰‡...
                    </div>
                `;
            }
            
            // è°ƒè¯•ä¿¡æ¯
            console.log('=== loadCurrentTheme å¼€å§‹ ===');
            console.log('å¼€å§‹åŠ è½½ä¸»é¢˜:', learningProgress.currentTheme);
            console.log('å½“å‰æ¨¡å¼:', learningProgress.currentMode);
            console.log('vocabularyç±»å‹:', typeof vocabulary);
            console.log('vocabularyæ˜¯å¦ä¸ºæ•°ç»„:', Array.isArray(vocabulary));
            if (Array.isArray(vocabulary)) {
                console.log('vocabularyé•¿åº¦:', vocabulary.length);
            }
            
            // æ¸²æŸ“å¡ç‰‡ï¼ˆvocabularyæ˜¯åŒæ­¥å®šä¹‰çš„ï¼Œä¸éœ€è¦setTimeoutï¼‰
            if (learningProgress.currentMode === 'learning') {
                console.log('è¿›å…¥å­¦ä¹ æ¨¡å¼æ¸²æŸ“æµç¨‹');
                // ç¡®ä¿vocabularyæ•°æ®å·²åŠ è½½
                if (typeof vocabulary === 'undefined' || !Array.isArray(vocabulary)) {
                    console.error('vocabularyæ•°æ®æœªå®šä¹‰ï¼Œæ— æ³•æ¸²æŸ“å¡ç‰‡', typeof vocabulary);
                    container.innerHTML = `
                        <div class="loader">
                            <span class="icon">âš ï¸</span> è¯æ±‡æ•°æ®æœªåŠ è½½ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•
                        </div>
                    `;
                    return;
                }
                
                console.log('è°ƒç”¨ renderVocabularyCardsï¼Œå‚æ•°:', learningProgress.currentTheme);
                renderVocabularyCards(learningProgress.currentTheme);
                console.log('renderVocabularyCards è°ƒç”¨å®Œæˆ');
            } else {
                console.log('å½“å‰ä¸ºæµ‹è¯•æ¨¡å¼ï¼Œç”±startTestå‡½æ•°å¤„ç†');
                // æµ‹è¯•æ¨¡å¼ï¼Œç”±startTestå‡½æ•°å¤„ç†
            }
            console.log('=== loadCurrentTheme å®Œæˆ ===');
        }

        // ==================== å­¦ä¹ æ¨¡å¼æ¸²æŸ“å‡½æ•° ====================
        
        // ç»Ÿä¸€æ›´æ–°é®æŒ¡å±‚é«˜åº¦ï¼Œç¡®ä¿æ­£åé¢æ˜¾ç¤ºä¸€è‡´
        // ä½¿ç”¨CSSå˜é‡è¿›è¡Œè®¡ç®—ï¼Œä¿è¯ç»§æ‰¿å…³ç³»
        function updateOverlayHeights() {
            const cards = document.querySelectorAll('.card');
            if (cards.length === 0) return;
            
            // ä»CSSå˜é‡è·å–å€¼ï¼Œç¡®ä¿ç»§æ‰¿å…³ç³»
            const root = document.documentElement;
            const cardPadding = parseFloat(getComputedStyle(root).getPropertyValue('--card-padding-learning')) || 3;
            const overlayHeightRatio = parseFloat(getComputedStyle(root).getPropertyValue('--overlay-height-ratio')) || 0.18337;
            
            cards.forEach(card => {
                const cardInner = card.querySelector('.card-inner');
                if (!cardInner) return;
                
                // è®¡ç®—é®æŒ¡å±‚åº”è¯¥çš„é«˜åº¦ï¼ˆåƒç´ å€¼ï¼‰
                const cardHeight = cardInner.offsetHeight;
                const contentHeight = cardHeight - (cardPadding * 2);
                const overlayHeight = contentHeight * overlayHeightRatio;
                
                // ç»Ÿä¸€è®¾ç½®æ­£åé¢é®æŒ¡å±‚çš„é«˜åº¦
                const frontOverlay = card.querySelector('.card-front .image-overlay');
                const backOverlay = card.querySelector('.card-back .image-overlay');
                
                if (frontOverlay) {
                    frontOverlay.style.height = `${overlayHeight}px`;
                }
                if (backOverlay) {
                    backOverlay.style.height = `${overlayHeight}px`;
                }
            });
        }
        
        // æ›´æ–°æ¸²æŸ“å‡½æ•°ä»¥ä½¿ç”¨åŠ¨æ€å›¾ç‰‡è·¯å¾„
        function renderVocabularyCards(category = 'all') {
            console.log('=== renderVocabularyCards å¼€å§‹ ===');
            console.log('å‚æ•° category:', category);
            
            const container = domCache.cardsContainer || document.getElementById('cards-container');
            if (!container) {
                console.error('cards-container not found');
                return;
            }
            console.log('å®¹å™¨å…ƒç´ æ‰¾åˆ°:', container);
            
            // ç«‹å³æ¸…é™¤åŠ è½½åŠ¨ç”»ï¼ˆåŒæ­¥æ‰§è¡Œï¼Œä¸ç­‰å¾…ï¼‰
            container.innerHTML = '';
            
            // æ£€æŸ¥vocabularyæ•°ç»„æ˜¯å¦å­˜åœ¨
            if (!vocabulary || !Array.isArray(vocabulary)) {
                console.error('vocabularyæ•°æ®æœªå®šä¹‰æˆ–ä¸æ˜¯æ•°ç»„:', vocabulary);
                console.error('vocabularyç±»å‹:', typeof vocabulary);
                container.innerHTML = `
                    <div class="loader">
                        <span class="icon">âš ï¸</span> è¯æ±‡æ•°æ®æœªåŠ è½½ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•
                    </div>
                `;
                return;
            }
            
            // æ£€æŸ¥vocabularyæ•°ç»„æ˜¯å¦ä¸ºç©º
            if (vocabulary.length === 0) {
                console.warn('vocabularyæ•°ç»„ä¸ºç©º');
                container.innerHTML = `
                    <div class="loader">
                        <span class="icon">â„¹ï¸</span> æš‚æ— è¯æ±‡æ•°æ®
                    </div>
                `;
                return;
            }
            
            console.log('vocabularyæ•°ç»„æœ‰æ•ˆï¼Œé•¿åº¦:', vocabulary.length);
            
            // å¤„ç† category å‚æ•°ï¼šå¦‚æœä¸º nullã€undefined æˆ–ç©ºå­—ç¬¦ä¸²ï¼Œä½¿ç”¨ 'all'
            if (!category || category === 'null' || category === 'undefined') {
                category = 'all';
            }
            console.log('å¤„ç†åçš„ category:', category);
            
            // æ ¹æ®ç±»åˆ«è¿‡æ»¤è¯æ±‡
            let filteredVocabulary;
            if (category === 'all') {
                // åˆ›å»ºæ•°ç»„å‰¯æœ¬å¹¶éšæœºæ’åº
                filteredVocabulary = [...vocabulary].sort(() => Math.random() - 0.5);
                console.log('ä½¿ç”¨å…¨éƒ¨è¯æ±‡ï¼Œéšæœºæ’åºåé•¿åº¦:', filteredVocabulary.length);
            } else {
                filteredVocabulary = vocabulary.filter(item => item.category === category);
                console.log('è¿‡æ»¤ç±»åˆ« "' + category + '" åé•¿åº¦:', filteredVocabulary.length);
            }
            
            // æ›´æ–°æ€»æ•°
            const totalCountElement = document.getElementById('total-count');
            if (totalCountElement) {
                totalCountElement.textContent = vocabulary.length;
                console.log('æ€»æ•°å·²æ›´æ–°:', vocabulary.length);
            } else {
                console.warn('total-count å…ƒç´ æœªæ‰¾åˆ°');
            }
            
            if (filteredVocabulary.length === 0) {
                console.warn('è¿‡æ»¤åçš„è¯æ±‡ä¸ºç©º');
                container.innerHTML = `
                    <div class="loader">
                        <span class="icon">â„¹ï¸</span> è¯¥ç±»åˆ«ä¸‹æ²¡æœ‰è¯æ±‡
                    </div>
                `;
                return;
            }
            
            console.log('å¼€å§‹æ¸²æŸ“', filteredVocabulary.length, 'å¼ å¡ç‰‡...');
            
            // ä½¿ç”¨DocumentFragmentæ‰¹é‡æ·»åŠ ï¼Œæé«˜æ€§èƒ½
            const fragment = document.createDocumentFragment();
            
            // æ¸²æŸ“æ¯ä¸ªè¯æ±‡å¡ç‰‡ï¼ˆå·²ç§»é™¤ç±»åˆ«æ ‡é¢˜ï¼‰
            filteredVocabulary.forEach(item => {
                // åˆ›å»ºå¡ç‰‡åŒ…è£…å™¨
                const cardWrapper = document.createElement('div');
                cardWrapper.className = 'card-wrapper';
                
                // åˆ›å»ºå¡ç‰‡
                const card = document.createElement('div');
                card.className = 'card';
                card.dataset.word = item.noun;
                
                // è·å–å›¾ç‰‡è·¯å¾„
                const imagePath = getImagePath(item.image, item.category);
                
                // è·å–è¯æ€§ä¿¡æ¯
                const genderInfo = getGenderInfo(item.gender, item.noun);
                const genderBadge = genderInfo 
                    ? `<div class="gender-badge ${genderInfo.class}">${genderInfo.text}</div>` 
                    : '';
                
                // å­¦ä¹ æ¨¡å¼å¡ç‰‡ï¼šæ­£é¢æ˜¾ç¤ºä¸­æ–‡+å›¾ç‰‡ï¼ŒèƒŒé¢æ˜¾ç¤ºå¾·è¯­+è¯æ€§+å‘éŸ³
                card.innerHTML = `
                    <div class="card-inner">
                        <!-- å¡ç‰‡æ­£é¢ï¼šä¸­æ–‡+å›¾ç‰‡ -->
                        <div class="card-face card-front learning-card-front">
                            <div class="noun-image-container">
                                <img 
                                    src="${imagePath}" 
                                    alt="${item.meaning}" 
                                    class="noun-image"
                                    data-image-name="${item.image}"
                                    data-category="${item.category}"
                                    onerror="handleImageError(this, '${item.image}', '${item.category}')"
                                    onload="console.log('å›¾ç‰‡åŠ è½½æˆåŠŸ:', this.src)"
                                >
                            </div>
                            <!-- é®æŒ¡å±‚ï¼šé®æŒ¡å›¾ç‰‡ä¸‹æ–¹çš„å¾·è¯­ä¿¡æ¯ï¼Œç›´æ¥å»¶ä¼¸åˆ°å¡ç‰‡åº•éƒ¨ -->
                            <div class="image-overlay"></div>
                            <!-- ä¸­æ–‡æ˜¾ç¤ºåœ¨é®æŒ¡å±‚ä¸Š -->
                            <div class="meaning-display">${item.meaning}</div>
                        </div>
                        
                        <!-- å¡ç‰‡èƒŒé¢ï¼šå¾·è¯­+è¯æ€§+å‘éŸ³+ä¸­æ–‡ -->
                        <div class="card-face card-back learning-card-back">
                            <div class="card-back-content">
                                <div class="noun-display">${item.noun}</div>
                                ${genderBadge}
                                <button class="speak-btn" onclick="speakWord('${item.noun}', event)" style="position: relative; top: 0; right: 0; margin: 15px auto;">
                                    <span class="icon">ğŸ”Š</span>
                                </button>
                            </div>
                            <!-- é®æŒ¡å±‚ï¼ˆå·²ä¸å†æ˜¾ç¤ºæ–‡å­—ï¼‰ -->
                            <div class="image-overlay"></div>
                            <!-- ä¸­æ–‡æ˜¾ç¤ºåœ¨é®æŒ¡å±‚ä¸Šï¼Œæ ¼å¼ä¸æ­£é¢ä¸€è‡´ -->
                            <div class="meaning-display">${item.meaning}</div>
                            <!-- ç‚¹å‡»è¿”å›æç¤º -->
                            <div class="card-hint">ç‚¹å‡»å¡ç‰‡è¿”å›</div>
                        </div>
                    </div>
                `;
                
                // æ·»åŠ ç‚¹å‡»äº‹ä»¶
                card.addEventListener('click', function(e) {
                    // å¦‚æœç‚¹å‡»çš„æ˜¯å‘éŸ³æŒ‰é’®ï¼Œä¸ç¿»è½¬å¡ç‰‡
                    if (e.target.closest('.speak-btn')) {
                        e.stopPropagation();
                        return;
                    }
                    
                    this.classList.toggle('flipped');
                    
                    // ç‚¹å‡»å¡ç‰‡æ—¶è‡ªåŠ¨æœ—è¯»
                    if (!this.classList.contains('flipped')) {
                        return; // å¦‚æœæ˜¯ç¿»å›æ­£é¢ï¼Œä¸æœ—è¯»
                    }
                    
                    // è‡ªåŠ¨æœ—è¯»å•è¯å’Œä¸­æ–‡é‡Šä¹‰
                    speakWordAndMeaning(item.noun, item.meaning);
                });
                
                // å›¾ç‰‡å¼‚æ­¥åŠ è½½ï¼Œä¸é˜»å¡é¡µé¢æ¸²æŸ“
                const img = card.querySelector('.noun-image');
                if (img) {
                    // è®¾ç½®åŠ è½½çŠ¶æ€
                    img.style.opacity = '0';
                    img.style.transition = 'opacity 0.3s ease';
                    
                    // å›¾ç‰‡åŠ è½½æˆåŠŸ
                    img.addEventListener('load', function() {
                        this.style.opacity = '1';
                        console.log('å›¾ç‰‡åŠ è½½æˆåŠŸ:', this.src);
                    }, { once: true });
                    
                    // å›¾ç‰‡åŠ è½½å¤±è´¥ï¼ˆé”™è¯¯å¤„ç†å‡½æ•°ä¼šå¤„ç†ï¼‰
                    img.addEventListener('error', function() {
                        console.warn('å›¾ç‰‡åŠ è½½å¤±è´¥:', this.src);
                        // å³ä½¿å¤±è´¥ä¹Ÿæ˜¾ç¤ºï¼ˆé”™è¯¯å¤„ç†å‡½æ•°ä¼šå°è¯•å¤‡ç”¨è·¯å¾„ï¼‰
                        this.style.opacity = '0.5';
                    }, { once: true });
                }
                
                // ç»„è£…åŒ…è£…å™¨ï¼ˆä¸å†æ·»åŠ å¤–éƒ¨æ ‡é¢˜ï¼‰
                cardWrapper.appendChild(card);
                // ä½¿ç”¨DocumentFragmentæ‰¹é‡æ·»åŠ ï¼Œæé«˜æ€§èƒ½
                fragment.appendChild(cardWrapper);
            });
            
            // ä¸€æ¬¡æ€§å°†æ‰€æœ‰å¡ç‰‡æ·»åŠ åˆ°å®¹å™¨ï¼Œå‡å°‘DOMæ“ä½œæ¬¡æ•°
            container.appendChild(fragment);
            console.log('æ‰€æœ‰å¡ç‰‡å·²æ·»åŠ åˆ°DOMï¼Œå®¹å™¨å­å…ƒç´ æ•°é‡:', container.children.length);
            
            // ç«‹å³æ›´æ–°é®æŒ¡å±‚é«˜åº¦ï¼ˆä¸ç­‰å¾…å›¾ç‰‡åŠ è½½ï¼Œè®©é¡µé¢ç«‹å³æ˜¾ç¤ºï¼‰
            requestAnimationFrame(() => {
                updateOverlayHeights();
                // å»¶è¿Ÿå†æ¬¡æ›´æ–°ï¼Œç¡®ä¿å›¾ç‰‡åŠ è½½åä¹Ÿèƒ½æ­£ç¡®æ˜¾ç¤º
                setTimeout(() => {
                    updateOverlayHeights();
                }, 100);
            });
            
            // å›¾ç‰‡åŠ è½½å®Œæˆåå†æ¬¡æ›´æ–°é®æŒ¡å±‚ï¼ˆå¯é€‰ï¼Œç”¨äºä¼˜åŒ–æ˜¾ç¤ºï¼‰
            setTimeout(() => {
                updateOverlayHeights();
                console.log('=== renderVocabularyCards å®Œæˆ ===');
            }, 500);
            
            // æœ€ç»ˆæ›´æ–°ï¼ˆç¡®ä¿æ‰€æœ‰å›¾ç‰‡åŠ è½½åé®æŒ¡å±‚æ­£ç¡®ï¼‰
            setTimeout(() => {
                updateOverlayHeights();
            }, 2000);
        }
        
        // ==================== æµ‹è¯•æ¨¡å¼å‡½æ•° ====================
        
        // è¿›åº¦æ¡å·²æ•´åˆåˆ°å¡ç‰‡å†…éƒ¨ï¼Œä¸å†éœ€è¦ç‹¬ç«‹çš„ä½ç½®æ›´æ–°å‡½æ•°
        
        // å¼€å§‹æµ‹è¯•
        function startTest(testType) {
            // ç¡®ä¿å›ºå®šé¡¶éƒ¨æ æ˜¾ç¤ºï¼ˆç‰¹åˆ«æ˜¯åœ¨ç§»åŠ¨ç«¯æµ‹è¯•æ¨¡å¼ä¸‹ï¼‰
            if (domCache.fixedTopBar) {
                domCache.fixedTopBar.style.display = 'flex';
            }
            
            const theme = learningProgress.currentTheme;
            if (!theme) return;
            
            learningProgress.currentTestType = testType;
            const themeData = learningProgress.themes[theme];
            
            // æ£€æŸ¥æ˜¯å¦å¯ä»¥å¼€å§‹æµ‹è¯•
            if (testType === 'test1') {
                // æµ‹è¯•1éœ€è¦ä¸»é¢˜å·²è§£é”ä¸”test1çŠ¶æ€ä¸ºavailable
                if (themeData.status === 'locked' || themeData.test1.status === 'locked') {
                    alert('è¯·å…ˆå®Œæˆå­¦ä¹ ');
                    return;
                }
            } else if (testType === 'test2') {
                // æµ‹è¯•2éœ€è¦å·²è§£é”
                if (!themeData.test2.unlocked || themeData.test2.status === 'locked') {
                    alert('æµ‹è¯•2å°šæœªè§£é”');
                    return;
                }
            }
            
            // ç”Ÿæˆæµ‹è¯•é¢˜ç›®
            const testTypeName = testType === 'test1' ? 'meaning' : 'gender';
            generateTestQuestions(theme, testTypeName);
            
            // æ¸²æŸ“ç¬¬ä¸€é¢˜
            renderTestCard(0);
            
            // æ›´æ–°è¿›åº¦æ˜¾ç¤º
            updateTestProgress();
            
            // éšè—ç‹¬ç«‹çš„è¿›åº¦æ¡ï¼ˆç°åœ¨è¿›åº¦æ¡å·²æ•´åˆåˆ°å¡ç‰‡å†…éƒ¨ï¼‰
            const independentProgress = document.getElementById('test-progress');
            if (independentProgress) {
                independentProgress.style.display = 'none';
            }
        }

        // ç”Ÿæˆæµ‹è¯•é¢˜ç›®
        function generateTestQuestions(theme, type) {
            const themeWords = vocabulary.filter(item => item.category === theme);
            const shuffled = [...themeWords].sort(() => Math.random() - 0.5);
            const questions = shuffled.slice(0, Math.min(10, shuffled.length));
            
            currentTest = {
                type: type,
                theme: theme,
                questions: questions.map((word, index) => ({
                    id: index,
                    word: word,
                    correctAnswer: type === 'meaning' ? word.meaning : (word.gender || (isPluralNoun(word.noun) ? 'die' : 'die')),
                    options: type === 'meaning' 
                        ? generateMeaningOptions(word, themeWords)
                        : generateGenderOptions(word)
                })),
                currentIndex: 0,
                answers: [],
                startTime: Date.now()
            };
        }

        // è¯­ä¹‰ç›¸å…³çš„å¹²æ‰°é¡¹æ˜ å°„ï¼ˆç²¾å¿ƒè®¾è®¡çš„è¯±æƒ‘é€‰é¡¹ï¼‰
        const semanticDistractors = {
            // æ—¶é—´å’Œæ—¥æœŸç›¸å…³
            'ä¸Šåˆ': ['ä¸‹åˆ', 'ä¸­åˆ', 'æ—©æ™¨'],
            'ä¸‹åˆ': ['ä¸Šåˆ', 'ä¸­åˆ', 'å‚æ™š'],
            'ä¸­åˆ': ['ä¸Šåˆ', 'ä¸‹åˆ', 'æ—©æ™¨'],
            'æ—©æ™¨': ['ä¸Šåˆ', 'ä¸­åˆ', 'å‚æ™š'],
            'å‚æ™š': ['ä¸‹åˆ', 'ä¸­åˆ', 'å¤œ'],
            'å¤œ': ['å‚æ™š', 'æ—©æ™¨', 'ä¸­åˆ'],
            'å‘¨å…­': ['å‘¨æ—¥', 'å‘¨æœ«', 'å‘¨äº”'],
            'å‘¨æ—¥': ['å‘¨å…­', 'å‘¨æœ«', 'å‘¨ä¸€'],
            'å‘¨æœ«': ['å‘¨å…­', 'å‘¨æ—¥', 'å‘¨äº”'],
            'å‘¨ä¸€': ['å‘¨äºŒ', 'å‘¨æ—¥', 'å‘¨æœ«'],
            'æ˜¥å¤©': ['å¤å¤©', 'ç§‹å¤©', 'å†¬å¤©'],
            'å¤å¤©': ['æ˜¥å¤©', 'ç§‹å¤©', 'å†¬å¤©'],
            'ç§‹å¤©': ['æ˜¥å¤©', 'å¤å¤©', 'å†¬å¤©'],
            'å†¬å¤©': ['æ˜¥å¤©', 'å¤å¤©', 'ç§‹å¤©'],
            '1æœˆ': ['2æœˆ', '12æœˆ', '3æœˆ'],
            '3æœˆ': ['4æœˆ', '2æœˆ', '5æœˆ'],
            '5æœˆ': ['6æœˆ', '4æœˆ', '7æœˆ'],
            '6æœˆ': ['7æœˆ', '5æœˆ', '8æœˆ'],
            '7æœˆ': ['8æœˆ', '6æœˆ', '9æœˆ'],
            '12æœˆ': ['1æœˆ', '11æœˆ', '10æœˆ'],
            'å¼€å§‹': ['ç»“æŸ', 'ä¸­é—´', 'ç»§ç»­'],
            'ç»“æŸ': ['å¼€å§‹', 'ä¸­é—´', 'ç»§ç»­'],
            
            // å®¶åº­å…³ç³»ç›¸å…³
            'çˆ¶äº²': ['æ¯äº²', 'å„¿å­', 'å¥³å„¿'],
            'æ¯äº²': ['çˆ¶äº²', 'å„¿å­', 'å¥³å„¿'],
            'å„¿å­': ['å¥³å„¿', 'çˆ¶äº²', 'æ¯äº²'],
            'å¥³å„¿': ['å„¿å­', 'çˆ¶äº²', 'æ¯äº²'],
            'å…„å¼Ÿ': ['å§å¦¹', 'çˆ¶äº²', 'æ¯äº²'],
            'å§å¦¹': ['å…„å¼Ÿ', 'çˆ¶äº²', 'æ¯äº²'],
            'ä¸ˆå¤«': ['å¦»å­', 'çˆ¶äº²', 'æ¯äº²'],
            'å¦»å­': ['ä¸ˆå¤«', 'çˆ¶äº²', 'æ¯äº²'],
            'æœ‹å‹': ['å¥³æœ‹å‹', 'å®¶äºº', 'åŒäº‹'],
            'å¥³æœ‹å‹': ['æœ‹å‹', 'å¦»å­', 'å§å¦¹'],
            'ç”·å­©': ['å¥³å­©', 'å„¿å­', 'å…„å¼Ÿ'],
            'å¥³å­©': ['ç”·å­©', 'å¥³å„¿', 'å§å¦¹'],
            'å­©å­': ['å©´å„¿', 'ç”·å­©', 'å¥³å­©'],
            'å©´å„¿': ['å­©å­', 'ç”·å­©', 'å¥³å­©'],
            'æˆäºº': ['å­©å­', 'å©´å„¿', 'è€äºº'],
            
            // è¡£æœç›¸å…³
            'é‹å­': ['è¢œå­', 'è£¤å­', 'è¡£æœ'],
            'è£¤å­': ['çŸ­è£™', 'é‹å­', 'è¡£æœ'],
            'çŸ­è£™': ['è£¤å­', 'è¡£æœ', 'å¤¹å…‹'],
            'å¤¹å…‹': ['é•¿å¤–å¥—', 'æ¯›è¡£', 'è¡£æœ'],
            'é•¿å¤–å¥—': ['å¤¹å…‹', 'æ¯›è¡£', 'è¡£æœ'],
            'æ¯›è¡£': ['å¤¹å…‹', 'é•¿å¤–å¥—', 'è¡£æœ'],
            'è¡£æœ': ['è£¤å­', 'é‹å­', 'å¤¹å…‹'],
            
            // é£Ÿç‰©ç›¸å…³
            'æ—©é¤': ['ä¸­é¤', 'æ™šé¤', 'åˆé¤'],
            'ä¸­é¤': ['æ—©é¤', 'æ™šé¤', 'åˆé¤'],
            'æ™šé¤': ['ä¸­é¤', 'æ—©é¤', 'åˆé¤'],
            'è‹¹æœ': ['æ©™å­', 'é¦™è•‰', 'æ¢¨'],
            'æ©™å­': ['è‹¹æœ', 'é¦™è•‰', 'æ¢¨'],
            'é¦™è•‰': ['è‹¹æœ', 'æ©™å­', 'æ¢¨'],
            'æ¢¨': ['è‹¹æœ', 'æ©™å­', 'é¦™è•‰'],
            'å’–å•¡': ['èŒ¶', 'æ°´', 'æœæ±'],
            'èŒ¶': ['å’–å•¡', 'æ°´', 'æœæ±'],
            'æ°´': ['å’–å•¡', 'èŒ¶', 'æœæ±'],
            'æœæ±': ['å’–å•¡', 'èŒ¶', 'æ°´'],
            'å•¤é…’': ['è‘¡è„é…’', 'æ°´', 'æœæ±'],
            'è‘¡è„é…’': ['å•¤é…’', 'æ°´', 'æœæ±'],
            'è‚‰': ['é±¼', 'é¸¡è‚‰', 'é¦™è‚ '],
            'é±¼': ['è‚‰', 'é¸¡è‚‰', 'é¦™è‚ '],
            'é¸¡è‚‰': ['è‚‰', 'é±¼', 'é¦™è‚ '],
            'é¦™è‚ ': ['è‚‰', 'é±¼', 'ç«è…¿'],
            'ç«è…¿': ['é¦™è‚ ', 'è‚‰', 'é±¼'],
            'é¢åŒ…': ['å°é¢åŒ…', 'è›‹ç³•', 'ç±³é¥­'],
            'å°é¢åŒ…': ['é¢åŒ…', 'è›‹ç³•', 'ç±³é¥­'],
            'è›‹ç³•': ['é¢åŒ…', 'å°é¢åŒ…', 'ç±³é¥­'],
            'ç±³é¥­': ['é¢åŒ…', 'é¢æ¡', 'è›‹ç³•'],
            'é¢æ¡': ['ç±³é¥­', 'é¢åŒ…', 'è›‹ç³•'],
            'åœŸè±†': ['è¥¿çº¢æŸ¿', 'è”¬èœ', 'æ°´æœ'],
            'è¥¿çº¢æŸ¿': ['åœŸè±†', 'è”¬èœ', 'æ°´æœ'],
            'è”¬èœ': ['æ°´æœ', 'åœŸè±†', 'è¥¿çº¢æŸ¿'],
            'æ°´æœ': ['è”¬èœ', 'åœŸè±†', 'è¥¿çº¢æŸ¿'],
            'ç›': ['ç³–', 'æ²¹', 'é»„æ²¹'],
            'æ²¹': ['ç›', 'ç³–', 'é»„æ²¹'],
            'é»„æ²¹': ['ç›', 'æ²¹', 'ç³–'],
            'å¥¶é…ª': ['é»„æ²¹', 'ç‰›å¥¶', 'é¸¡è›‹'],
            'ç‰›å¥¶': ['å¥¶é…ª', 'é»„æ²¹', 'é¸¡è›‹'],
            'é¸¡è›‹': ['å¥¶é…ª', 'ç‰›å¥¶', 'é»„æ²¹'],
            
            // å±…ä½ç›¸å…³
            'æˆ¿é—´': ['å®¢å…', 'å§å®¤', 'å¨æˆ¿'],
            'å®¢å…': ['æˆ¿é—´', 'å§å®¤', 'å¨æˆ¿'],
            'å§å®¤': ['æˆ¿é—´', 'å®¢å…', 'å¨æˆ¿'],
            'å¨æˆ¿': ['æˆ¿é—´', 'å®¢å…', 'æµ´å®¤'],
            'æµ´å®¤': ['å¨æˆ¿', 'å«ç”Ÿé—´', 'æˆ¿é—´'],
            'å«ç”Ÿé—´': ['æµ´å®¤', 'å¨æˆ¿', 'æˆ¿é—´'],
            'é—¨': ['çª—', 'å…¥å£', 'å‡ºå£'],
            'çª—': ['é—¨', 'å…¥å£', 'å‡ºå£'],
            'å…¥å£': ['å‡ºå£', 'é—¨', 'çª—'],
            'å‡ºå£': ['å…¥å£', 'é—¨', 'çª—'],
            'æ¡Œå­': ['æ¤…å­', 'æ²™å‘', 'åºŠ'],
            'æ¤…å­': ['æ¡Œå­', 'æ²™å‘', 'åºŠ'],
            'æ²™å‘': ['æ¡Œå­', 'æ¤…å­', 'åºŠ'],
            'åºŠ': ['æ¡Œå­', 'æ¤…å­', 'æ²™å‘'],
            'æŸœå­': ['æ¡Œå­', 'æ¤…å­', 'æ²™å‘'],
            'é•œå­': ['ç”»', 'å›¾ç‰‡', 'å¢™'],
            'ç”»': ['é•œå­', 'å›¾ç‰‡', 'å¢™'],
            'å›¾ç‰‡': ['ç”»', 'é•œå­', 'å¢™'],
            'å¢™': ['ç”»', 'å›¾ç‰‡', 'é•œå­'],
            'åŸå¸‚': ['ä¹¡æ‘', 'æ‘åº„', 'å›½å®¶'],
            'ä¹¡æ‘': ['åŸå¸‚', 'æ‘åº„', 'å›½å®¶'],
            'æ‘åº„': ['åŸå¸‚', 'ä¹¡æ‘', 'å›½å®¶'],
            'å›½å®¶': ['åŸå¸‚', 'ä¹¡æ‘', 'æ‘åº„'],
            
            // äº¤é€šç›¸å…³
            'ç«è½¦': ['åœ°é“', 'å…¬äº¤', 'è½»è½¨'],
            'åœ°é“': ['ç«è½¦', 'å…¬äº¤', 'è½»è½¨'],
            'å…¬äº¤': ['ç«è½¦', 'åœ°é“', 'è½»è½¨'],
            'è½»è½¨': ['ç«è½¦', 'åœ°é“', 'å…¬äº¤'],
            'é£æœº': ['ç«è½¦', 'è½®èˆ¹', 'æ±½è½¦'],
            'è½®èˆ¹': ['é£æœº', 'ç«è½¦', 'æ±½è½¦'],
            'æ±½è½¦': ['é£æœº', 'ç«è½¦', 'è‡ªè¡Œè½¦'],
            'è‡ªè¡Œè½¦': ['æ±½è½¦', 'æ‘©æ‰˜è½¦', 'å…¬äº¤'],
            'æœºåœº': ['ç«è½¦ç«™', 'æ±½è½¦ç«™', 'æ¸¯å£'],
            'ç«è½¦ç«™': ['æœºåœº', 'æ±½è½¦ç«™', 'æ¸¯å£'],
            'è½¦ç¥¨': ['æœºç¥¨', 'èˆ¹ç¥¨', 'é—¨ç¥¨'],
            'æœºç¥¨': ['è½¦ç¥¨', 'èˆ¹ç¥¨', 'é—¨ç¥¨'],
            'èˆ¹ç¥¨': ['è½¦ç¥¨', 'æœºç¥¨', 'é—¨ç¥¨'],
            'é—¨ç¥¨': ['è½¦ç¥¨', 'æœºç¥¨', 'èˆ¹ç¥¨'],
            
            // è´­ç‰©ç›¸å…³
            'å•†åº—': ['è¶…å¸‚', 'å•†åœº', 'é¢åŒ…åº—'],
            'è¶…å¸‚': ['å•†åº—', 'å•†åœº', 'é¢åŒ…åº—'],
            'å•†åœº': ['å•†åº—', 'è¶…å¸‚', 'é¢åŒ…åº—'],
            'é¢åŒ…åº—': ['å•†åº—', 'è¶…å¸‚', 'å•†åœº'],
            'ä»·æ ¼': ['é‡é‡', 'å°ºå¯¸', 'é¢œè‰²'],
            'é‡é‡': ['ä»·æ ¼', 'å°ºå¯¸', 'é¢œè‰²'],
            'å°ºå¯¸': ['ä»·æ ¼', 'é‡é‡', 'é¢œè‰²'],
            'é¢œè‰²': ['ä»·æ ¼', 'é‡é‡', 'å°ºå¯¸'],
            'é’±': ['æ¬§å…ƒ', 'ä»·æ ¼', 'è´¦å•'],
            'æ¬§å…ƒ': ['é’±', 'ä»·æ ¼', 'è´¦å•'],
            'è´¦å•': ['é’±', 'ä»·æ ¼', 'æ¬§å…ƒ'],
            
            // èº«ä½“éƒ¨ä½ç›¸å…³
            'å¤´': ['çœ¼ç›', 'è€³æœµ', 'é¼»å­'],
            'çœ¼ç›': ['å¤´', 'è€³æœµ', 'é¼»å­'],
            'è€³æœµ': ['å¤´', 'çœ¼ç›', 'é¼»å­'],
            'é¼»å­': ['å¤´', 'çœ¼ç›', 'è€³æœµ'],
            'å˜´': ['ç‰™é½¿', 'èˆŒå¤´', 'é¼»å­'],
            'ç‰™é½¿': ['å˜´', 'èˆŒå¤´', 'é¼»å­'],
            'æ‰‹': ['è„š', 'æ‰‹è‡‚', 'è…¿'],
            'è„š': ['æ‰‹', 'æ‰‹è‡‚', 'è…¿'],
            'æ‰‹è‡‚': ['æ‰‹', 'è„š', 'è…¿'],
            'è…¿': ['æ‰‹', 'è„š', 'æ‰‹è‡‚'],
            'è‚šå­': ['å¤´', 'æ‰‹', 'è„š'],
            'å¤´å‘': ['å¤´', 'çœ¼ç›', 'è€³æœµ'],
            
            // å­¦ä¹ å’Œå·¥ä½œç›¸å…³
            'å­¦æ ¡': ['è¯¾ç¨‹', 'ç­çº§', 'è€å¸ˆ'],
            'è¯¾ç¨‹': ['å­¦æ ¡', 'ç­çº§', 'è€å¸ˆ'],
            'ç­çº§': ['å­¦æ ¡', 'è¯¾ç¨‹', 'è€å¸ˆ'],
            'è€å¸ˆ': ['å­¦æ ¡', 'è¯¾ç¨‹', 'å­¦ç”Ÿ'],
            'å­¦ç”Ÿ': ['è€å¸ˆ', 'å­¦æ ¡', 'è¯¾ç¨‹'],
            'åŒäº‹': ['è€å¸ˆ', 'å­¦ç”Ÿ', 'è€æ¿'],
            'è€æ¿': ['åŒäº‹', 'è€å¸ˆ', 'å­¦ç”Ÿ'],
            'å·¥ä½œ': ['èŒä¸š', 'å…¬å¸', 'åŠå…¬å®¤'],
            'èŒä¸š': ['å·¥ä½œ', 'å…¬å¸', 'åŠå…¬å®¤'],
            'å…¬å¸': ['å·¥ä½œ', 'èŒä¸š', 'åŠå…¬å®¤'],
            'åŠå…¬å®¤': ['å·¥ä½œ', 'èŒä¸š', 'å…¬å¸'],
            'è€ƒè¯•': ['è¯¾ç¨‹', 'ä½œä¸š', 'ç»ƒä¹ '],
            'ä½œä¸š': ['è€ƒè¯•', 'è¯¾ç¨‹', 'ç»ƒä¹ '],
            'ç»ƒä¹ ': ['è€ƒè¯•', 'è¯¾ç¨‹', 'ä½œä¸š'],
            'é”™è¯¯': ['ç­”æ¡ˆ', 'é—®é¢˜', 'ç»ƒä¹ '],
            'ç­”æ¡ˆ': ['é”™è¯¯', 'é—®é¢˜', 'ç»ƒä¹ '],
            'é—®é¢˜': ['ç­”æ¡ˆ', 'é”™è¯¯', 'ç»ƒä¹ '],
            'ä¹¦': ['çº¸', 'ç¬”', 'æœ¬å­'],
            'çº¸': ['ä¹¦', 'ç¬”', 'æœ¬å­'],
            'ç¬”': ['ä¹¦', 'çº¸', 'é“…ç¬”'],
            'é“…ç¬”': ['ç¬”', 'çº¸', 'åœ†ç ç¬”'],
            'åœ†ç ç¬”': ['é“…ç¬”', 'ç¬”', 'çº¸'],
            'æœ¬å­': ['ä¹¦', 'çº¸', 'ç¬”'],
            
            // ä¸šä½™æ´»åŠ¨ç›¸å…³
            'ç”µå½±': ['éŸ³ä¹', 'ä¹¦', 'æ¸¸æˆ'],
            'éŸ³ä¹': ['ç”µå½±', 'ä¹¦', 'æ¸¸æˆ'],
            'æ¸¸æˆ': ['ç”µå½±', 'éŸ³ä¹', 'ä¹¦'],
            'ä¹¦': ['ç”µå½±', 'éŸ³ä¹', 'æ¸¸æˆ'],
            'è¿åŠ¨': ['è¶³çƒ', 'æ¸¸æ³³', 'æ•£æ­¥'],
            'è¶³çƒ': ['è¿åŠ¨', 'æ¸¸æ³³', 'æ•£æ­¥'],
            'æ¸¸æ³³': ['è¿åŠ¨', 'è¶³çƒ', 'æ•£æ­¥'],
            'æ•£æ­¥': ['è¿åŠ¨', 'è¶³çƒ', 'æ¸¸æ³³'],
            'å¤ªé˜³': ['æœˆäº®', 'æ˜Ÿæ˜Ÿ', 'å¤©ç©º'],
            'æœˆäº®': ['å¤ªé˜³', 'æ˜Ÿæ˜Ÿ', 'å¤©ç©º'],
            'æ˜Ÿæ˜Ÿ': ['å¤ªé˜³', 'æœˆäº®', 'å¤©ç©º'],
            'å¤©æ°”': ['å¤ªé˜³', 'é›¨', 'é£'],
            'é›¨': ['å¤©æ°”', 'å¤ªé˜³', 'é£'],
            'é£': ['å¤©æ°”', 'å¤ªé˜³', 'é›¨'],
            'æ¹–': ['æµ·', 'æ²³', 'æ¸¸æ³³æ± '],
            'æµ·': ['æ¹–', 'æ²³', 'æ¸¸æ³³æ± '],
            'æ²³': ['æ¹–', 'æµ·', 'æ¸¸æ³³æ± '],
            'æ¸¸æ³³æ± ': ['æ¹–', 'æµ·', 'æ²³'],
            'ç¤¼ç‰©': ['é‚€è¯·', 'èŠ‚æ—¥', 'åº†ç¥'],
            'é‚€è¯·': ['ç¤¼ç‰©', 'èŠ‚æ—¥', 'åº†ç¥'],
            'èŠ‚æ—¥': ['ç¤¼ç‰©', 'é‚€è¯·', 'åº†ç¥'],
            'åº†ç¥': ['ç¤¼ç‰©', 'é‚€è¯·', 'èŠ‚æ—¥'],
            'å‡æœŸ': ['åº¦å‡', 'ä¼‘æ¯', 'æ—…è¡Œ'],
            'åº¦å‡': ['å‡æœŸ', 'ä¼‘æ¯', 'æ—…è¡Œ'],
            'æ—…è¡Œ': ['å‡æœŸ', 'åº¦å‡', 'ä¼‘æ¯'],
            
            // é“¶è¡Œå’Œé‚®å±€ç›¸å…³
            'é“¶è¡Œ': ['é‚®å±€', 'è´¦æˆ·', 'é’±'],
            'é‚®å±€': ['é“¶è¡Œ', 'è´¦æˆ·', 'é’±'],
            'è´¦æˆ·': ['é“¶è¡Œ', 'é‚®å±€', 'é’±'],
            'ä¿¡': ['æ˜ä¿¡ç‰‡', 'é‚®ç¥¨', 'ä¿¡å°'],
            'æ˜ä¿¡ç‰‡': ['ä¿¡', 'é‚®ç¥¨', 'ä¿¡å°'],
            'é‚®ç¥¨': ['ä¿¡', 'æ˜ä¿¡ç‰‡', 'ä¿¡å°'],
            'ç”µè¯': ['æ‰‹æœº', 'ä¼ çœŸ', 'ç­”å½•æœº'],
            'æ‰‹æœº': ['ç”µè¯', 'ä¼ çœŸ', 'ç­”å½•æœº'],
            'ä¼ çœŸ': ['ç”µè¯', 'æ‰‹æœº', 'ç­”å½•æœº'],
            'ç­”å½•æœº': ['ç”µè¯', 'æ‰‹æœº', 'ä¼ çœŸ'],
            
            // çœ‹åŒ»ç”Ÿç›¸å…³
            'åŒ»ç”Ÿ': ['ç‰™åŒ»', 'è¯Šæ‰€', 'åŒ»é™¢'],
            'ç‰™åŒ»': ['åŒ»ç”Ÿ', 'è¯Šæ‰€', 'åŒ»é™¢'],
            'è¯Šæ‰€': ['åŒ»ç”Ÿ', 'ç‰™åŒ»', 'åŒ»é™¢'],
            'åŒ»é™¢': ['åŒ»ç”Ÿ', 'ç‰™åŒ»', 'è¯Šæ‰€'],
            'è¯å“': ['è¯', 'å¤„æ–¹', 'æ²»ç–—'],
            'è¯': ['è¯å“', 'å¤„æ–¹', 'æ²»ç–—'],
            'å¤„æ–¹': ['è¯å“', 'è¯', 'æ²»ç–—'],
            'æ²»ç–—': ['è¯å“', 'è¯', 'å¤„æ–¹'],
            'è¯åº—': ['è¯Šæ‰€', 'åŒ»é™¢', 'åŒ»ç”Ÿ'],
            
            // æ–‡å…·ç›¸å…³ï¼ˆé’å°‘å¹´ï¼‰
            'ä¹¦åŒ…': ['ç¬”è¢‹', 'æœ¬å­', 'ä¹¦'],
            'ç¬”è¢‹': ['ä¹¦åŒ…', 'æœ¬å­', 'ä¹¦'],
            'æœ¬å­': ['ä¹¦åŒ…', 'ç¬”è¢‹', 'ä¹¦'],
            'æ©¡çš®': ['é“…ç¬”', 'å°ºå­', 'å·ç¬”åˆ€'],
            'å°ºå­': ['æ©¡çš®', 'é“…ç¬”', 'å·ç¬”åˆ€'],
            'å·ç¬”åˆ€': ['æ©¡çš®', 'å°ºå­', 'é“…ç¬”'],
            'å‰ªåˆ€': ['èƒ¶æ°´', 'å°ºå­', 'å·ç¬”åˆ€'],
            'èƒ¶æ°´': ['å‰ªåˆ€', 'å°ºå­', 'å·ç¬”åˆ€'],
            'çœ¼é•œ': ['çœ¼ç›', 'è§†åŠ›', 'é•œç‰‡'],
            
            // åŠ¨ç‰©ç›¸å…³ï¼ˆé’å°‘å¹´ï¼‰
            'ç‹—': ['çŒ«', 'å…”å­', 'é¸Ÿ'],
            'çŒ«': ['ç‹—', 'å…”å­', 'é¸Ÿ'],
            'å…”å­': ['ç‹—', 'çŒ«', 'é¸Ÿ'],
            'é¸Ÿ': ['ç‹—', 'çŒ«', 'å…”å­'],
            'å® ç‰©': ['ç‹—', 'çŒ«', 'å…”å­'],
            'é©¬': ['ç‰›', 'ç¾Š', 'çŒª'],
            'ç‰›': ['é©¬', 'ç¾Š', 'çŒª'],
            'ç¾Š': ['é©¬', 'ç‰›', 'çŒª'],
            'çŒª': ['é©¬', 'ç‰›', 'ç¾Š'],
            'è€è™': ['ç‹®å­', 'è±¹å­', 'ç‹¼'],
            'ç‹®å­': ['è€è™', 'è±¹å­', 'ç‹¼'],
            'è±¹å­': ['è€è™', 'ç‹®å­', 'ç‹¼'],
            'ç‹¼': ['è€è™', 'ç‹®å­', 'è±¹å­']
        };
        
        // è·å–è¯­ä¹‰ç›¸å…³çš„å¹²æ‰°é¡¹
        function getSemanticDistractors(meaning) {
            // å¤„ç†å¸¦æ ‡ç‚¹çš„å«ä¹‰ï¼ˆå¦‚"å¤©ã€ç™½å¤©"ï¼‰
            const cleanMeaning = meaning.split('ã€')[0].split('ï¼Œ')[0].trim();
            return semanticDistractors[cleanMeaning] || [];
        }
        
        // ç”Ÿæˆè¯­ä¹‰æµ‹è¯•é€‰é¡¹
        function generateMeaningOptions(correctWord, allWords) {
            const correctMeaning = correctWord.meaning;
            const options = [correctMeaning];
            
            // è·å–è¯­ä¹‰ç›¸å…³çš„å¹²æ‰°é¡¹
            const semanticOptions = getSemanticDistractors(correctMeaning);
            
            // ä»åŒä¸»é¢˜è¯æ±‡ä¸­æŸ¥æ‰¾è¯­ä¹‰ç›¸å…³çš„å¹²æ‰°é¡¹
            const themeWords = allWords.filter(w => w.meaning !== correctMeaning);
            const foundSemanticOptions = [];
            
            // ä¼˜å…ˆé€‰æ‹©è¯­ä¹‰ç›¸å…³çš„å¹²æ‰°é¡¹
            for (const semanticOption of semanticOptions) {
                const found = themeWords.find(w => {
                    const wMeaning = w.meaning.split('ã€')[0].split('ï¼Œ')[0].trim();
                    return wMeaning === semanticOption || w.meaning.includes(semanticOption);
                });
                if (found && foundSemanticOptions.length < 1) {
                    foundSemanticOptions.push(found.meaning);
                }
            }
            
            // æ·»åŠ ç²¾å¿ƒè®¾è®¡çš„è¯±æƒ‘é€‰é¡¹ï¼ˆ1ä¸ªï¼‰
            if (foundSemanticOptions.length > 0) {
                options.push(foundSemanticOptions[0]);
            }
            
            // æ·»åŠ ä¸¤ä¸ªéšæœºå¹²æ‰°é€‰é¡¹
            const remainingWords = themeWords.filter(w => !options.includes(w.meaning));
            const shuffled = [...remainingWords].sort(() => Math.random() - 0.5);
            
            const neededCount = 4 - options.length;
            for (let i = 0; i < neededCount && i < shuffled.length; i++) {
                options.push(shuffled[i].meaning);
            }
            
            // å¦‚æœé€‰é¡¹ä¸è¶³4ä¸ªï¼Œä»æ‰€æœ‰è¯æ±‡ä¸­è¡¥å……
            if (options.length < 4) {
                const allOtherWords = vocabulary.filter(w => 
                    w.category === correctWord.category && 
                    !options.includes(w.meaning)
                );
                const shuffledAll = [...allOtherWords].sort(() => Math.random() - 0.5);
                for (let i = 0; i < 4 - options.length && i < shuffledAll.length; i++) {
                    options.push(shuffledAll[i].meaning);
                }
            }
            
            // éšæœºæ‰“ä¹±é€‰é¡¹
            return options.sort(() => Math.random() - 0.5);
        }

        // ç”Ÿæˆè¯æ€§æµ‹è¯•é€‰é¡¹
        function generateGenderOptions(correctWord) {
            const genders = ['der', 'die', 'das'];
            const correctGender = correctWord.gender || (isPluralNoun(correctWord.noun) ? 'die' : 'die');
            
            // ç¡®ä¿æ­£ç¡®ç­”æ¡ˆåœ¨é€‰é¡¹ä¸­
            const options = [correctGender];
            
            // æ·»åŠ å…¶ä»–é€‰é¡¹
            genders.forEach(g => {
                if (g !== correctGender && options.length < 4) {
                    options.push(g);
                }
            });
            
            // å¦‚æœé€‰é¡¹ä¸è¶³4ä¸ªï¼Œè¡¥å……
            while (options.length < 4) {
                const randomGender = genders[Math.floor(Math.random() * genders.length)];
                if (!options.includes(randomGender)) {
                    options.push(randomGender);
                }
            }
            
            // éšæœºæ‰“ä¹±
            return options.sort(() => Math.random() - 0.5);
        }

        // æ¸²æŸ“æµ‹è¯•å¡ç‰‡
        function renderTestCard(questionIndex) {
            const container = domCache.cardsContainer || document.getElementById('cards-container');
            if (container) {
            container.innerHTML = '';
            }
            
            if (questionIndex >= currentTest.questions.length) {
                completeTest();
                return;
            }
            
            const question = currentTest.questions[questionIndex];
            
            // åˆ›å»ºæ ‡é¢˜è¡Œå®¹å™¨ï¼ˆåŒ…å«æµ‹è¯•æç¤ºæ–‡å­—å’Œå¤–éƒ¨æ ‡é¢˜ï¼‰
            const titleRow = document.createElement('div');
            titleRow.className = 'test-title-row';
            
            // è·å–æµ‹è¯•æç¤ºæ–‡å­—å…ƒç´ 
            const testInstruction = document.getElementById('test-instruction');
            if (testInstruction) {
                // å°†æµ‹è¯•æç¤ºæ–‡å­—æ·»åŠ åˆ°æ ‡é¢˜è¡Œ
                titleRow.appendChild(testInstruction.cloneNode(true));
                // éšè—åŸæ¥çš„æµ‹è¯•æç¤ºæ–‡å­—ï¼ˆå› ä¸ºå·²ç»ç§»åˆ°æ ‡é¢˜è¡Œä¸­ï¼‰
                testInstruction.style.display = 'none';
            }
            
            // åˆ›å»ºå¤–éƒ¨æ ‡é¢˜ï¼ˆæµ‹è¯•æ¨¡å¼ä¸‹æ˜¾ç¤ºé¢˜ç›®å’Œç­”æ¡ˆï¼‰
            const cardTitle = document.createElement('div');
            cardTitle.className = 'card-external-title';
            cardTitle.innerHTML = `
                <div class="card-title-indicators">
                    <span class="card-title-front active">é¢˜ç›®</span>
                    <span class="card-title-separator">|</span>
                    <span class="card-title-back">ç­”æ¡ˆ</span>
                </div>
                <span class="card-title-hint">è¯·æ‰¾å‡ºå’Œå¾·è¯­å•è¯åŒ¹é…çš„é€‰é¡¹ï¼š</span>
            `;
            
            // å°†å¤–éƒ¨æ ‡é¢˜æ·»åŠ åˆ°æ ‡é¢˜è¡Œ
            titleRow.appendChild(cardTitle);
            
            // åˆ›å»ºå¡ç‰‡åŒ…è£…å™¨
            const cardWrapper = document.createElement('div');
            cardWrapper.className = 'card-wrapper';
            
            const card = document.createElement('div');
            card.className = 'card test-card';
            
            const imagePath = getImagePath(question.word.image, question.word.category);
            const genderInfo = getGenderInfo(question.word.gender, question.word.noun);
            const genderBadge = genderInfo 
                ? `<div class="gender-badge ${genderInfo.class}">${genderInfo.text}</div>` 
                : '';
            
            // è®¡ç®—ç­”æ¡ˆæ˜¯å¦æ­£ç¡®ï¼ˆå¦‚æœå·²é€‰æ‹©ï¼‰
            let isCorrect = false;
            if (currentTest.answers[questionIndex]) {
                const selectedOption = question.options[currentTest.answers[questionIndex].selectedIndex];
                const normalizedSelected = normalizeMeaning(selectedOption);
                const normalizedCorrect = normalizeMeaning(question.correctAnswer);
                isCorrect = normalizedSelected === normalizedCorrect;
            }
            
            // è®¡ç®—è¿›åº¦
            const total = currentTest.questions.length;
            const current = questionIndex + 1;
            const progress = (current / total) * 100;
            
            card.innerHTML = `
                <div class="card-inner">
                    <!-- æµ‹è¯•å¡ç‰‡æ­£é¢ï¼šé¢˜ç›®+é€‰é¡¹ -->
                    <div class="card-face card-front">
                        <div class="card-front-content">
                        <div class="test-question">${question.word.noun}</div>
                        <div class="test-options" id="test-options-${questionIndex}">
                            ${question.options.map((option, idx) => `
                                <div class="test-option" data-option="${idx}" onclick="selectOption(${questionIndex}, ${idx})">
                                    ${option}
                                </div>
                            `).join('')}
                            </div>
                        </div>
                        <!-- è¿›åº¦æ¡åŒºåŸŸ - æ¤å…¥å¡ç‰‡æ­£é¢å†…éƒ¨ -->
                        <div class="card-progress">
                            <div class="progress-info">
                                <span>${currentTest.type === 'meaning' ? 'è¯­ä¹‰æµ‹è¯•' : 'è¯æ€§æµ‹è¯•'}</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="height: ${progress}%"></div>
                            </div>
                            <div class="progress-label">${current}/${total}</div>
                        </div>
                    </div>
                    
                    <!-- æµ‹è¯•å¡ç‰‡èƒŒé¢ï¼šç­”æ¡ˆ+åé¦ˆ -->
                    <div class="card-face card-back">
                        <div class="card-back-content test-feedback">
                            <!-- ä¸Šæ–¹ä¸­æ–‡æ˜¾ç¤ºåŒºåŸŸ -->
                            <div class="chinese-section">
                                <div class="chinese-meaning">${question.word.meaning}</div>
                                </div>
                            
                            <!-- ä¸‹æ–¹å›¾ç‰‡åŒºåŸŸ - å æ®å¡ç‰‡é«˜åº¦çš„60%ï¼Œåº•éƒ¨å¯¹é½ -->
                            <div class="image-section">
                            <img src="${imagePath}" alt="${question.word.noun}" class="noun-image">
                            </div>
                        </div>
                        <!-- è¿›åº¦æ¡åŒºåŸŸ - æ¤å…¥å¡ç‰‡èƒŒé¢å†…éƒ¨ -->
                        <div class="card-progress">
                            <div class="progress-info">
                                <span>${currentTest.type === 'meaning' ? 'è¯­ä¹‰æµ‹è¯•' : 'è¯æ€§æµ‹è¯•'}</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="height: ${progress}%"></div>
                            </div>
                            <div class="progress-label">${current}/${total}</div>
                        </div>
                    </div>
                </div>
            `;
            
            // å¦‚æœå·²ç»é€‰æ‹©è¿‡ç­”æ¡ˆï¼Œæ˜¾ç¤ºåé¦ˆ
            if (currentTest.answers[questionIndex]) {
                const selectedIdx = currentTest.answers[questionIndex].selectedIndex;
                // ä½¿ç”¨æ ‡å‡†åŒ–æ¯”è¾ƒæŸ¥æ‰¾æ­£ç¡®ç­”æ¡ˆç´¢å¼•
                const normalizedCorrect = normalizeMeaning(question.correctAnswer);
                let correctIdx = -1;
                for (let i = 0; i < question.options.length; i++) {
                    if (normalizeMeaning(question.options[i]) === normalizedCorrect) {
                        correctIdx = i;
                        break;
                    }
                }
                
                const options = card.querySelectorAll('.test-option');
                options[selectedIdx].classList.add('selected');
                
                // é‡æ–°è®¡ç®—æ˜¯å¦æ­£ç¡®ï¼ˆç¡®ä¿ä¸èƒŒé¢ä¸€è‡´ï¼‰
                const selectedOption = question.options[selectedIdx];
                const normalizedSelected = normalizeMeaning(selectedOption);
                const isCorrect = normalizedSelected === normalizedCorrect;
                
                if (isCorrect) {
                    options[selectedIdx].classList.add('correct');
                } else {
                    options[selectedIdx].classList.add('incorrect');
                    if (correctIdx >= 0) {
                        options[correctIdx].classList.add('correct');
                    }
                }
                
                // æ›´æ–°ç­”æ¡ˆè®°å½•ä¸­çš„correctå­—æ®µ
                currentTest.answers[questionIndex].correct = isCorrect;
                
                // è‡ªåŠ¨ç¿»è½¬æ˜¾ç¤ºç­”æ¡ˆ
                setTimeout(() => {
                    card.classList.add('flipped');
                    // æ›´æ–°å¤–éƒ¨æ ‡é¢˜çš„æ¿€æ´»çŠ¶æ€å’Œæç¤ºæ–‡å­—ï¼ˆä»æ ‡é¢˜è¡Œä¸­æŸ¥æ‰¾ï¼‰
                    const titleRow = container.querySelector('.test-title-row');
                    if (titleRow) {
                        const titleFront = titleRow.querySelector('.card-title-front');
                        const titleBack = titleRow.querySelector('.card-title-back');
                        const titleHint = titleRow.querySelector('.card-title-hint');
                        if (titleFront && titleBack) {
                            titleFront.classList.remove('active');
                            titleBack.classList.add('active');
                        }
                        if (titleHint) {
                            titleHint.textContent = 'è¯·ç‚¹å‡»å¡ç‰‡ä»»æ„ä½ç½®ç»§ç»­ï¼š';
                            titleHint.style.display = 'block';
                        }
                    }
                }, 500);
            } else {
                // æ–°é¢˜ç›®ï¼Œç¡®ä¿å¡ç‰‡æœªç¿»è½¬
                card.classList.remove('flipped');
                // æ›´æ–°å¤–éƒ¨æ ‡é¢˜çš„æ¿€æ´»çŠ¶æ€å’Œæç¤ºæ–‡å­—ï¼ˆä»æ ‡é¢˜è¡Œä¸­æŸ¥æ‰¾ï¼‰
                const titleRow = container.querySelector('.test-title-row');
                if (titleRow) {
                    const titleFront = titleRow.querySelector('.card-title-front');
                    const titleBack = titleRow.querySelector('.card-title-back');
                    const titleHint = titleRow.querySelector('.card-title-hint');
                    if (titleFront && titleBack) {
                        titleFront.classList.add('active');
                        titleBack.classList.remove('active');
                    }
                    if (titleHint) {
                        titleHint.textContent = 'è¯·æ‰¾å‡ºå’Œå¾·è¯­å•è¯åŒ¹é…çš„é€‰é¡¹ï¼š';
                        titleHint.style.display = 'block';
                    }
                }
            }
            
            // æ·»åŠ ç‚¹å‡»äº‹ä»¶å¤„ç†ï¼Œæ”¯æŒæ‰‹åŠ¨ç¿»è½¬
            card.addEventListener('click', function(e) {
                // å¦‚æœç‚¹å‡»çš„æ˜¯é€‰é¡¹æŒ‰é’®ï¼Œä¸ç¿»è½¬å¡ç‰‡
                if (e.target.closest('.test-option')) {
                    return;
                }
                
                // åªæœ‰åœ¨å·²é€‰æ‹©ç­”æ¡ˆåæ‰èƒ½ç¿»è½¬
                if (currentTest.answers[questionIndex]) {
                    const answer = currentTest.answers[questionIndex];
                    const isCurrentCorrect = answer && answer.correct;
                    const wasFlipped = this.classList.contains('flipped');
                    
                    // æ£€æŸ¥æ˜¯å¦å·²ç»æŸ¥çœ‹è¿‡ç­”æ¡ˆï¼ˆç­”é”™åä»èƒŒé¢ç¿»å›æ­£é¢ï¼‰
                    const titleRow = container.querySelector('.test-title-row');
                    const titleHint = titleRow ? titleRow.querySelector('.card-title-hint') : null;
                    const isWaitingForNext = titleHint && titleHint.textContent.includes('è¯·å†æ¬¡ç‚¹å‡»å¡ç‰‡è¿›å…¥ä¸‹ä¸€é¢˜');
                    
                    // å¦‚æœç­”é”™ä¸”å·²ç»æŸ¥çœ‹è¿‡ç­”æ¡ˆï¼Œå†æ¬¡ç‚¹å‡»æ—¶ç›´æ¥è¿›å…¥ä¸‹ä¸€é¢˜
                    if (!isCurrentCorrect && isWaitingForNext && !wasFlipped) {
                        currentTest.currentIndex++;
                        if (currentTest.currentIndex < currentTest.questions.length) {
                            renderTestCard(currentTest.currentIndex);
                            updateTestProgress();
                        } else {
                            completeTest();
                        }
                        return;
                    }
                    
                    // æ­£å¸¸ç¿»è½¬é€»è¾‘
                    this.classList.toggle('flipped');
                    const isFlipped = this.classList.contains('flipped');
                    
                    // æ›´æ–°å¤–éƒ¨æ ‡é¢˜çš„æ¿€æ´»çŠ¶æ€å’Œæç¤ºæ–‡å­—ï¼ˆä»æ ‡é¢˜è¡Œä¸­æŸ¥æ‰¾ï¼‰
                    if (titleRow) {
                        const titleFront = titleRow.querySelector('.card-title-front');
                        const titleBack = titleRow.querySelector('.card-title-back');
                        if (isFlipped) {
                            // ç¿»è½¬åˆ°èƒŒé¢
                            if (titleFront && titleBack) {
                                titleFront.classList.remove('active');
                                titleBack.classList.add('active');
                            }
                            if (titleHint) {
                                titleHint.textContent = 'è¯·ç‚¹å‡»å¡ç‰‡è¿”å›æ­£é¢ç»§ç»­ä¸‹ä¸€é¢˜ï¼š';
                                titleHint.style.display = 'block';
                            }
                        } else {
                            // ä»èƒŒé¢ç¿»å›æ­£é¢
                            if (titleFront && titleBack) {
                                titleFront.classList.add('active');
                                titleBack.classList.remove('active');
                            }
                            
                            if (wasFlipped && !isFlipped) {
                                // æ— è®ºæ˜¯ç­”å¯¹è¿˜æ˜¯ç­”é”™ï¼Œä»èƒŒé¢ç¿»å›æ­£é¢æ—¶éƒ½ç›´æ¥è¿›å…¥ä¸‹ä¸€é¢˜
                                if (titleHint) {
                                    titleHint.textContent = 'è¯·æ‰¾å‡ºå’Œå¾·è¯­å•è¯åŒ¹é…çš„é€‰é¡¹ï¼š';
                                    titleHint.style.display = 'block';
                                }
                                currentTest.currentIndex++;
                                if (currentTest.currentIndex < currentTest.questions.length) {
                                    renderTestCard(currentTest.currentIndex);
                                    updateTestProgress();
                                } else {
                                    completeTest();
                                }
                            }
                        }
                    }
                }
            });
            
            // ç»„è£…ï¼šå…ˆæ·»åŠ æ ‡é¢˜è¡Œï¼Œå†æ·»åŠ å¡ç‰‡åŒ…è£…å™¨
            container.appendChild(titleRow);
            cardWrapper.appendChild(card);
            container.appendChild(cardWrapper);
            
            // è¿›åº¦æ¡å·²æ•´åˆåˆ°å¡ç‰‡å†…éƒ¨ï¼Œæ— éœ€æ›´æ–°ä½ç½®
        }

        // æ ‡å‡†åŒ–å«ä¹‰å­—ç¬¦ä¸²ï¼ˆç”¨äºæ¯”è¾ƒï¼‰
        function normalizeMeaning(meaning) {
            if (!meaning) return '';
            // å»é™¤é¦–å°¾ç©ºæ ¼ï¼Œå¤„ç†å¤šä¸ªå«ä¹‰çš„æƒ…å†µ
            return meaning.trim().split('ã€')[0].split('ï¼Œ')[0].split('ï¼ˆ')[0].trim();
        }
        
        // é€‰æ‹©é€‰é¡¹
        function selectOption(questionIndex, optionIndex) {
            // å¦‚æœå·²ç»é€‰æ‹©è¿‡ï¼Œä¸å…è®¸å†æ¬¡é€‰æ‹©
            if (currentTest.answers[questionIndex]) {
                return;
            }
            
            const question = currentTest.questions[questionIndex];
            const selectedOption = question.options[optionIndex];
            
            // æ ‡å‡†åŒ–æ¯”è¾ƒï¼šå¤„ç†å«ä¹‰å¯èƒ½æœ‰å¤šä¸ªå€¼çš„æƒ…å†µï¼ˆå¦‚"å¤©ã€ç™½å¤©"ï¼‰
            const normalizedSelected = normalizeMeaning(selectedOption);
            const normalizedCorrect = normalizeMeaning(question.correctAnswer);
            const isCorrect = normalizedSelected === normalizedCorrect;
            
            // æ’­æ”¾éŸ³æ•ˆ
            if (isCorrect) {
                playCorrectSound();
            } else {
                playIncorrectSound();
            }
            
            // ä¿å­˜ç­”æ¡ˆ
            currentTest.answers[questionIndex] = {
                selectedIndex: optionIndex,
                selectedAnswer: selectedOption,
                correct: isCorrect
            };
            
            // æ›´æ–°é€‰é¡¹æ ·å¼
            const options = document.querySelectorAll(`#test-options-${questionIndex} .test-option`);
            options.forEach((opt, idx) => {
                opt.classList.remove('selected', 'correct', 'incorrect');
                if (idx === optionIndex) {
                    opt.classList.add('selected');
                    if (isCorrect) {
                        opt.classList.add('correct');
                    } else {
                        opt.classList.add('incorrect');
                        // æ ‡è®°æ­£ç¡®ç­”æ¡ˆï¼ˆä½¿ç”¨æ ‡å‡†åŒ–æ¯”è¾ƒï¼‰
                        const normalizedCorrect = normalizeMeaning(question.correctAnswer);
                        for (let i = 0; i < question.options.length; i++) {
                            if (normalizeMeaning(question.options[i]) === normalizedCorrect) {
                                options[i].classList.add('correct');
                                break;
                            }
                        }
                    }
                }
            });
            
            // ç­”å¯¹æ—¶è‡ªåŠ¨ç¿»è½¬ï¼Œç­”é”™æ—¶åœç•™è®©ç”¨æˆ·æŸ¥çœ‹é”™è¯¯é€‰é¡¹
            if (isCorrect) {
                // ç­”å¯¹ï¼šå»¶è¿Ÿåè‡ªåŠ¨ç¿»è½¬å¡ç‰‡æ˜¾ç¤ºåé¦ˆ
            setTimeout(() => {
                const card = document.querySelector('.test-card');
                if (card) {
                    card.classList.add('flipped');
                        // æ›´æ–°å¤–éƒ¨æ ‡é¢˜çš„æ¿€æ´»çŠ¶æ€ï¼ˆä»æ ‡é¢˜è¡Œä¸­æŸ¥æ‰¾ï¼‰
                        const container = domCache.cardsContainer || document.getElementById('cards-container');
                        const titleRow = container ? container.querySelector('.test-title-row') : null;
                        if (titleRow) {
                            const titleFront = titleRow.querySelector('.card-title-front');
                            const titleBack = titleRow.querySelector('.card-title-back');
                            const titleHint = titleRow.querySelector('.card-title-hint');
                            if (titleFront && titleBack) {
                                titleFront.classList.remove('active');
                                titleBack.classList.add('active');
                            }
                            if (titleHint) {
                                titleHint.textContent = 'è¯·ç‚¹å‡»å¡ç‰‡è¿”å›æ­£é¢ç»§ç»­ä¸‹ä¸€é¢˜ï¼š';
                                titleHint.style.display = 'block';
                            }
                        }
                }
            }, 1000);
            } else {
                // ç­”é”™ï¼šä¸è‡ªåŠ¨ç¿»è½¬ï¼Œæç¤ºç”¨æˆ·ç‚¹å‡»å¡ç‰‡æŸ¥çœ‹ç­”æ¡ˆ
                const container = domCache.cardsContainer || document.getElementById('cards-container');
                const titleRow = container ? container.querySelector('.test-title-row') : null;
                if (titleRow) {
                    const titleHint = titleRow.querySelector('.card-title-hint');
                    if (titleHint) {
                        titleHint.textContent = 'ç­”é”™äº†ï¼Œè¯·ç‚¹å‡»å¡ç‰‡æŸ¥çœ‹æ­£ç¡®ç­”æ¡ˆï¼š';
                        titleHint.style.display = 'block';
                    }
                }
            }
            
            // æ›´æ–°è¿›åº¦
            updateTestProgress();
        }

        // æ›´æ–°æµ‹è¯•è¿›åº¦
        function updateTestProgress() {
            // æ›´æ–°å¡ç‰‡å†…éƒ¨çš„è¿›åº¦æ¡ï¼ˆæ­£é¢å’ŒèƒŒé¢éƒ½æœ‰ï¼‰
            const cardProgresses = document.querySelectorAll('.test-card .card-progress');
            const total = currentTest.questions.length;
            const current = currentTest.currentIndex + 1;
            const progress = (current / total) * 100;
            
            cardProgresses.forEach(cardProgress => {
                const progressLabel = cardProgress.querySelector('.progress-label');
                const progressFill = cardProgress.querySelector('.progress-fill');
                
                if (progressLabel) {
                    progressLabel.textContent = `${current}/${total}`;
                }
                if (progressFill) {
                    progressFill.style.height = `${progress}%`;
                }
            });
            
            // åŒæ—¶æ›´æ–°ç‹¬ç«‹çš„è¿›åº¦æ¡ï¼ˆå¦‚æœå­˜åœ¨ï¼Œç”¨äºå…¼å®¹ï¼‰
            const progressLabel = document.getElementById('test-progress-label');
            const progressFill = document.getElementById('progress-fill');
            const typeLabel = document.getElementById('test-type-label');
            
            if (progressLabel && progressFill) {
            const total = currentTest.questions.length;
            const current = currentTest.currentIndex + 1;
            const progress = (current / total) * 100;
            
            progressLabel.textContent = `${current}/${total}`;
                progressFill.style.height = `${progress}%`;
            
            const testTypeName = currentTest.type === 'meaning' ? 'è¯­ä¹‰' : 'è¯æ€§';
                if (typeLabel) {
            typeLabel.textContent = testTypeName;
                }
            }
        }

        // å®Œæˆæµ‹è¯•
        function completeTest() {
            const correctCount = currentTest.answers.filter(a => a.correct).length;
            const totalCount = currentTest.questions.length;
            const passRate = correctCount / totalCount;
            
            const testType = learningProgress.currentTestType;
            const theme = learningProgress.currentTheme;
            const themeData = learningProgress.themes[theme];
            const rules = testRules[userConfig.ability];
            
            // æ›´æ–°æµ‹è¯•ç»“æœ
            if (testType === 'test1') {
                themeData.test1.attempts++;
                themeData.test1.lastAttempt = new Date().toISOString();
                
                // è®°å½•ç¬¬ä¸€æ¬¡æµ‹è¯•é€šè¿‡ç‡
                if (themeData.test1.attempts === 1) {
                    themeData.test1.firstAttemptPassRate = passRate;
                }
                
                themeData.test1.passRate = passRate;
                
                // åˆ¤æ–­æ˜¯å¦é€šè¿‡
                if (passRate >= rules.test1.passRate) {
                    themeData.test1.status = 'completed';
                    
                    // è‰¯å¥½èƒ½åŠ›ï¼šæ£€æŸ¥æ˜¯å¦å¯ä»¥è§£é”æµ‹è¯•2
                    if (userConfig.ability === 'good' && rules.test1.unlockTest2) {
                        if (themeData.test1.attempts === 1 && passRate >= 0.9) {
                            // ç¬¬ä¸€æ¬¡æµ‹è¯•â‰¥90%ï¼Œè§£é”æµ‹è¯•2
                            themeData.test2.unlocked = true;
                            themeData.test2.unlockable = true;
                            themeData.test2.status = 'available';
                            showUnlockNotification(theme, passRate);
                        } else if (themeData.test1.attempts === 1 && passRate < 0.9) {
                            // ç¬¬ä¸€æ¬¡æµ‹è¯•<90%ï¼Œæ ‡è®°ä¸ºä¸å¯è§£é”
                            themeData.test2.unlockable = false;
                        }
                    }
                    
                    // ä¼˜ç§€èƒ½åŠ›ï¼šç›´æ¥è¿›å…¥æµ‹è¯•2
                    if (userConfig.ability === 'excellent') {
                        themeData.test2.unlocked = true;
                        themeData.test2.status = 'available';
                        setTimeout(() => {
                            startTest('test2');
                        }, 2000);
                        return;
                    }
                    
                    // æ£€æŸ¥ä¸»é¢˜æ˜¯å¦å®Œæˆ
                    if (checkThemeCompletion(theme)) {
                        completeTheme(theme);
                    } else {
                        // å¦‚æœå·²è§£é”æµ‹è¯•2ï¼Œæ˜¾ç¤ºé€‰é¡¹
                        if (themeData.test2.unlocked) {
                            showTest2Option(theme);
                        } else {
                            // æœªè§£é”ï¼Œç›´æ¥è¿›å…¥ä¸‹ä¸€ä¸»é¢˜
                            completeTheme(theme);
                        }
                    }
                } else {
                    // æœªé€šè¿‡ï¼Œä¿æŒavailableçŠ¶æ€ä»¥ä¾¿é‡è¯•
                    themeData.test1.status = 'available';
                    showRetryNotification(theme, 'test1', passRate);
                }
            } else if (testType === 'test2') {
                themeData.test2.attempts++;
                themeData.test2.lastAttempt = new Date().toISOString();
                themeData.test2.passRate = passRate;
                
                // åˆ¤æ–­æ˜¯å¦é€šè¿‡
                if (rules.test2.required && passRate >= rules.test2.passRate) {
                    themeData.test2.status = 'completed';
                } else if (!rules.test2.required) {
                    // å¯é€‰æµ‹è¯•ï¼Œå®Œæˆå³å¯
                    themeData.test2.status = 'completed';
                } else {
                    // æœªé€šè¿‡ï¼Œä¿æŒavailableçŠ¶æ€ä»¥ä¾¿é‡è¯•ï¼ˆå¦‚æœå·²è§£é”ï¼‰
                    if (themeData.test2.unlocked) {
                        themeData.test2.status = 'available';
                    } else {
                        themeData.test2.status = 'failed';
                    }
                    showRetryNotification(theme, 'test2', passRate);
                    return;
                }
                
                // æ£€æŸ¥ä¸»é¢˜æ˜¯å¦å®Œæˆ
                if (checkThemeCompletion(theme)) {
                    completeTheme(theme);
                }
            }
            
            saveLearningProgress();
            
            // æ›´æ–°é¡¶éƒ¨æ è¿›åº¦
            updateTopBarProgress();
            
            // æ˜¾ç¤ºæµ‹è¯•ç»“æœ
            showTestResult(testType, passRate, correctCount, totalCount);
        }

        // æ£€æŸ¥ä¸»é¢˜æ˜¯å¦å®Œæˆ
        function checkThemeCompletion(theme) {
            const themeData = learningProgress.themes[theme];
            const rules = testRules[userConfig.ability];
            
            // æµ‹è¯•1å¿…é¡»å®Œæˆ
            if (themeData.test1.status !== 'completed') {
                return false;
            }
            
            // æµ‹è¯•2æ ¹æ®è§„åˆ™åˆ¤æ–­
            if (rules.test2.required) {
                return themeData.test2.status === 'completed';
            }
            
            return true;
        }

        // å®Œæˆä¸»é¢˜
        function completeTheme(theme) {
            const themeData = learningProgress.themes[theme];
            themeData.status = 'completed';
            
            // è§£é”ä¸‹ä¸€ä¸ªä¸»é¢˜
            const themes = themeOrder[userConfig.userType];
            const currentIndex = themes.indexOf(theme);
            if (currentIndex < themes.length - 1) {
                const nextTheme = themes[currentIndex + 1];
                learningProgress.themes[nextTheme].status = 'learning';
                learningProgress.themes[nextTheme].test1.status = 'available';  // è§£é”ä¸‹ä¸€ä¸ªä¸»é¢˜çš„test1
                learningProgress.currentThemeIndex = currentIndex + 1;
                learningProgress.currentTheme = nextTheme;
            }
            
            saveLearningProgress();
            renderThemeNavigation();
            updateTopBarProgress();
            
            // è¿”å›å­¦ä¹ æ¨¡å¼
            setTimeout(() => {
                switchMode('learning');
            }, 2000);
        }

        // æ˜¾ç¤ºè§£é”é€šçŸ¥
        function showUnlockNotification(theme, passRate) {
            const message = document.getElementById('unlock-message');
            if (message) {
            message.textContent = `ä½ åœ¨ç¬¬ä¸€æ¬¡è¯­ä¹‰æµ‹è¯•ä¸­è·å¾—äº†${(passRate * 100).toFixed(0)}%çš„æˆç»©ï¼Œå·²è§£é”è¯æ€§æµ‹è¯•ï¼`;
            }
            showModal('unlock-modal');
        }

        // å¼€å§‹æµ‹è¯•2
        function startTest2() {
            hideModal('unlock-modal');
            startTest('test2');
        }

        // è·³è¿‡åˆ°ä¸‹ä¸€ä¸»é¢˜
        function skipToNextTheme() {
            hideModal('unlock-modal');
            const theme = learningProgress.currentTheme;
            completeTheme(theme);
        }

        // æ˜¾ç¤ºæµ‹è¯•2é€‰é¡¹
        function showTest2Option(theme) {
            // å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ ä¸€ä¸ªé€‰æ‹©ç•Œé¢
            // æš‚æ—¶ç›´æ¥è¿›å…¥æµ‹è¯•2
            setTimeout(() => {
                startTest('test2');
            }, 2000);
        }

        // æ˜¾ç¤ºé‡è¯•é€šçŸ¥
        function showRetryNotification(theme, testType, passRate) {
            const message = document.getElementById('retry-message');
            const rules = testRules[userConfig.ability];
            const requiredRate = testType === 'test1' ? rules.test1.passRate : rules.test2.passRate;
            
            if (message) {
            message.textContent = `æµ‹è¯•æœªé€šè¿‡ï¼é€šè¿‡ç‡ï¼š${(passRate * 100).toFixed(0)}% < ${(requiredRate * 100).toFixed(0)}%\nè¯·é‡æ–°å­¦ä¹ å¹¶æµ‹è¯•ã€‚`;
            }
            showModal('retry-modal');
        }

        // è¿”å›å­¦ä¹ 
        function returnToLearning() {
            hideModal('retry-modal');
            switchMode('learning');
        }

        // æ˜¾ç¤ºæµ‹è¯•ç»“æœ
        function showTestResult(testType, passRate, correctCount, totalCount) {
            const container = domCache.cardsContainer || document.getElementById('cards-container');
            const testTypeName = testType === 'test1' ? 'è¯­ä¹‰æµ‹è¯•' : 'è¯æ€§æµ‹è¯•';
            
            // æ”¶é›†é”™è¯¯è¯æ±‡
            const wrongAnswers = [];
            currentTest.questions.forEach((question, index) => {
                const answer = currentTest.answers[index];
                if (answer && !answer.correct) {
                    wrongAnswers.push({
                        word: question.word.noun,
                        meaning: question.word.meaning,
                        selected: answer.selectedAnswer,
                        correct: question.correctAnswer,
                        image: question.word.image,
                        category: question.word.category
                    });
                }
            });
            
            let wrongWordsHtml = '';
            if (wrongAnswers.length > 0) {
                wrongWordsHtml = `
                    <div style="margin-top: 30px; padding: 20px; background: #fff3cd; border-radius: 12px; border: 1px solid #ffc107;">
                        <h3 style="color: #856404; margin-bottom: 15px;">
                            <span class="icon">âš ï¸</span> é”™è¯¯è¯æ±‡ (${wrongAnswers.length}ä¸ª)
                        </h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 10px;">
                            ${wrongAnswers.map(item => `
                                <div style="padding: 10px; background: white; border-radius: 8px; border: 1px solid #ffc107;">
                                    <div style="font-weight: 600; color: #2c3e50;">${item.word}</div>
                                    <div style="font-size: 0.9rem; color: #e74c3c; margin-top: 5px;">
                                        ä½ é€‰: ${item.selected}
                                    </div>
                                    <div style="font-size: 0.9rem; color: #27ae60; margin-top: 3px;">
                                        æ­£ç¡®: ${item.correct}
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }
            
            container.innerHTML = `
                <div class="loader" style="text-align: center; padding: 40px;">
                    <h2>${testTypeName}å®Œæˆ</h2>
                    <p style="font-size: 1.5rem; margin: 20px 0;">
                        æ­£ç¡®ï¼š${correctCount} / ${totalCount}
                    </p>
                    <p style="font-size: 1.2rem; color: ${passRate >= 0.8 ? '#27ae60' : '#e74c3c'};">
                        é€šè¿‡ç‡ï¼š${(passRate * 100).toFixed(0)}%
                    </p>
                    ${wrongWordsHtml}
                </div>
            `;
        }

        // ==================== å¡ç‰‡ç‚¹å‡»äº‹ä»¶å¤„ç† ====================
        
        // æ³¨æ„ï¼šæµ‹è¯•æ¨¡å¼ä¸‹çš„å¡ç‰‡ç‚¹å‡»é€»è¾‘å·²æ•´åˆåˆ° renderTestCard å‡½æ•°ä¸­çš„å¡ç‰‡ç‚¹å‡»äº‹ä»¶ä¸­
        // å½“ä»èƒŒé¢ç¿»å›æ­£é¢æ—¶ï¼Œä¼šè‡ªåŠ¨è¿›å…¥ä¸‹ä¸€é¢˜ï¼Œæ— éœ€é¢å¤–çš„å…¨å±€ç›‘å¬å™¨

        // ==================== åˆå§‹åŒ–å‡½æ•° ====================
        
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–è¯­éŸ³
        function initSpeech() {
            // æœ‰äº›æµè§ˆå™¨éœ€è¦åœ¨ç”¨æˆ·äº¤äº’åæ‰èƒ½è·å–è¯­éŸ³åˆ—è¡¨
            if (window.speechSynthesis.onvoiceschanged !== undefined) {
                window.speechSynthesis.onvoiceschanged = function() {
                    // è¯­éŸ³åˆ—è¡¨å·²æ›´æ–°
                };
            }
            
            // å°è¯•è·å–è¯­éŸ³åˆ—è¡¨
            window.speechSynthesis.getVoices();
        }
        
        // åˆå§‹åŒ–é¡µé¢
        // è¿›åº¦æ¡å·²æ•´åˆåˆ°å¡ç‰‡å†…éƒ¨ï¼Œæ— éœ€ç›‘å¬çª—å£å¤§å°å’Œæ»šåŠ¨äº‹ä»¶
        
        document.addEventListener('DOMContentLoaded', function() {
            console.log('=== é¡µé¢åˆå§‹åŒ–å¼€å§‹ ===');
            
            // åˆå§‹åŒ–DOMç¼“å­˜ï¼ˆå¿…é¡»åœ¨æœ€å‰é¢ï¼Œå› ä¸ºå…¶ä»–å‡½æ•°ä¾èµ–å®ƒï¼‰
            domCache.init();
            console.log('DOMç¼“å­˜åˆå§‹åŒ–å®Œæˆ');
            
            // æ£€æŸ¥vocabularyæ•°æ®
            console.log('vocabularyæ•°æ®ç±»å‹:', typeof vocabulary);
            console.log('vocabularyæ˜¯å¦ä¸ºæ•°ç»„:', Array.isArray(vocabulary));
            if (Array.isArray(vocabulary)) {
                console.log('vocabularyæ•°ç»„é•¿åº¦:', vocabulary.length);
            }
            
            // åŠ è½½é…ç½®ï¼ˆåŒæ­¥æ‰§è¡Œï¼Œå› ä¸ºvocabularyæ˜¯åŒæ­¥å®šä¹‰çš„ï¼‰
            try {
                loadUserConfig();
                loadLearningProgress();
                console.log('ç”¨æˆ·é…ç½®åŠ è½½å®Œæˆ:', userConfig);
                console.log('å­¦ä¹ è¿›åº¦åŠ è½½å®Œæˆ:', learningProgress);
                
                // å¦‚æœæœªå®Œæˆè®¾ç½®ï¼Œæ˜¾ç¤ºè®¾ç½®å¼¹çª—
                if (!userConfig || !userConfig.setupCompleted) {
                    console.log('ç”¨æˆ·æœªå®Œæˆè®¾ç½®ï¼Œæ˜¾ç¤ºè®¾ç½®å¼¹çª—');
                    showModal('setup-modal');
                    if (domCache.fixedTopBar) {
                        domCache.fixedTopBar.style.display = 'none';
                    }
                } else {
                    console.log('ç”¨æˆ·å·²å®Œæˆè®¾ç½®ï¼Œæ˜¾ç¤ºä¸»ç•Œé¢');
                    
                    // æ£€æŸ¥å¹¶ä¿®å¤ï¼šå¦‚æœcurrentThemeä¸ºnullï¼Œè‡ªåŠ¨è®¾ç½®ç¬¬ä¸€ä¸ªä¸»é¢˜
                    if (!learningProgress.currentTheme && userConfig.userType) {
                        console.log('æ£€æµ‹åˆ°currentThemeä¸ºnullï¼Œè‡ªåŠ¨è®¾ç½®ç¬¬ä¸€ä¸ªä¸»é¢˜');
                        const themes = themeOrder[userConfig.userType];
                        if (themes && themes.length > 0) {
                            learningProgress.currentTheme = themes[0];
                            learningProgress.currentThemeIndex = 0;
                            // å¦‚æœthemeså¯¹è±¡ä¸ºç©ºï¼Œåˆå§‹åŒ–å®ƒ
                            if (!learningProgress.themes || Object.keys(learningProgress.themes).length === 0) {
                                initializeLearningProgress();
                            } else {
                                // åªæ›´æ–°currentThemeå’ŒcurrentThemeIndex
                                saveLearningProgress();
                            }
                            console.log('å·²è‡ªåŠ¨è®¾ç½®ä¸»é¢˜ä¸º:', learningProgress.currentTheme);
                        }
                    }
                    
                    // å·²è®¾ç½®ï¼Œæ˜¾ç¤ºä¸»ç•Œé¢
                    if (domCache.fixedTopBar) {
                        domCache.fixedTopBar.style.display = 'flex';
                    }
                    updateHeaderDescription();
                    updateTopBarProgress();
                    updateCurrentThemeDisplay();
                    
                    // åŠ è½½å½“å‰ä¸»é¢˜ï¼ˆå†…éƒ¨ä¼šæ£€æŸ¥vocabularyï¼‰
                    console.log('å¼€å§‹åŠ è½½å½“å‰ä¸»é¢˜...');
                    loadCurrentTheme();
                    console.log('loadCurrentThemeå‡½æ•°å·²è°ƒç”¨');
                    
                    // å»¶è¿Ÿæ‰§è¡Œï¼Œç¡®ä¿å¡ç‰‡å·²æ¸²æŸ“åå†æ›´æ–°é®æŒ¡å±‚é«˜åº¦
                    setTimeout(() => {
                        updateOverlayHeights();
                        console.log('é®æŒ¡å±‚é«˜åº¦å·²æ›´æ–°');
                    }, 100);
                }
            } catch (e) {
                console.error('åˆå§‹åŒ–å¤±è´¥:', e);
                console.error('é”™è¯¯å †æ ˆ:', e.stack);
                // å³ä½¿å‡ºé”™ä¹Ÿæ˜¾ç¤ºè®¾ç½®ç•Œé¢
                showModal('setup-modal');
                if (domCache.fixedTopBar) {
                    domCache.fixedTopBar.style.display = 'none';
                }
            }
            
            initSpeech(); // åˆå§‹åŒ–è¯­éŸ³åŠŸèƒ½
            console.log('=== é¡µé¢åˆå§‹åŒ–å®Œæˆ ===');
        });
    </script>
</body>
</html>